{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap cca89007b21ceadba650","webpack:///./bin.js","webpack:///delegated ../node_modules/ramda/index.js from dll-reference vendor","webpack:///external \"vendor\"","webpack:///./defer.js","webpack:///./service/time-manager.js","webpack:///./store.js","webpack:///./tl.js","webpack:///./crypto.js","webpack:///./http.js","webpack:///./service/dc-configurator.js","webpack:///./service/secure-random.js","webpack:///./smart-timeout.js","webpack:///delegated ../node_modules/jsbn/index.js from dll-reference vendor","webpack:///./for-each.js","webpack:///./service/api-manager.js","webpack:///./service/authorizer.js","webpack:///./service/networker.js","webpack:///./leemon.js","webpack:///./service/rsa-keys-manger.js","webpack:///delegated ../node_modules/@goodmind/node-cryptojs-aes/cryptojs.js from dll-reference vendor","webpack:///delegated ../node_modules/axios/index.js from dll-reference vendor","webpack:///delegated ../node_modules/pako/lib/inflate.js from dll-reference vendor","webpack:///delegated ../node_modules/rusha/rusha.js from dll-reference vendor","webpack:///./index.js"],"names":["rushaInstance","bigint","num","toString","bigStringInt","strNum","dHexDump","bytes","arr","i","length","push","console","log","join","bytesToHex","bytesFromHex","hexString","len","start","parseInt","charAt","substr","bytesToBase64","mod3","result","nLen","nUint24","nIdx","String","fromCharCode","uint6ToBase64","replace","nUint6","bytesCmp","bytes1","bytes2","bytesXor","bytesToWords","ArrayBuffer","Uint8Array","words","CryptoJS","lib","WordArray","init","bytesFromWords","wordArray","sigBytes","bytesFromBigInt","bigInt","toByteArray","padding","needPadding","bufferConcat","concat","slice","bytesFromLeemonBigInt","str","bigInt2str","bytesToArrayBuffer","b","buffer","convertToArrayBuffer","undefined","byteLength","BYTES_PER_ELEMENT","convertToUint8Array","convertToByteArray","Array","isArray","newBytes","bytesFromArrayBuffer","byteView","from","buffer1","buffer2","l1","l2","tmp","set","longToInts","sLong","divRem","divideAndRemainder","intValue","longToBytes","reverse","longFromInts","high","low","shiftLeft","add","intToUint","val","uintToInt","sha1HashSync","hashBytes","rawDigest","sha1BytesSync","sha256HashSync","hashWords","SHA256","rsaEncrypt","publicKey","addPadding","N","modulus","E","exponent","X","encryptedBigInt","modPowInt","encryptedBytes","blockSize","zeroes","nextBytes","aesEncryptSync","keyBytes","ivBytes","encryptedWords","AES","encrypt","iv","pad","NoPadding","mode","IGE","ciphertext","aesDecryptSync","decryptedWords","decrypt","gzipUncompress","inflate","nextRandomInt","maxValue","Math","floor","random","pqPrimeFactorization","pqBytes","what","pqPrimeLeemon","str2bigInt","ceil","pqPrimeJsbn","it","g","q","x","y","clone","lim","j","a","c","equals","BigInteger","ZERO","and","ONE","compareTo","subtract","shiftRight","z","gcd","f","divide","P","Q","minBits","minLen","copyInt_","copy_","isZero","add_","greater","sub_","rightShift_","eGCD_","equalsInt","divide_","bytesModPow","m","xBigInt","yBigInt","mBigInt","resBigInt","powMod","e","error","modPow","blueDefer","resolve","reject","promise","Promise","rs","rj","tsNow","seconds","t","Date","window","tsOffset","logTimer","getTime","dTime","toFixed","lastMessageID","timerOffset","offset","TimeOffset","get","generateMessageID","timeTicks","timeSec","timeMSec","messageID","applyServerTime","serverTime","localTime","newTimeOffset","changed","abs","ValueStore","newVal","ValueStoreMap","Map","key","dcList","PureStorage","keys","ConfigStorage","obj","remove","noPrefix","clear","flatArgs","unapply","splitter","chain","split","rejecter","either","complement","is","flatPath","memoize","pipe","pipeWith","ln","ctx","funcs","view","SyncStorage","constructor","def","storage","fpSave","func","createOnNil","when","subtree","pathKeys","args","lensPath","pipeWithLn","overSubtree","fn","over","field","has","prop","merge","objOf","pipeOver","compose","lensProp","omit","dissocPath","without","save","innerStore","TLSerialization","mtproto","startMaxLength","maxLength","createBuffer","intView","Int32Array","getArray","resultBuffer","resultArray","subarray","getBuffer","getBytes","typed","checkLength","needBytes","trace","max","previousBuffer","previousArray","writeInt","debug","storeInt","storeBool","storeLongP","iHigh","iLow","storeLong","angular","storeIntBytes","storeDouble","doubleView","Float64Array","storeString","s","sUTF8","unescape","encodeURIComponent","charCodeAt","storeBytes","bits","Error","storeRawBytes","storeMethod","methodName","params","schema","Config","Schema","MTProto","API","methodData","methods","method","id","param","type","condType","fieldBit","indexOf","storeObject","name","itemType","toLowerCase","Object","predicate","isBare","constructorData","constructors","TLDeserialization","override","Uint32Array","readInt","fetchInt","fetchDouble","fetchLong","longDec","fetchBool","fetchObject","fetchString","decodeURIComponent","escape","fetchBytes","fetchIntBytes","fetchRawBytes","fallback","constructorCmp","compressed","uncompressed","newDeserializer","checkType","index","constructorsIndex","schemaFallback","overrideKey","self","apply","isCond","value","pFlags","getOffset","fetchEnd","convertIfArray","webWorker","taskID","awaiting","webCrypto","crypto","subtle","webkitSubtle","useSha1Crypto","useSha256Crypto","finalizeTask","deferred","workerEnable","tmpWorker","Worker","onmessage","data","onerror","stack","performTaskWorker","task","embed","postMessage","sha1Hash","bytesTyped","digest","then","smartTimeout","sha256Hash","identity","aesEncrypt","aesDecrypt","factorize","CryptoWorker","httpClient","axios","create","defaults","headers","post","common","sslSubdomains","dcOptions","Modes","test","host","port","chosenServers","chooseServer","dcID","upload","chosenServer","dcOption","ssl","http","subdomain","path","cancelToken","Symbol","timeoutRefs","WeakSet","pause","delay","r","setTimeout","newToken","checkRun","delete","cancel","token","indexedMap","addIndex","forEach","ifElse","mapObjIndexed","mtpSetUserAuth","onAuth","userAuth","fullUserAuth","dc","user_auth","hasPath","pathSatisfies","defDc","unless","Number","always","cachedExportPromise","baseDcID","mtpInvokeApi","onInvokeError","notifyFalse","mtpGetNetworker","options","rejectPromise","message","noErrorBox","input","networkerPromise","cachedNetworker","performRequest","networker","wrapApiCall","code","codeEq","propEq","dcEq","exportDeferred","importAuth","dc_id","catch","apiRecall","newDcID","match","rawError","waitTime","timeout","now","stopTime","propOr","min","getDcNetworker","mtpClearStorage","saveKeys","Storage","tap","values","restoreObj","ApiManager","cache","uploader","downloader","fileUpload","fileDownload","Exception","akk","ssk","authKeyHex","serverSaltHex","authKey","serverSalt","$rework","MtpNetworkerFactory","getNetworker","createNetworker","MtpAuthorizer","auth","storeObj","api","mtpSendPlainRequest","requestBuffer","requestLength","requestArray","header","generateID","headerBuffer","headerArray","headerLength","requestData","requestPromise","url","baseError","responseType","originalError","deserializer","auth_key_id","msg_id","msg_len","mtpSendReqPQ","warn","request","nonce","response","_","serverNonce","server_nonce","pq","fingerprints","server_public_key_fingerprints","select","p","mtpSendReqDhParams","newNonce","MtpSecureRandom","new_nonce","dataWithHash","public_key_fingerprint","fingerprint","encrypted_data","newNonceHash","new_nonce_hash","mtpDecryptServerDhDataAnswer","encrypted_answer","mtpSendSetClientDhParams","encryptedAnswer","tmpAesKey","tmpAesIv","answerWithHash","hash","answerWithPadding","dhPrime","dh_prime","gA","g_a","server_time","retry","mtpVerifyDhParams","dhPrimeHex","gABigInt","dhPrimeBigInt","two","fromInt","twoPow","pow","gBytes","gB","retry_id","g_b","encryptedData","authKeyHash","authKeyAux","authKeyID","newNonceHash1","new_nonce_hash1","newNonceHash2","new_nonce_hash2","newNonceHash3","new_nonce_hash3","cached","mtpAuth","count","setZeroTimeout","updatesProcessor","iii","offlineInited","akStopped","chromeMatches","navigator","userAgent","chromeVersion","parseFloat","xhrSendBuffer","MtpNetworker","authKeyUint8","authKeyBuffer","updateSession","lastServerMessages","currentRequests","checkConnectionPeriod","sentMessages","clientMessages","pendingMessages","pendingAcks","pendingResends","connectionInited","pendingTimeouts","setInterval","checkLongPoll","seqNo","prevSessionID","sessionID","updateSentMessage","sentMessageID","sentMessage","container","newInner","updateInner","innerSentMessageID","innerSentMessage","inner","seq_no","generateSeqNo","notContentRelated","wrapMtpCall","serializer","body","pushMessage","wrapMtpMessage","object","layer","App","platform","version","language","afterMessageID","resultType","isAPI","sendLongPoll","maxWait","longPollPending","max_delay","wait_after","max_wait","noResponse","longPoll","noShedule","sheduleRequest","pushResend","getMsgKeyIv","msgKey","isOut","sha1aText","sha1bText","sha1cText","sha1dText","promises","sha1a","sha1b","sha1c","sha1d","onAll","aesKey","aesIv","all","toggleOffline","enabled","offline","nextReqPromise","nextReq","checkConnectionPromise","checkConnection","onOnlineCb","$","document","on","off","getEncryptedMessage","f1","f2","bytesHash","f3","keyIv","f4","encryptFlow","pipeP","getDecryptedMessage","getKeyCurry","cryptoAesCurry","decryptFlow","parseResponse","responseBuffer","afterDecrypt","dataWithPadding","salt","isInvalidSession","totalLength","messageBodyLength","messageBody","paddingLength","hashData","afterShaHash","dataHash","deserializerOptions","getDeserializeOpts","getMsgById","applyServerSalt","newServerSalt","performSheduledRequest","ackMessage","msgID","reqResendMessage","cleanupSent","notEmpty","cleanMessages","processError","matches","error_message","error_code","description","processMessage","msgidInt","messages","bad_msg_id","bad_msg_seqno","new_server_salt","badMessage","shift","processMessageAck","first_msg_id","server_salt","onBaseDc","updateCond","msg_ids","answer_msg_id","spliceCond","lastResendReq","req_msg_id","resend_msg_ids","spliceMessage","dRes","force","isClean","sleepAfter","event","pingID","ping_id","pingMessage","sendEncryptedRequest","onNoResponseMsg","onNoResponseMsgReject","resetPendingMessage","ackMsgIDs","resendMsgIDs","resendOpts","messagesByteLen","currentTime","hasApiCall","hasHttpWait","lengthOverflow","singlesCount","onPendingMessage","messageByteLength","cond1","cond2","singleInRequest","noResponseMsgs","onloads","innerMessages","containerSentMessage","afterSendRequest","afterResponseParse","sqrt","onRequestFail","getRequestUrl","afterRequestData","afterRequestReject","onEncryptedResult","encryptedResult","acked","badMsgID","pos","splice","msgGetter","mt_message","seqno","mt_rpc_result","startAll","stopAll","setUpdatesProcessor","callback","bpe","mask","radix","digitsStr","one","int2bigInt","ss","s0","s1","s2","s3","s4","s5","s6","s7","T","sa","mr_x1","mr_r","mr_a","eg_v","eg_u","eg_A","eg_B","eg_C","eg_D","md_q1","md_q2","md_q3","md_r","md_r1","md_r2","md_tt","primes","pows","s_i","s_i2","s_R","s_rm","s_q","s_n1","s_a","s_r2","s_n","s_b","s_d","s_x1","s_x2","s_aa","rpprb","k","buff","findPrimes","n","ans","millerRabinInt","dup","millerRabin","addInt_","powMod_","squareMod_","bitSize","w","expand","randTruePrime","randTruePrime_","trim","randProbPrime","randProbPrimeRounds","divisible","B","randBigInt_","modInt","mod","mod_","addInt","mult","mult_","sub","inverseMod","inverseMod_","multMod","multMod_","pm","dd","zz","recSize","recLimit","carry_","multInt_","GCD_","randBigInt","GCD","xc","yc","xp","yp","A","C","D","sing","qp","linComb_","halve_","negative","inverseModInt","inverseModInt_","v","leftShift_","greaterShift","kx","ky","y1","y2","subShift_","linCombShift_","addShift_","minSize","base","d","kk","substring","divInt_","ys","kn","k1","k2","np","mont_","ui","ks","publisKeysHex","publicKeysParsed","prepared","mapPrepare","keyParsed","RSAPublicKey","fingerprintBytes","prepareRsaKeys","selectRsaKeyByFingerPrint","fingerprintHex","foundKey"],"mappings":"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AAL,EAAjB,EAA+C,IAA/C;AACD;AACF,CALM;AAAA;AAAA;;AAOA,MAAMwQ,UAAU,MAAM1M,YAAY,IAAlC;AAAA;AAAA;;AAEA,MAAM5F,eAAe,CAAC9F,IAAD,EAAO0F,OAAP,EAAgBC,UAAhB,EAA4B/C,OAA5B,KAC1B,IAAIqJ,YAAJ,CAAiBjM,IAAjB,EAAuB0F,OAAvB,EAAgCC,UAAhC,EAA4C/C,OAA5C,CADK;AAAA;AAAA;;AAGA,MAAMyV,sBAAsBC,YACjC/M,mBAAmB+M,QADd,C;;;;;;;;;;;;;;;;;;;;;;;ACtgCP;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;A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","file":"mtproto2-browser.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vendor\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"vendor\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"mtproto\"] = factory(require(\"vendor\"));\n\telse\n\t\troot[\"mtproto\"] = factory(root[\"vendor\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_2__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap cca89007b21ceadba650","import { BigInteger, SecureRandom } from 'jsbn'\r\nimport Rusha from 'rusha'\r\nimport { CryptoJS } from '@goodmind/node-cryptojs-aes'\r\n\r\nimport { inflate } from 'pako/lib/inflate'\r\n\r\n// import Int from 'big-integer'\r\n\r\n// import BN from 'bn.js'\r\n\r\nimport { eGCD_, greater, divide_, str2bigInt, equalsInt,\r\n  isZero, bigInt2str, copy_, copyInt_, rightShift_,\r\n  sub_, add_, powMod, bpe, one } from './leemon'\r\n\r\n// import { bigInt2str } from 'BigInt'\r\n\r\n// const { BigInteger } = jsbn\r\n\r\nconst rushaInstance = new Rusha(1024 * 1024)\r\n\r\nexport function bigint(num) {\r\n  return new BigInteger(num.toString(16), 16)\r\n}\r\n\r\nexport function bigStringInt(strNum) {\r\n  return new BigInteger(strNum, 10)\r\n}\r\n\r\nexport function dHexDump(bytes) {\r\n  const arr = []\r\n  for (let i = 0; i < bytes.length; i++) {\r\n    if (i && !(i % 2)) {\r\n      if (!(i % 16)) {\r\n        arr.push('\\n')\r\n      } else if (!(i % 4)) {\r\n        arr.push('  ')\r\n      } else {\r\n        arr.push(' ')\r\n      }\r\n    }\r\n    arr.push((bytes[i] < 16 ? '0' : '') + bytes[i].toString(16))\r\n  }\r\n\r\n  console.log(arr.join(''))\r\n}\r\n\r\nexport function bytesToHex(bytes = []) {\r\n  const arr = []\r\n  for (let i = 0; i < bytes.length; i++) {\r\n    arr.push((bytes[i] < 16 ? '0' : '') + (bytes[i] || 0).toString(16))\r\n  }\r\n  return arr.join('')\r\n}\r\n\r\nexport function bytesFromHex(hexString) {\r\n  const len = hexString.length\r\n  let start = 0\r\n  const bytes = []\r\n\r\n  if (hexString.length % 2) {\r\n    bytes.push(parseInt(hexString.charAt(0), 16))\r\n    start++\r\n  }\r\n\r\n  for (let i = start; i < len; i += 2) {\r\n    bytes.push(parseInt(hexString.substr(i, 2), 16))\r\n  }\r\n\r\n  return bytes\r\n}\r\n\r\nexport function bytesToBase64(bytes) {\r\n  let mod3\r\n  let result = ''\r\n\r\n  for (let nLen = bytes.length, nUint24 = 0, nIdx = 0; nIdx < nLen; nIdx++) {\r\n    mod3 = nIdx % 3\r\n    nUint24 |= bytes[nIdx] << (16 >>> mod3 & 24)\r\n    if (mod3 === 2 || nLen - nIdx === 1) {\r\n      result += String.fromCharCode(\r\n        uint6ToBase64(nUint24 >>> 18 & 63),\r\n        uint6ToBase64(nUint24 >>> 12 & 63),\r\n        uint6ToBase64(nUint24 >>> 6 & 63),\r\n        uint6ToBase64(nUint24 & 63)\r\n      )\r\n      nUint24 = 0\r\n    }\r\n  }\r\n\r\n  return result.replace(/A(?=A$|$)/g, '=')\r\n}\r\n\r\nexport function uint6ToBase64(nUint6) {\r\n  return nUint6 < 26\r\n    ? nUint6 + 65\r\n    : nUint6 < 52\r\n      ? nUint6 + 71\r\n      : nUint6 < 62\r\n        ? nUint6 - 4\r\n        : nUint6 === 62\r\n          ? 43\r\n          : nUint6 === 63\r\n            ? 47\r\n            : 65\r\n}\r\n\r\n// export function base64ToBlob(base64str, mimeType) {\r\n//   const sliceSize = 1024\r\n//   const byteCharacters = atob(base64str)\r\n//   const bytesLength = byteCharacters.length\r\n//   const slicesCount = Math.ceil(bytesLength / sliceSize)\r\n//   const byteArrays = new Array(slicesCount)\r\n\r\n//   for (let sliceIndex = 0; sliceIndex < slicesCount; ++sliceIndex) {\r\n//     const begin = sliceIndex * sliceSize\r\n//     const end = Math.min(begin + sliceSize, bytesLength)\r\n\r\n//     const bytes = new Array(end - begin)\r\n//     for (let offset = begin, i = 0; offset < end; ++i, ++offset) {\r\n//       bytes[i] = byteCharacters[offset].charCodeAt(0)\r\n//     }\r\n//     byteArrays[sliceIndex] = new Uint8Array(bytes)\r\n//   }\r\n\r\n//   return blobConstruct(byteArrays, mimeType)\r\n// }\r\n\r\n// export function dataUrlToBlob(url) {\r\n//   // var name = 'b64blob ' + url.length\r\n//   // console.time(name)\r\n//   const urlParts = url.split(',')\r\n//   const base64str = urlParts[1]\r\n//   const mimeType = urlParts[0].split(':')[1].split(';')[0]\r\n//   const blob = base64ToBlob(base64str, mimeType)\r\n//   // console.timeEnd(name)\r\n//   return blob\r\n// }\r\n\r\n// export function blobConstruct(blobParts, mimeType) {\r\n//   let blob\r\n//   try {\r\n//     blob = new Blob(blobParts, { type: mimeType })\r\n//   } catch (e) {\r\n//     const bb = new BlobBuilder\r\n//     angular.forEach(blobParts, function(blobPart) {\r\n//       bb.append(blobPart)\r\n//     })\r\n//     blob = bb.getBlob(mimeType)\r\n//   }\r\n//   return blob\r\n// }\r\n\r\nexport function bytesCmp(bytes1, bytes2) {\r\n  const len = bytes1.length\r\n  if (len !== bytes2.length) {\r\n    return false\r\n  }\r\n\r\n  for (let i = 0; i < len; i++) {\r\n    if (bytes1[i] !== bytes2[i])\r\n      return false\r\n  }\r\n  return true\r\n}\r\n\r\nexport function bytesXor(bytes1, bytes2) {\r\n  const len = bytes1.length\r\n  const bytes = []\r\n\r\n  for (let i = 0; i < len; ++i) {\r\n    bytes[i] = bytes1[i] ^ bytes2[i]\r\n  }\r\n\r\n  return bytes\r\n}\r\n\r\nexport function bytesToWords(bytes) {\r\n  if (bytes instanceof ArrayBuffer) {\r\n    bytes = new Uint8Array(bytes)\r\n  }\r\n  const len = bytes.length\r\n  const words = []\r\n  let i\r\n  for (i = 0; i < len; i++) {\r\n    words[i >>> 2] |= bytes[i] << (24 - (i % 4) * 8)\r\n  }\r\n\r\n  return new CryptoJS.lib.WordArray.init(words, len)\r\n}\r\n\r\nexport function bytesFromWords(wordArray) {\r\n  const words = wordArray.words\r\n  const sigBytes = wordArray.sigBytes\r\n  const bytes = []\r\n\r\n  for (let i = 0; i < sigBytes; i++) {\r\n    bytes.push((words[i >>> 2] >>> (24 - (i % 4) * 8)) & 0xff)\r\n  }\r\n\r\n  return bytes\r\n}\r\n\r\nexport function bytesFromBigInt(bigInt, len) {\r\n  let bytes = bigInt.toByteArray()\r\n\r\n  if (len && bytes.length < len) {\r\n    const padding = []\r\n    for (let i = 0, needPadding = len - bytes.length; i < needPadding; i++) {\r\n      padding[i] = 0\r\n    }\r\n    if (bytes instanceof ArrayBuffer) {\r\n      bytes = bufferConcat(padding, bytes)\r\n    } else {\r\n      bytes = padding.concat(bytes)\r\n    }\r\n  } else {\r\n    while (!bytes[0] && (!len || bytes.length > len)) {\r\n      bytes = bytes.slice(1)\r\n    }\r\n  }\r\n\r\n  return bytes\r\n}\r\n\r\nexport function bytesFromLeemonBigInt(bigInt, len) {\r\n  const str = bigInt2str(bigInt, 16)\r\n  return bytesFromHex(str)\r\n}\r\n\r\nexport function bytesToArrayBuffer(b) {\r\n  return (new Uint8Array(b)).buffer\r\n}\r\n\r\nexport function convertToArrayBuffer(bytes) {\r\n  // Be careful with converting subarrays!!\r\n  if (bytes instanceof ArrayBuffer) {\r\n    return bytes\r\n  }\r\n  if (bytes.buffer !== undefined &&\r\n    bytes.buffer.byteLength == bytes.length * bytes.BYTES_PER_ELEMENT) {\r\n    return bytes.buffer\r\n  }\r\n  return bytesToArrayBuffer(bytes)\r\n}\r\n\r\nexport function convertToUint8Array(bytes) {\r\n  if (bytes.buffer !== undefined) {\r\n    return bytes\r\n  }\r\n  return new Uint8Array(bytes)\r\n}\r\n\r\nexport function convertToByteArray(bytes) {\r\n  if (Array.isArray(bytes)) {\r\n    return bytes\r\n  }\r\n  bytes = convertToUint8Array(bytes)\r\n  const newBytes = []\r\n  for (let i = 0, len = bytes.length; i < len; i++) {\r\n    newBytes.push(bytes[i])\r\n  }\r\n  return newBytes\r\n}\r\n\r\nexport function bytesFromArrayBuffer(buffer) {\r\n  const byteView = new Uint8Array(buffer)\r\n  const bytes = Array.from( byteView )\r\n  return bytes\r\n}\r\n\r\nexport function bufferConcat(buffer1, buffer2) {\r\n  const l1 = buffer1.byteLength || buffer1.length\r\n  const l2 = buffer2.byteLength || buffer2.length\r\n  const tmp = new Uint8Array(l1 + l2)\r\n  tmp.set(\r\n    buffer1 instanceof ArrayBuffer\r\n      ? new Uint8Array(buffer1)\r\n      : buffer1,\r\n    0)\r\n  tmp.set(\r\n    buffer2 instanceof ArrayBuffer\r\n      ? new Uint8Array(buffer2)\r\n      : buffer2,\r\n    l1)\r\n\r\n  return tmp.buffer\r\n}\r\n\r\nexport function longToInts(sLong) {\r\n  const divRem = bigStringInt(sLong).divideAndRemainder(bigint(0x100000000))\r\n\r\n  return [divRem[0].intValue(), divRem[1].intValue()]\r\n}\r\n\r\nexport function longToBytes(sLong) {\r\n  return bytesFromWords({ words: longToInts(sLong), sigBytes: 8 }).reverse()\r\n}\r\n\r\nexport function longFromInts(high, low) {\r\n  return bigint(high)\r\n    .shiftLeft(32)\r\n    .add(bigint(low))\r\n    .toString(10)\r\n}\r\n\r\nexport function intToUint(val) {\r\n  val = parseInt(val)\r\n  if (val < 0) {\r\n    val = val + 4294967296\r\n  }\r\n  return val\r\n}\r\n\r\nexport function uintToInt(val) {\r\n  if (val > 2147483647) {\r\n    val = val - 4294967296\r\n  }\r\n  return val\r\n}\r\n\r\nexport function sha1HashSync(bytes) {\r\n  // console.log(dT(), 'SHA-1 hash start', bytes.byteLength || bytes.length)\r\n  const hashBytes = rushaInstance.rawDigest(bytes).buffer\r\n  // console.log(dT(), 'SHA-1 hash finish')\r\n\r\n  return hashBytes\r\n}\r\n\r\nexport function sha1BytesSync(bytes) {\r\n  return bytesFromArrayBuffer(sha1HashSync(bytes))\r\n}\r\n\r\nexport function sha256HashSync(bytes) {\r\n  // console.log(dT(), 'SHA-2 hash start', bytes.byteLength || bytes.length)\r\n  const hashWords = CryptoJS.SHA256(bytesToWords(bytes))\r\n  // console.log(dT(), 'SHA-2 hash finish')\r\n\r\n  const hashBytes = bytesFromWords(hashWords)\r\n\r\n  return hashBytes\r\n}\r\n\r\nexport function rsaEncrypt(publicKey, bytes) {\r\n  bytes = addPadding(bytes, 255)\r\n\r\n  // console.log('RSA encrypt start')\r\n  const N = new BigInteger(publicKey.modulus, 16)\r\n  const E = new BigInteger(publicKey.exponent, 16)\r\n  const X = new BigInteger(bytes)\r\n  const encryptedBigInt = X.modPowInt(E, N),\r\n        encryptedBytes = bytesFromBigInt(encryptedBigInt, 256)\r\n    // console.log('RSA encrypt finish')\r\n\r\n  return encryptedBytes\r\n}\r\n\r\nexport function addPadding(bytes, blockSize, zeroes) {\r\n  blockSize = blockSize || 16\r\n  const len = bytes.byteLength || bytes.length\r\n  const needPadding = blockSize - (len % blockSize)\r\n  if (needPadding > 0 && needPadding < blockSize) {\r\n    const padding = new Array(needPadding)\r\n    if (zeroes) {\r\n      for (let i = 0; i < needPadding; i++) {\r\n        padding[i] = 0\r\n      }\r\n    } else {\r\n      (new SecureRandom()).nextBytes(padding)\r\n    }\r\n\r\n    if (bytes instanceof ArrayBuffer) {\r\n      bytes = bufferConcat(bytes, padding)\r\n    } else {\r\n      bytes = bytes.concat(padding)\r\n    }\r\n  }\r\n\r\n  return bytes\r\n}\r\n\r\nexport function aesEncryptSync(bytes, keyBytes, ivBytes) {\r\n  const len = bytes.byteLength || bytes.length\r\n\r\n  // console.log(dT(), 'AES encrypt start', len/*, bytesToHex(keyBytes), bytesToHex(ivBytes)*/)\r\n  bytes = addPadding(bytes)\r\n\r\n  const encryptedWords = CryptoJS.AES.encrypt(bytesToWords(bytes), bytesToWords(keyBytes), {\r\n    iv     : bytesToWords(ivBytes),\r\n    padding: CryptoJS.pad.NoPadding,\r\n    mode   : CryptoJS.mode.IGE\r\n  }).ciphertext\r\n\r\n  const encryptedBytes = bytesFromWords(encryptedWords)\r\n  // console.log(dT(), 'AES encrypt finish')\r\n\r\n  return encryptedBytes\r\n}\r\n\r\nexport function aesDecryptSync(encryptedBytes, keyBytes, ivBytes) {\r\n\r\n  // console.log(dT(), 'AES decrypt start', encryptedBytes.length)\r\n  const decryptedWords = CryptoJS.AES.decrypt({ ciphertext: bytesToWords(encryptedBytes) }, bytesToWords(keyBytes), {\r\n    iv     : bytesToWords(ivBytes),\r\n    padding: CryptoJS.pad.NoPadding,\r\n    mode   : CryptoJS.mode.IGE\r\n  })\r\n\r\n  const bytes = bytesFromWords(decryptedWords)\r\n  // console.log(dT(), 'AES decrypt finish')\r\n\r\n  return bytes\r\n}\r\n\r\nexport function gzipUncompress(bytes) {\r\n  // console.log('Gzip uncompress start')\r\n  const result = inflate(bytes)\r\n  // console.log('Gzip uncompress finish')\r\n  return result\r\n}\r\n\r\nexport function nextRandomInt(maxValue) {\r\n  return Math.floor(Math.random() * maxValue)\r\n}\r\n\r\n// const bytesToInt = bytes => Int(bytesToHex(bytes), 16)\r\n// const bytesFromInt = int => bytesFromHex(int.toString(16))\r\n\r\nexport function pqPrimeFactorization(pqBytes) {\r\n  const what = new BigInteger(pqBytes)\r\n  // const whatInt = bytesToInt(pqBytes)\r\n  // const whatBn = new BN(bytesToHex(pqBytes), 16)\r\n  let result = false\r\n  // let intRes = []\r\n  // const bnRes = []\r\n  // console.log(dT(), 'PQ start', pqBytes, what.toString(16), what.bitLength())\r\n\r\n  // try {\r\n  // console.time('pq leemon')\r\n  // const toHex = bytesToHex(pqBytes)\r\n  result = pqPrimeLeemon(str2bigInt(what.toString(16), 16, Math.ceil(64 / bpe) + 1))\r\n  // console.timeEnd('pq leemon')\r\n  // } catch (e) {\r\n  //   console.error('Pq leemon Exception', e)\r\n  // }\r\n\r\n  /*if (result === false && what.bitLength() <= 64) {\r\n    // console.time('PQ long')\r\n    try {\r\n      result = pqPrimeLong(goog.math.Long.fromString(what.toString(16), 16))\r\n    } catch (e) {\r\n      console.error('Pq long Exception', e)\r\n    }\r\n  // console.timeEnd('PQ long')\r\n  }*/\r\n  // console.log(result)\r\n\r\n  // if (result === false) {\r\n  // console.time('pq BigInt')\r\n  // intRes = pqPrimeJsbn(what)\r\n  // console.timeEnd('pq BigInt')\r\n\r\n  // console.time('pq bn')\r\n  // bnRes = pqPrimeBN(whatBn)\r\n  // console.timeEnd('pq bn')\r\n  // }\r\n  // console.log(...result, ...bnRes)\r\n  // console.log(dT(), 'PQ finish')\r\n\r\n  return result\r\n    //intRes//result//bnRes\r\n}\r\n\r\n/*export function pqPrimeBN(what) {\r\n  let it = 0,\r\n      g\r\n  const nOne = new BN(1)\r\n  for (let i = 0; i < 3; i++) {\r\n    const q = (nextRandomInt(128) & 15) + 17\r\n    let x = new BN(nextRandomInt(1000000000) + 1)\r\n    let y = x.clone()\r\n    const lim = 1 << (i + 18)\r\n\r\n    for (let j = 1; j < lim; j++) {\r\n      ++it\r\n      let a = x.clone()\r\n      let b = x.clone()\r\n      let c = new BN(q)\r\n\r\n      while (!b.isZero()) {\r\n        if (!b.and(nOne).isZero()) {\r\n          c = c.add(a)\r\n          if (c.gt(what)) {\r\n            c = c.sub(what)\r\n          }\r\n        }\r\n        a = a.add(a)\r\n        if (a.gt(what)) {\r\n          a = a.sub(what)\r\n        }\r\n        b = b.shrn(1)\r\n      }\r\n\r\n      x = c.clone()\r\n      const z = x.lt(y)\r\n        ? y.sub(x)\r\n        : x.sub(y)\r\n      g = z.gcd(what)\r\n      if (!g.eq(nOne)) {\r\n        break\r\n      }\r\n      if ((j & (j - 1)) == 0) {\r\n        y = x.clone()\r\n      }\r\n    }\r\n    if (g.gt(nOne)) {\r\n      break\r\n    }\r\n  }\r\n\r\n  let f = what.div(g), P, Q\r\n\r\n  if (g.gt(f)) {\r\n    P = f\r\n    Q = g\r\n  } else {\r\n    P = g\r\n    Q = f\r\n  }\r\n\r\n  return [P.toArray(), Q.toArray(), it]\r\n}*/\r\n\r\nexport function pqPrimeJsbn(what) {\r\n  let it = 0,\r\n      g\r\n  for (let i = 0; i < 3; i++) {\r\n    const q = (nextRandomInt(128) & 15) + 17\r\n    let x = bigint(nextRandomInt(1000000000) + 1)\r\n    let y = x.clone()\r\n    const lim = 1 << (i + 18)\r\n\r\n    for (let j = 1; j < lim; j++) {\r\n      ++it\r\n      let a = x.clone()\r\n      let b = x.clone()\r\n      let c = bigint(q)\r\n\r\n      while (!b.equals(BigInteger.ZERO)) {\r\n        if (!b.and(BigInteger.ONE).equals(BigInteger.ZERO)) {\r\n          c = c.add(a)\r\n          if (c.compareTo(what) > 0) {\r\n            c = c.subtract(what)\r\n          }\r\n        }\r\n        a = a.add(a)\r\n        if (a.compareTo(what) > 0) {\r\n          a = a.subtract(what)\r\n        }\r\n        b = b.shiftRight(1)\r\n      }\r\n\r\n      x = c.clone()\r\n      const z = x.compareTo(y) < 0 ? y.subtract(x) : x.subtract(y)\r\n      g = z.gcd(what)\r\n      if (!g.equals(BigInteger.ONE)) {\r\n        break\r\n      }\r\n      if ((j & (j - 1)) == 0) {\r\n        y = x.clone()\r\n      }\r\n    }\r\n    if (g.compareTo(BigInteger.ONE) > 0) {\r\n      break\r\n    }\r\n  }\r\n\r\n  let f = what.divide(g), P, Q\r\n\r\n  if (g.compareTo(f) > 0) {\r\n    P = f\r\n    Q = g\r\n  } else {\r\n    P = g\r\n    Q = f\r\n  }\r\n\r\n  return [bytesFromBigInt(P), bytesFromBigInt(Q), it]\r\n}\r\n\r\n/*export function pqPrimeBigInteger(what) {\r\n  let it = 0,\r\n      g\r\n  for (let i = 0; i < 3; i++) {\r\n    const q = (nextRandomInt(128) & 15) + 17\r\n    let x = Int(nextRandomInt(1000000000) + 1)\r\n    let y = Int(x)\r\n    const lim = 1 << (i + 18)\r\n\r\n    for (let j = 1; j < lim; j++) {\r\n      ++it\r\n      let a = Int(x)\r\n      let b = Int(x)\r\n      let c = Int(q)\r\n\r\n      while (!b.isZero()) {\r\n        if (!b.and(Int.one).isZero()) {\r\n          c = c.add(a)\r\n          if (c.greater(what))\r\n            c = c.subtract(what)\r\n        }\r\n        a = a.add(a)\r\n        if (a.greater(what))\r\n          a = a.subtract(what)\r\n        b = b.shiftRight(1)\r\n      }\r\n\r\n      x = Int(c)\r\n      const z = x.lesser(y)\r\n        ? y.subtract(x)\r\n        : x.subtract(y)\r\n      g = Int.gcd(z, what)\r\n      if (g.notEquals(Int.one))\r\n        break\r\n      if ((j & (j - 1)) == 0)\r\n        y = Int(x)\r\n    }\r\n    if (g.greater(Int.one))\r\n      break\r\n  }\r\n\r\n  const f = what.divide(g)\r\n  let P, Q\r\n\r\n  if (g.greater(f)) {\r\n    P = f\r\n    Q = g\r\n  } else {\r\n    P = g\r\n    Q = f\r\n  }\r\n\r\n  return [bytesFromInt(P), bytesFromInt(Q), it]\r\n}*/\r\n\r\n/*export function gcdLong(a, b) {\r\n  while (a.notEquals(goog.math.Long.ZERO) && b.notEquals(goog.math.Long.ZERO)) {\r\n    while (b.and(goog.math.Long.ONE).equals(goog.math.Long.ZERO)) {\r\n      b = b.shiftRight(1)\r\n    }\r\n    while (a.and(goog.math.Long.ONE).equals(goog.math.Long.ZERO)) {\r\n      a = a.shiftRight(1)\r\n    }\r\n    if (a.compare(b) > 0) {\r\n      a = a.subtract(b)\r\n    } else {\r\n      b = b.subtract(a)\r\n    }\r\n  }\r\n  return b.equals(goog.math.Long.ZERO) ? a : b\r\n}\r\n\r\nexport function pqPrimeLong(what) {\r\n  let it = 0,\r\n      g\r\n  for (let i = 0; i < 3; i++) {\r\n    const q = goog.math.Long.fromInt((nextRandomInt(128) & 15) + 17)\r\n    let x = goog.math.Long.fromInt(nextRandomInt(1000000000) + 1)\r\n    let y = x\r\n    const lim = 1 << (i + 18)\r\n\r\n    for (let j = 1; j < lim; j++) {\r\n      ++it\r\n      let a = x\r\n      let b = x\r\n      let c = q\r\n\r\n      while (b.notEquals(goog.math.Long.ZERO)) {\r\n        if (b.and(goog.math.Long.ONE).notEquals(goog.math.Long.ZERO)) {\r\n          c = c.add(a)\r\n          if (c.compare(what) > 0) {\r\n            c = c.subtract(what)\r\n          }\r\n        }\r\n        a = a.add(a)\r\n        if (a.compare(what) > 0) {\r\n          a = a.subtract(what)\r\n        }\r\n        b = b.shiftRight(1)\r\n      }\r\n\r\n      x = c\r\n      const z = x.compare(y) < 0 ? y.subtract(x) : x.subtract(y)\r\n      g = gcdLong(z, what)\r\n      if (g.notEquals(goog.math.Long.ONE)) {\r\n        break\r\n      }\r\n      if ((j & (j - 1)) == 0) {\r\n        y = x\r\n      }\r\n    }\r\n    if (g.compare(goog.math.Long.ONE) > 0) {\r\n      break\r\n    }\r\n  }\r\n\r\n  let f = what.div(g), P, Q\r\n\r\n  if (g.compare(f) > 0) {\r\n    P = f\r\n    Q = g\r\n  } else {\r\n    P = g\r\n    Q = f\r\n  }\r\n\r\n  return [bytesFromHex(P.toString(16)), bytesFromHex(Q.toString(16)), it]\r\n}*/\r\n\r\n/*//is bigint x equal to integer y?\r\n//y must have less than bpe bits\r\nfunction equalsInt(x,y) {\r\n  var i;\r\n  if (x[0]!=y)\r\n    return 0;\r\n  for (i=1;i<x.length;i++)\r\n    if (x[i])\r\n      return 0;\r\n  return 1;\r\n}*/\r\n\r\nexport function pqPrimeLeemon(what) {\r\n  const minBits = 64\r\n  const minLen = Math.ceil(minBits / bpe) + 1\r\n  let it = 0\r\n  let q, lim\r\n  const a = new Array(minLen)\r\n  const b = new Array(minLen)\r\n  const c = new Array(minLen)\r\n  const g = new Array(minLen)\r\n  const z = new Array(minLen)\r\n  const x = new Array(minLen)\r\n  const y = new Array(minLen)\r\n\r\n  for (let i = 0; i < 3; i++) {\r\n    q = (nextRandomInt(128) & 15) + 17\r\n    copyInt_(x, nextRandomInt(1000000000) + 1)\r\n    copy_(y, x)\r\n    lim = 1 << (i + 18)\r\n\r\n    for (let j = 1; j < lim; j++) {\r\n      ++it\r\n      copy_(a, x)\r\n      copy_(b, x)\r\n      copyInt_(c, q)\r\n\r\n      while (!isZero(b)) {\r\n        if (b[0] & 1) {\r\n          add_(c, a)\r\n          if (greater(c, what)) {\r\n            sub_(c, what)\r\n          }\r\n        }\r\n        add_(a, a)\r\n        if (greater(a, what)) {\r\n          sub_(a, what)\r\n        }\r\n        rightShift_(b, 1)\r\n      }\r\n\r\n      copy_(x, c)\r\n      if (greater(x, y)) {\r\n        copy_(z, x)\r\n        sub_(z, y)\r\n      } else {\r\n        copy_(z, y)\r\n        sub_(z, x)\r\n      }\r\n      eGCD_(z, what, g, a, b)\r\n      if (!equalsInt(g, 1)) {\r\n        break\r\n      }\r\n      if ((j & (j - 1)) === 0) {\r\n        copy_(y, x)\r\n      }\r\n    }\r\n    if (greater(g, one)) {\r\n      break\r\n    }\r\n  }\r\n\r\n  divide_(what, g, x, y)\r\n\r\n  const [P, Q] =\r\n    greater(g, x)\r\n      ? [x, g]\r\n      : [g, x]\r\n\r\n  // console.log(dT(), 'done', bigInt2str(what, 10), bigInt2str(P, 10), bigInt2str(Q, 10))\r\n\r\n  return [bytesFromLeemonBigInt(P), bytesFromLeemonBigInt(Q), it]\r\n}\r\n\r\nexport function bytesModPow(x, y, m) {\r\n  try {\r\n    const xBigInt = str2bigInt(bytesToHex(x), 16)\r\n    const yBigInt = str2bigInt(bytesToHex(y), 16)\r\n    const mBigInt = str2bigInt(bytesToHex(m), 16)\r\n    const resBigInt = powMod(xBigInt, yBigInt, mBigInt)\r\n\r\n    return bytesFromHex(bigInt2str(resBigInt, 16))\r\n  } catch (e) {\r\n    console.error('mod pow error', e)\r\n  }\r\n\r\n  return bytesFromBigInt(new BigInteger(x).modPow(new BigInteger(y), new BigInteger(m)), 256)\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./bin.js","module.exports = (__webpack_require__(2))(130);\n\n\n//////////////////\n// WEBPACK FOOTER\n// delegated ../node_modules/ramda/index.js from dll-reference vendor\n// module id = 1\n// module chunks = 0","module.exports = vendor;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"vendor\"\n// module id = 2\n// module chunks = 0","/**\r\n * Defered promise like in Q and $q\r\n *\r\n * @returns {{ resolve: (res: any) => void, reject: (res: any) => void, promise: Promise<{}> }}\r\n */\r\nexport const blueDefer = () => {\r\n  let resolve, reject\r\n  const promise = new Promise((rs, rj) => {\r\n    resolve = rs\r\n    reject = rj\r\n  })\r\n  return {\r\n    resolve,\r\n    reject,\r\n    promise\r\n  }\r\n}\r\n\r\nexport default blueDefer\n\n\n// WEBPACK FOOTER //\n// ./defer.js","import { TimeOffset } from '../store'\r\nimport { nextRandomInt, longFromInts } from '../bin'\r\n\r\nexport const tsNow = seconds => {\r\n  const t = +new Date() + (window.tsOffset || 0)\r\n  return seconds\r\n    ? Math.floor(t / 1000)\r\n    : t\r\n}\r\n\r\nconst logTimer = (new Date()).getTime()\r\n\r\nexport const dTime = () => `[${(((new Date()).getTime() -logTimer) / 1000).toFixed(3)}]`\r\n\r\nlet lastMessageID = [0, 0]\r\nlet timerOffset = 0\r\n\r\nconst offset = TimeOffset.get()\r\nif (offset) timerOffset = offset\r\n\r\nconst generateMessageID = () => {\r\n  const timeTicks = tsNow(),\r\n        timeSec = Math.floor(timeTicks / 1000) + timerOffset,\r\n        timeMSec = timeTicks % 1000,\r\n        random = nextRandomInt(0xFFFF)\r\n\r\n  let messageID = [timeSec, (timeMSec << 21) | (random << 3) | 4]\r\n  if (lastMessageID[0] > messageID[0] ||\r\n    lastMessageID[0] == messageID[0] && lastMessageID[1] >= messageID[1]) {\r\n    messageID = [lastMessageID[0], lastMessageID[1] + 4]\r\n  }\r\n\r\n  lastMessageID = messageID\r\n\r\n  // console.log('generated msg id', messageID, timerOffset)\r\n\r\n  return longFromInts(messageID[0], messageID[1])\r\n}\r\n\r\nexport const applyServerTime = (serverTime, localTime) => {\r\n  const newTimeOffset = serverTime - Math.floor((localTime || tsNow()) / 1000)\r\n  const changed = Math.abs(timerOffset - newTimeOffset) > 10\r\n  TimeOffset.set(newTimeOffset)\r\n\r\n  lastMessageID = [0, 0]\r\n  timerOffset = newTimeOffset\r\n  console.log(dTime(), 'Apply server time', serverTime, localTime, newTimeOffset, changed)\r\n\r\n  return changed\r\n}\r\n\r\nexport { generateMessageID as generateID }\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/time-manager.js","import { clone, merge, unnest,\r\n  lensPath, unapply, pipe,\r\n  set, split, chain, memoize,\r\n  complement, is, isEmpty, either, reject, over,\r\n  isNil, view, when, __, dissocPath, has, curry,\r\n  objOf, prop, compose, lensProp, omit } from 'ramda'\r\n\r\nexport const ValueStore = () => {\r\n  let val = null\r\n\r\n  return {\r\n    get: () => clone(val),\r\n    set: newVal => val = newVal\r\n  }\r\n}\r\n\r\nexport const ValueStoreMap = () => {\r\n  const val = new Map\r\n\r\n  return {\r\n    get: key => clone(val.get(key)),\r\n    set: (key, newVal) => val.set(key, newVal)\r\n  }\r\n}\r\n\r\nexport const TimeOffset = ValueStore()\r\nexport const dcList = ValueStoreMap()\r\n\r\n\r\nexport const PureStorage = {\r\n  get   : (...keys) => new Promise(rs => ConfigStorage.get(keys, rs)),\r\n  set   : obj => new Promise(rs => ConfigStorage.set(obj, rs)),\r\n  remove: (...keys) => new Promise(rs => ConfigStorage.remove(...keys, rs)),\r\n  noPrefix: () => ConfigStorage.noPrefix(),\r\n  clear   : () => new Promise(rs => ConfigStorage.clear(rs))\r\n}\r\n\r\nconst flatArgs = unapply( unnest )\r\nconst splitter = chain(split('.'))\r\nconst rejecter = either(\r\n  complement(\r\n    is(String)),\r\n  isEmpty)\r\n\r\n\r\nconst flatPath = memoize(pipe(\r\n  flatArgs,\r\n  splitter,\r\n  reject(rejecter)))\r\n\r\nconst pipeWith = (ln, ctx) =>\r\n  (...funcs) =>\r\n    pipe(view(ln), ...funcs)(ctx)\r\n\r\nexport class SyncStorage {\r\n  constructor(def = {}) {\r\n    this.storage = def\r\n  }\r\n  set = val => this.storage = val\r\n  fpSave = func => pipe( func, this.set )\r\n  createOnNil = when(\r\n    pipe(view(__, this.storage), isNil),\r\n    this.fpSave( set(__, {}, this.storage) )\r\n  )\r\n  set save(val) {\r\n    this.storage = merge(this.storage, val)\r\n  }\r\n  subtree = (...pathKeys) => {\r\n    const args = flatPath(...pathKeys)\r\n    const ln = lensPath(args)\r\n    this.createOnNil(ln)\r\n    //console.log(this.lensNil(ln))\r\n    const pipeWithLn = pipeWith(ln, this.storage)\r\n    const overSubtree = fn => this.fpSave( over(ln, fn ) )(this.storage)\r\n    return {\r\n      // has   : field => overSubtree( has ( field ) ),\r\n      field: key => ({\r\n        has     : () => pipeWithLn( has ( key ) ),\r\n        view    : () => pipeWithLn( prop ( key ) ),\r\n        set     : val => overSubtree( merge( objOf(key, val) ) ),\r\n        pipeWith: (...funcs) => pipeWithLn( prop ( key ), ...funcs ),\r\n        pipeOver: (...funcs) => this.fpSave(\r\n          over(\r\n            compose( ln, lensProp(key) ),\r\n            pipe(...funcs)\r\n          )\r\n        )(this.storage),\r\n        remove: () => overSubtree( omit([ key ]) )\r\n      }),\r\n      has    : key => pipeWithLn( has ( key ) ),\r\n      view   : () => view(ln, this.storage),\r\n      set    : this.fpSave( set(ln, __, this.storage) ),\r\n      over   : overSubtree,\r\n      remove : () => this.fpSave( dissocPath(args) )(this.storage),\r\n      without: (...keys) => overSubtree( omit(keys) )\r\n    }\r\n  }\r\n}\r\n\r\nexport const innerStore = new SyncStorage\n\n\n// WEBPACK FOOTER //\n// ./store.js","import { is } from 'ramda'\r\nimport { bigint, bigStringInt, uintToInt, intToUint, bytesToHex,\r\n  gzipUncompress, bytesToArrayBuffer } from './bin'\r\n\r\nexport class TLSerialization {\r\n  constructor({ mtproto = false, startMaxLength = 2048 /* 2Kb */ } = {}) {\r\n    this.maxLength = startMaxLength\r\n    this.offset = 0 // in bytes\r\n\r\n    this.createBuffer()\r\n\r\n    // this.debug = options.debug !== undefined ? options.debug : Config.Modes.debug\r\n    this.mtproto = mtproto\r\n  }\r\n\r\n  createBuffer() {\r\n    this.buffer = new ArrayBuffer(this.maxLength)\r\n    this.intView = new Int32Array(this.buffer)\r\n    this.byteView = new Uint8Array(this.buffer)\r\n  }\r\n\r\n  getArray() {\r\n    const resultBuffer = new ArrayBuffer(this.offset)\r\n    const resultArray = new Int32Array(resultBuffer)\r\n\r\n    resultArray.set(this.intView.subarray(0, this.offset / 4))\r\n\r\n    return resultArray\r\n  }\r\n\r\n  getBuffer() {\r\n    return this.getArray().buffer\r\n  }\r\n\r\n  getBytes(typed) {\r\n    if (typed) {\r\n      const resultBuffer = new ArrayBuffer(this.offset)\r\n      const resultArray = new Uint8Array(resultBuffer)\r\n\r\n      resultArray.set(this.byteView.subarray(0, this.offset))\r\n\r\n      return resultArray\r\n    }\r\n\r\n    const bytes = []\r\n    for (let i = 0; i < this.offset; i++) {\r\n      bytes.push(this.byteView[i])\r\n    }\r\n    return bytes\r\n  }\r\n\r\n  checkLength(needBytes) {\r\n    if (this.offset + needBytes < this.maxLength) {\r\n      return\r\n    }\r\n\r\n    console.trace('Increase buffer', this.offset, needBytes, this.maxLength)\r\n    this.maxLength = Math.ceil(Math.max(this.maxLength * 2, this.offset + needBytes + 16) / 4) * 4\r\n    const previousBuffer = this.buffer\r\n    const previousArray = new Int32Array(previousBuffer)\r\n\r\n    this.createBuffer()\r\n\r\n    new Int32Array(this.buffer).set(previousArray)\r\n  }\r\n\r\n  writeInt(i, field) {\r\n    this.debug && console.log('>>>', i.toString(16), i, field)\r\n\r\n    this.checkLength(4)\r\n    this.intView[this.offset / 4] = i\r\n    this.offset += 4\r\n  }\r\n\r\n  storeInt(i, field = '') {\r\n    this.writeInt(i, `${ field }:int`)\r\n  }\r\n\r\n  storeBool(i, field = '') {\r\n    if (i) {\r\n      this.writeInt(0x997275b5, `${ field }:bool`)\r\n    } else {\r\n      this.writeInt(0xbc799737, `${ field }:bool`)\r\n    }\r\n  }\r\n\r\n  storeLongP(iHigh, iLow, field) {\r\n    this.writeInt(iLow, `${ field }:long[low]`)\r\n    this.writeInt(iHigh, `${ field }:long[high]`)\r\n  }\r\n\r\n  storeLong(sLong, field = '') {\r\n    if (angular.isArray(sLong)) {\r\n      if (sLong.length == 2) {\r\n        return this.storeLongP(sLong[0], sLong[1], field)\r\n      } else {\r\n        return this.storeIntBytes(sLong, 64, field)\r\n      }\r\n    }\r\n\r\n    if (typeof sLong != 'string') {\r\n      sLong = sLong\r\n        ? sLong.toString()\r\n        : '0'\r\n    }\r\n    const divRem = bigStringInt(sLong).divideAndRemainder(bigint(0x100000000))\r\n\r\n    this.writeInt(intToUint(divRem[1].intValue()), `${ field }:long[low]`)\r\n    this.writeInt(intToUint(divRem[0].intValue()), `${ field }:long[high]`)\r\n  }\r\n\r\n  storeDouble(f, field = '') {\r\n    const buffer = new ArrayBuffer(8)\r\n    const intView = new Int32Array(buffer)\r\n    const doubleView = new Float64Array(buffer)\r\n\r\n    doubleView[0] = f\r\n\r\n    this.writeInt(intView[0], `${ field }:double[low]`)\r\n    this.writeInt(intView[1], `${ field }:double[high]`)\r\n  }\r\n\r\n  storeString(s, field = '') {\r\n    this.debug && console.log('>>>', s, `${ field }:string`)\r\n\r\n    if (s === undefined) {\r\n      s = ''\r\n    }\r\n    const sUTF8 = unescape(encodeURIComponent(s))\r\n\r\n    this.checkLength(sUTF8.length + 8)\r\n\r\n    const len = sUTF8.length\r\n    if (len <= 253) {\r\n      this.byteView[this.offset++] = len\r\n    } else {\r\n      this.byteView[this.offset++] = 254\r\n      this.byteView[this.offset++] = len & 0xFF\r\n      this.byteView[this.offset++] = (len & 0xFF00) >> 8\r\n      this.byteView[this.offset++] = (len & 0xFF0000) >> 16\r\n    }\r\n    for (let i = 0; i < len; i++) {\r\n      this.byteView[this.offset++] = sUTF8.charCodeAt(i)\r\n    }\r\n\r\n    // Padding\r\n    while (this.offset % 4) {\r\n      this.byteView[this.offset++] = 0\r\n    }\r\n  }\r\n\r\n  storeBytes(bytes, field = '') {\r\n    if (bytes instanceof ArrayBuffer) {\r\n      bytes = new Uint8Array(bytes)\r\n    }\r\n    else if (bytes === undefined) {\r\n      bytes = []\r\n    }\r\n    this.debug && console.log('>>>', bytesToHex(bytes), `${ field }:bytes`)\r\n\r\n    const len = bytes.byteLength || bytes.length\r\n    this.checkLength(len + 8)\r\n    if (len <= 253) {\r\n      this.byteView[this.offset++] = len\r\n    } else {\r\n      this.byteView[this.offset++] = 254\r\n      this.byteView[this.offset++] = len & 0xFF\r\n      this.byteView[this.offset++] = (len & 0xFF00) >> 8\r\n      this.byteView[this.offset++] = (len & 0xFF0000) >> 16\r\n    }\r\n\r\n    this.byteView.set(bytes, this.offset)\r\n    this.offset += len\r\n\r\n    // Padding\r\n    while (this.offset % 4) {\r\n      this.byteView[this.offset++] = 0\r\n    }\r\n  }\r\n\r\n  storeIntBytes(bytes, bits, field = '') {\r\n    if (bytes instanceof ArrayBuffer) {\r\n      bytes = new Uint8Array(bytes)\r\n    }\r\n    const len = bytes.length\r\n    if ((bits % 32) || (len * 8) != bits) {\r\n      throw new Error(`Invalid bits: ${  bits  }, ${  bytes.length}`)\r\n    }\r\n\r\n    this.debug && console.log('>>>', bytesToHex(bytes), `${ field }:int${  bits}`)\r\n    this.checkLength(len)\r\n\r\n    this.byteView.set(bytes, this.offset)\r\n    this.offset += len\r\n  }\r\n\r\n  storeRawBytes(bytes, field = '') {\r\n    if (bytes instanceof ArrayBuffer) {\r\n      bytes = new Uint8Array(bytes)\r\n    }\r\n    const len = bytes.length\r\n\r\n    this.debug && console.log('>>>', bytesToHex(bytes), field)\r\n    this.checkLength(len)\r\n\r\n    this.byteView.set(bytes, this.offset)\r\n    this.offset += len\r\n  }\r\n\r\n  storeMethod(methodName, params) {\r\n    const schema = this.mtproto\r\n      ? Config.Schema.MTProto\r\n      : Config.Schema.API\r\n    let methodData = false\r\n\r\n    for (let i = 0; i < schema.methods.length; i++) {\r\n      if (schema.methods[i].method == methodName) {\r\n        methodData = schema.methods[i]\r\n        break\r\n      }\r\n    }\r\n    if (!methodData) {\r\n      throw new Error(`No method ${  methodName  } found`)\r\n    }\r\n\r\n    this.storeInt(intToUint(methodData.id), `${methodName  }[id]`)\r\n\r\n    let param, type\r\n    let condType\r\n    let fieldBit\r\n    const len = methodData.params.length\r\n    for (let i = 0; i < len; i++) {\r\n      param = methodData.params[i]\r\n      type = param.type\r\n      if (type.indexOf('?') !== -1) {\r\n        condType = type.split('?')\r\n        fieldBit = condType[0].split('.')\r\n        if (!(params[fieldBit[0]] & (1 << fieldBit[1]))) {\r\n          continue\r\n        }\r\n        type = condType[1]\r\n      }\r\n\r\n      this.storeObject(params[param.name], type, `${methodName  }[${  param.name  }]`)\r\n    }\r\n\r\n    return methodData.type\r\n  }\r\n\r\n  storeObject(obj, type, field) {\r\n    switch (type) {\r\n      case '#':\r\n      case 'int':\r\n        return this.storeInt(obj, field)\r\n      case 'long':\r\n        return this.storeLong(obj, field)\r\n      case 'int128':\r\n        return this.storeIntBytes(obj, 128, field)\r\n      case 'int256':\r\n        return this.storeIntBytes(obj, 256, field)\r\n      case 'int512':\r\n        return this.storeIntBytes(obj, 512, field)\r\n      case 'string':\r\n        return this.storeString(obj, field)\r\n      case 'bytes':\r\n        return this.storeBytes(obj, field)\r\n      case 'double':\r\n        return this.storeDouble(obj, field)\r\n      case 'Bool':\r\n        return this.storeBool(obj, field)\r\n      case 'true':\r\n        return\r\n    }\r\n\r\n    if (is(Array, obj)) {\r\n      if (type.substr(0, 6) == 'Vector') {\r\n        this.writeInt(0x1cb5c415, `${field  }[id]`)\r\n      }\r\n      else if (type.substr(0, 6) != 'vector') {\r\n        throw new Error(`Invalid vector type ${  type}`)\r\n      }\r\n      const itemType = type.substr(7, type.length - 8) // for \"Vector<itemType>\"\r\n      this.writeInt(obj.length, `${field  }[count]`)\r\n      for (let i = 0; i < obj.length; i++) {\r\n        this.storeObject(obj[i], itemType, `${field  }[${  i  }]`)\r\n      }\r\n      return true\r\n    }\r\n    else if (type.substr(0, 6).toLowerCase() == 'vector') {\r\n      throw new Error('Invalid vector object')\r\n    }\r\n\r\n    if (!is(Object, obj))\r\n      throw new Error(`Invalid object for type ${  type}`)\r\n\r\n    const schema = this.mtproto\r\n      ? Config.Schema.MTProto\r\n      : Config.Schema.API\r\n    const predicate = obj['_']\r\n    let isBare = false\r\n    let constructorData = false\r\n\r\n    if (isBare = (type.charAt(0) == '%'))\r\n      type = type.substr(1)\r\n\r\n    for (let i = 0; i < schema.constructors.length; i++) {\r\n      if (schema.constructors[i].predicate == predicate) {\r\n        constructorData = schema.constructors[i]\r\n        break\r\n      }\r\n    }\r\n    if (!constructorData)\r\n      throw new Error(`No predicate ${  predicate  } found`)\r\n\r\n    if (predicate == type)\r\n      isBare = true\r\n\r\n    if (!isBare)\r\n      this.writeInt(intToUint(constructorData.id), `${field  }[${  predicate  }][id]`)\r\n\r\n    let param\r\n    let condType\r\n    let fieldBit\r\n    const len = constructorData.params.length\r\n    for (let i = 0; i < len; i++) {\r\n      param = constructorData.params[i]\r\n      type = param.type\r\n      if (type.indexOf('?') !== -1) {\r\n        condType = type.split('?')\r\n        fieldBit = condType[0].split('.')\r\n        if (!(obj[fieldBit[0]] & (1 << fieldBit[1]))) {\r\n          continue\r\n        }\r\n        type = condType[1]\r\n      }\r\n\r\n      this.storeObject(obj[param.name], type, `${field  }[${  predicate  }][${  param.name  }]`)\r\n    }\r\n\r\n    return constructorData.type\r\n  }\r\n\r\n}\r\n\r\nexport class TLDeserialization {\r\n  constructor(buffer, { mtproto = false, override = {} } = {}) {\r\n    this.offset = 0 // in bytes\r\n    this.override = override\r\n\r\n    this.buffer = buffer\r\n    this.intView = new Uint32Array(this.buffer)\r\n    this.byteView = new Uint8Array(this.buffer)\r\n\r\n      // this.debug = options.debug !== undefined ? options.debug : Config.Modes.debug\r\n    this.mtproto = mtproto\r\n    return this\r\n  }\r\n\r\n  readInt(field) {\r\n    if (this.offset >= this.intView.length * 4) {\r\n      throw new Error(`Nothing to fetch: ${  field}`)\r\n    }\r\n\r\n    const i = this.intView[this.offset / 4]\r\n\r\n    this.debug && console.log('<<<', i.toString(16), i, field)\r\n\r\n    this.offset += 4\r\n\r\n    return i\r\n  }\r\n\r\n  fetchInt(field = '') {\r\n    return this.readInt(`${ field }:int`)\r\n  }\r\n\r\n  fetchDouble(field = '') {\r\n    const buffer = new ArrayBuffer(8)\r\n    const intView = new Int32Array(buffer)\r\n    const doubleView = new Float64Array(buffer)\r\n\r\n    intView[0] = this.readInt(`${ field }:double[low]`),\r\n      intView[1] = this.readInt(`${ field }:double[high]`)\r\n\r\n    return doubleView[0]\r\n  }\r\n\r\n  fetchLong(field = '') {\r\n    const iLow = this.readInt(`${ field }:long[low]`)\r\n    const iHigh = this.readInt(`${ field }:long[high]`)\r\n\r\n    const longDec = bigint(iHigh)\r\n      .shiftLeft(32)\r\n      .add(bigint(iLow))\r\n      .toString()\r\n\r\n    return longDec\r\n  }\r\n\r\n  fetchBool(field = '') {\r\n    const i = this.readInt(`${ field }:bool`)\r\n    if (i == 0x997275b5) {\r\n      return true\r\n    } else if (i == 0xbc799737) {\r\n      return false\r\n    }\r\n\r\n    this.offset -= 4\r\n    return this.fetchObject('Object', field)\r\n  }\r\n\r\n  fetchString(field = '') {\r\n    let len = this.byteView[this.offset++]\r\n\r\n    if (len == 254) {\r\n      len = this.byteView[this.offset++] |\r\n          (this.byteView[this.offset++] << 8) |\r\n          (this.byteView[this.offset++] << 16)\r\n    }\r\n\r\n    let sUTF8 = ''\r\n    for (let i = 0; i < len; i++) {\r\n      sUTF8 += String.fromCharCode(this.byteView[this.offset++])\r\n    }\r\n\r\n      // Padding\r\n    while (this.offset % 4) {\r\n      this.offset++\r\n    }\r\n    let s\r\n    try {\r\n      s = decodeURIComponent(escape(sUTF8))\r\n    } catch (e) {\r\n      s = sUTF8\r\n    }\r\n\r\n    this.debug && console.log('<<<', s, `${ field }:string`)\r\n\r\n    return s\r\n  }\r\n\r\n  fetchBytes(field = '') {\r\n    let len = this.byteView[this.offset++]\r\n\r\n    if (len == 254) {\r\n      len = this.byteView[this.offset++] |\r\n          (this.byteView[this.offset++] << 8) |\r\n          (this.byteView[this.offset++] << 16)\r\n    }\r\n\r\n    const bytes = this.byteView.subarray(this.offset, this.offset + len)\r\n    this.offset += len\r\n\r\n      // Padding\r\n    while (this.offset % 4) {\r\n      this.offset++\r\n    }\r\n\r\n    this.debug && console.log('<<<', bytesToHex(bytes), `${ field }:bytes`)\r\n\r\n    return bytes\r\n  }\r\n\r\n  fetchIntBytes(bits, typed, field = '') {\r\n    if (bits % 32) {\r\n      throw new Error(`Invalid bits: ${  bits}`)\r\n    }\r\n\r\n    const len = bits / 8\r\n    if (typed) {\r\n      const result = this.byteView.subarray(this.offset, this.offset + len)\r\n      this.offset += len\r\n      return result\r\n    }\r\n\r\n    const bytes = []\r\n    for (let i = 0; i < len; i++) {\r\n      bytes.push(this.byteView[this.offset++])\r\n    }\r\n\r\n    this.debug && console.log('<<<', bytesToHex(bytes), `${ field }:int${  bits}`)\r\n\r\n    return bytes\r\n  }\r\n\r\n  fetchRawBytes(len, typed, field = '') {\r\n    if (len === false) {\r\n      len = this.readInt(`${ field }_length`)\r\n      if (len > this.byteView.byteLength)\r\n        throw new Error(`Invalid raw bytes length: ${  len  }, buffer len: ${  this.byteView.byteLength}`)\r\n    }\r\n    let bytes\r\n    if (typed) {\r\n      bytes = new Uint8Array(len)\r\n      bytes.set(this.byteView.subarray(this.offset, this.offset + len))\r\n      this.offset += len\r\n      return bytes\r\n    }\r\n\r\n    bytes = []\r\n    for (let i = 0; i < len; i++)\r\n      bytes.push(this.byteView[this.offset++])\r\n\r\n    this.debug && console.log('<<<', bytesToHex(bytes), field)\r\n\r\n    return bytes\r\n  }\r\n\r\n  fetchObject(type, field) {\r\n    switch (type) {\r\n      case '#':\r\n      case 'int':\r\n        return this.fetchInt(field)\r\n      case 'long':\r\n        return this.fetchLong(field)\r\n      case 'int128':\r\n        return this.fetchIntBytes(128, false, field)\r\n      case 'int256':\r\n        return this.fetchIntBytes(256, false, field)\r\n      case 'int512':\r\n        return this.fetchIntBytes(512, false, field)\r\n      case 'string':\r\n        return this.fetchString(field)\r\n      case 'bytes':\r\n        return this.fetchBytes(field)\r\n      case 'double':\r\n        return this.fetchDouble(field)\r\n      case 'Bool':\r\n        return this.fetchBool(field)\r\n      case 'true':\r\n        return true\r\n    }\r\n    let fallback\r\n    field = field || type || 'Object'\r\n\r\n    if (type.substr(0, 6) == 'Vector' || type.substr(0, 6) == 'vector') {\r\n      if (type.charAt(0) == 'V') {\r\n        const constructor = this.readInt(`${field  }[id]`)\r\n        const constructorCmp = uintToInt(constructor)\r\n\r\n        if (constructorCmp == 0x3072cfa1) { // Gzip packed\r\n          const compressed = this.fetchBytes(`${field  }[packed_string]`)\r\n          const uncompressed = gzipUncompress(compressed)\r\n          const buffer = bytesToArrayBuffer(uncompressed)\r\n          const newDeserializer = (new TLDeserialization(buffer))\r\n\r\n          return newDeserializer.fetchObject(type, field)\r\n        }\r\n        if (constructorCmp != 0x1cb5c415) {\r\n          throw new Error(`Invalid vector constructor ${  constructor}`)\r\n        }\r\n      }\r\n      const len = this.readInt(`${field  }[count]`)\r\n      const result = []\r\n      if (len > 0) {\r\n        const itemType = type.substr(7, type.length - 8) // for \"Vector<itemType>\"\r\n        for (let i = 0; i < len; i++)\r\n          result.push(this.fetchObject(itemType, `${field  }[${  i  }]`))\r\n      }\r\n\r\n      return result\r\n    }\r\n\r\n    const schema = this.mtproto\r\n      ? Config.Schema.MTProto\r\n      : Config.Schema.API\r\n    let predicate = false\r\n    let constructorData = false\r\n\r\n    if (type.charAt(0) == '%') {\r\n      const checkType = type.substr(1)\r\n      for (let i = 0; i < schema.constructors.length; i++) {\r\n        if (schema.constructors[i].type == checkType) {\r\n          constructorData = schema.constructors[i]\r\n          break\r\n        }\r\n      }\r\n      if (!constructorData) {\r\n        throw new Error(`Constructor not found for type: ${  type}`)\r\n      }\r\n    }\r\n    else if (type.charAt(0) >= 97 && type.charAt(0) <= 122) {\r\n      for (let i = 0; i < schema.constructors.length; i++) {\r\n        if (schema.constructors[i].predicate == type) {\r\n          constructorData = schema.constructors[i]\r\n          break\r\n        }\r\n      }\r\n      if (!constructorData) {\r\n        throw new Error(`Constructor not found for predicate: ${  type}`)\r\n      }\r\n    } else {\r\n      const constructor = this.readInt(`${field  }[id]`)\r\n      const constructorCmp = uintToInt(constructor)\r\n\r\n      if (constructorCmp == 0x3072cfa1) { // Gzip packed\r\n        const compressed = this.fetchBytes(`${field  }[packed_string]`)\r\n        const uncompressed = gzipUncompress(compressed)\r\n        const buffer = bytesToArrayBuffer(uncompressed)\r\n        const newDeserializer = (new TLDeserialization(buffer))\r\n\r\n        return newDeserializer.fetchObject(type, field)\r\n      }\r\n\r\n      let index = schema.constructorsIndex\r\n      if (!index) {\r\n        schema.constructorsIndex = index = {}\r\n        for (let i = 0; i < schema.constructors.length; i++) {\r\n          index[schema.constructors[i].id] = i\r\n        }\r\n      }\r\n      let i = index[constructorCmp]\r\n      if (i) {\r\n        constructorData = schema.constructors[i]\r\n      }\r\n\r\n      fallback = false\r\n      if (!constructorData && this.mtproto) {\r\n        const schemaFallback = Config.Schema.API\r\n        for (i = 0; i < schemaFallback.constructors.length; i++) {\r\n          if (schemaFallback.constructors[i].id == constructorCmp) {\r\n            constructorData = schemaFallback.constructors[i]\r\n\r\n            delete this.mtproto\r\n            fallback = true\r\n            break\r\n          }\r\n        }\r\n      }\r\n      if (!constructorData) {\r\n        throw new Error(`Constructor not found: ${  constructor  } ${  this.fetchInt()  } ${  this.fetchInt()}`)\r\n      }\r\n    }\r\n\r\n    predicate = constructorData.predicate\r\n\r\n    const result = { '_': predicate }\r\n    const overrideKey = (this.mtproto ? 'mt_' : '') + predicate\r\n    const self = this\r\n\r\n    if (this.override[overrideKey]) {\r\n      this.override[overrideKey].apply(this, [result, `${field  }[${  predicate  }]`])\r\n    } else {\r\n      let param, isCond\r\n      let condType, fieldBit\r\n      let value\r\n      const len = constructorData.params.length\r\n      for (let i = 0; i < len; i++) {\r\n        param = constructorData.params[i]\r\n        type = param.type\r\n        if (type == '#' && result.pFlags === undefined) {\r\n          result.pFlags = {}\r\n        }\r\n        if (isCond = (type.indexOf('?') !== -1)) {\r\n          condType = type.split('?')\r\n          fieldBit = condType[0].split('.')\r\n          if (!(result[fieldBit[0]] & (1 << fieldBit[1]))) {\r\n            continue\r\n          }\r\n          type = condType[1]\r\n        }\r\n\r\n        value = self.fetchObject(type, `${field  }[${  predicate  }][${  param.name  }]`)\r\n\r\n        if (isCond && type === 'true') {\r\n          result.pFlags[param.name] = value\r\n        } else {\r\n          result[param.name] = value\r\n        }\r\n      }\r\n    }\r\n\r\n    if (fallback) {\r\n      this.mtproto = true\r\n    }\r\n\r\n    return result\r\n  }\r\n\r\n  getOffset() {\r\n    return this.offset\r\n  }\r\n\r\n  fetchEnd() {\r\n    if (this.offset != this.byteView.length) {\r\n      throw new Error('Fetch end with non-empty buffer')\r\n    }\r\n    return true\r\n  }\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./tl.js","import { when, is, identity } from 'ramda'\r\nimport blueDefer from './defer'\r\nimport smartTimeout from './smart-timeout'\r\nimport { convertToUint8Array, sha1HashSync, sha256HashSync,\r\n  aesEncryptSync, aesDecryptSync, convertToByteArray, convertToArrayBuffer,\r\n  pqPrimeFactorization, bytesModPow } from './bin'\r\n\r\nconst convertIfArray = when(is(Array), convertToUint8Array)\r\nlet webWorker = false\r\nlet taskID = 0\r\nconst awaiting = {}\r\nconst webCrypto = (window.crypto.subtle || window.crypto.webkitSubtle) //TODO remove browser depends\r\n  /* || window.msCrypto && window.msCrypto.subtle*/\r\nlet useSha1Crypto = true//webCrypto && webCrypto.digest !== undefined\r\nlet useSha256Crypto = true//webCrypto && webCrypto.digest !== undefined\r\nconst finalizeTask = (taskID, result) => {\r\n  const deferred = awaiting[taskID]\r\n  if (deferred !== undefined) {\r\n    // console.log(rework_d_T(), 'CW done')\r\n    deferred.resolve(result)\r\n    delete awaiting[taskID]\r\n  }\r\n}\r\n// window.Worker\r\nconst workerEnable = false\r\nif (workerEnable) { //TODO worker disabled here\r\n  const tmpWorker = new Worker('js/lib/crypto_worker.js')\r\n  tmpWorker.onmessage = e =>\r\n    webWorker\r\n      ? finalizeTask(e.data.taskID, e.data.result)\r\n      : webWorker = tmpWorker\r\n  tmpWorker.onerror = error => {\r\n    console.error('CW error', error, error.stack)\r\n    webWorker = false\r\n  }\r\n}\r\n\r\nconst performTaskWorker = (task, params, embed) => {\r\n  // console.log(rework_d_T(), 'CW start', task)\r\n  const deferred = blueDefer()\r\n\r\n  awaiting[taskID] = deferred\r\n\r\n  params.task = task\r\n  params.taskID = taskID\r\n  ;(embed || webWorker).postMessage(params)\r\n\r\n  taskID++\r\n\r\n  return deferred.promise\r\n}\r\n\r\nconst sha1Hash = bytes => {\r\n  if (useSha1Crypto) {\r\n    // We don't use buffer since typedArray.subarray(...).buffer gives the whole buffer and not sliced one.\r\n    // webCrypto.digest supports typed array\r\n    const bytesTyped = convertIfArray(bytes)\r\n    // console.log(rework_d_T(), 'Native sha1 start')\r\n    return webCrypto.digest({ name: 'SHA-1' }, bytesTyped).then(digest =>\r\n      // console.log(rework_d_T(), 'Native sha1 done')\r\n        digest, e => {\r\n      console.error('Crypto digest error', e)\r\n      useSha1Crypto = false\r\n      return sha1HashSync(bytes)\r\n    })\r\n  }\r\n  return smartTimeout.promise(sha1HashSync, 0, bytes)\r\n}\r\n\r\nconst sha256Hash = bytes => {\r\n  if (useSha256Crypto) {\r\n    const bytesTyped = convertIfArray(bytes)\r\n    // console.log(rework_d_T(), 'Native sha1 start')\r\n    return webCrypto.digest({ name: 'SHA-256' }, bytesTyped)\r\n      .then(identity\r\n        // console.log(rework_d_T(), 'Native sha1 done')\r\n        , e => {\r\n          console.error('Crypto digest error', e)\r\n          useSha256Crypto = false\r\n          return sha256HashSync(bytes)\r\n        })\r\n  }\r\n  return smartTimeout.promise(sha256HashSync, 0, bytes)\r\n}\r\n\r\nconst aesEncrypt = (bytes, keyBytes, ivBytes) =>\r\n  smartTimeout.promise(() => convertToArrayBuffer(aesEncryptSync(bytes, keyBytes, ivBytes)))\r\n\r\nconst aesDecrypt = (encryptedBytes, keyBytes, ivBytes) =>\r\n  smartTimeout.promise(() => convertToArrayBuffer(\r\n    aesDecryptSync(encryptedBytes, keyBytes, ivBytes)))\r\n\r\nconst factorize = bytes => {\r\n  bytes = convertToByteArray(bytes)\r\n  return webWorker\r\n    ? performTaskWorker('factorize', { bytes: bytes })\r\n    : smartTimeout.promise(() => pqPrimeFactorization(bytes))\r\n}\r\n\r\nconst modPow = (x, y, m) => webWorker\r\n  ? performTaskWorker('mod-pow', {\r\n    x: x,\r\n    y: y,\r\n    m: m\r\n  })\r\n  : smartTimeout.promise(() => bytesModPow(x, y, m))\r\n\r\nexport const CryptoWorker = {\r\n  sha1Hash,\r\n  sha256Hash,\r\n  aesEncrypt,\r\n  aesDecrypt,\r\n  factorize,\r\n  modPow\r\n}\r\n\r\nexport default CryptoWorker\n\n\n// WEBPACK FOOTER //\n// ./crypto.js","import axios from 'axios'\r\n\r\nexport const httpClient = axios.create()\r\ndelete httpClient.defaults.headers.post['Content-Type']\r\ndelete httpClient.defaults.headers.common['Accept']\r\n\r\nexport default httpClient\n\n\n// WEBPACK FOOTER //\n// ./http.js","const sslSubdomains = ['pluto', 'venus', 'aurora', 'vesta', 'flora']\r\n\r\nconst dcOptions = Config.Modes.test\r\n  ? [\r\n    { id: 1, host: '149.154.175.10',  port: 80 },\r\n    { id: 2, host: '149.154.167.40',  port: 80 },\r\n    { id: 3, host: '149.154.175.117', port: 80 }\r\n  ]\r\n  : [\r\n    { id: 1, host: '149.154.175.50',  port: 80 },\r\n    { id: 2, host: '149.154.167.51',  port: 80 },\r\n    { id: 3, host: '149.154.175.100', port: 80 },\r\n    { id: 4, host: '149.154.167.91',  port: 80 },\r\n    { id: 5, host: '149.154.171.5',   port: 80 }\r\n  ]\r\n\r\nconst chosenServers = {}\r\n\r\nexport const chooseServer = (dcID, upload) => {\r\n  if (chosenServers[dcID] === undefined) {\r\n    let chosenServer = false,\r\n        i, dcOption\r\n\r\n    if (Config.Modes.ssl || !Config.Modes.http) {\r\n      const subdomain = sslSubdomains[dcID - 1] + (upload ? '-1' : '')\r\n      const path = Config.Modes.test ? 'apiw_test1' : 'apiw1'\r\n      chosenServer = `https://${  subdomain  }.web.telegram.org/${  path}`\r\n      return chosenServer\r\n    }\r\n\r\n    for (i = 0; i < dcOptions.length; i++) {\r\n      dcOption = dcOptions[i]\r\n      if (dcOption.id == dcID) {\r\n        chosenServer = `http://${  dcOption.host  }${dcOption.port != 80 ? `:${  dcOption.port}` : ''  }/apiw1`\r\n        break\r\n      }\r\n    }\r\n    chosenServers[dcID] = chosenServer\r\n  }\r\n\r\n  return chosenServers[dcID]\r\n}\n\n\n// WEBPACK FOOTER //\n// ./service/dc-configurator.js","import { SecureRandom } from 'jsbn'\r\n\r\nexport const random = new SecureRandom()\r\n\r\nexport default random\n\n\n// WEBPACK FOOTER //\n// ./service/secure-random.js","const cancelToken = Symbol('cancel token')\r\n\r\nconst timeoutRefs = new WeakSet\r\n\r\nconst pause = delay => new Promise(r => setTimeout(r, delay))\r\n\r\nexport const smartTimeout = (fn, delay, ...args) => {\r\n  const newToken = Symbol('cancel id')\r\n  const checkRun = () => {\r\n    if (timeoutRefs.has(newToken)) {\r\n      timeoutRefs.delete(newToken)\r\n      return fn(...args)\r\n    } else return false\r\n  }\r\n  const promise = pause(delay).then(checkRun)\r\n  promise[cancelToken] = newToken\r\n  return promise\r\n}\r\n\r\nsmartTimeout.cancel = promise => {\r\n  if (!promise || !promise[cancelToken]) return false\r\n  const token = promise[cancelToken]\r\n  return timeoutRefs.has(token)\r\n    ? timeoutRefs.delete(token)\r\n    : false\r\n}\r\n\r\nsmartTimeout.promise = (fn, delay = 0, ...args) => pause(delay)\r\n  .then(() => fn(...args))\r\n\r\nexport default smartTimeout\n\n\n// WEBPACK FOOTER //\n// ./smart-timeout.js","module.exports = (__webpack_require__(2))(128);\n\n\n//////////////////\n// WEBPACK FOOTER\n// delegated ../node_modules/jsbn/index.js from dll-reference vendor\n// module id = 12\n// module chunks = 0","import { is, addIndex, pipe, reject, isNil, ifElse, map, mapObjIndexed } from 'ramda'\r\n\r\nconst indexedMap = addIndex(map)\r\nexport const forEach = (data, func) => pipe(\r\n  reject(isNil),\r\n  ifElse(\r\n    is(Array),\r\n    indexedMap(func),\r\n    mapObjIndexed(func)\r\n  )\r\n)(data)\r\n\r\nexport default forEach\n\n\n// WEBPACK FOOTER //\n// ./for-each.js","import { pathSatisfies, complement, isNil, unless, is, always,\r\n  propEq, __, propOr } from 'ramda'\r\n\r\nimport { PureStorage } from '../store'\r\nimport blueDefer from '../defer'\r\nimport { dTime, tsNow } from './time-manager'\r\n\r\nexport const mtpSetUserAuth = onAuth =>\r\n  function mtpSetUserAuth(dcID, userAuth) {\r\n    const fullUserAuth = { dcID, ...userAuth }\r\n    PureStorage.set({\r\n      dc       : dcID,\r\n      user_auth: fullUserAuth\r\n    })\r\n    onAuth(fullUserAuth, dcID)\r\n  }\r\n\r\nconst hasPath = pathSatisfies( complement( isNil ) )\r\nconst defDc = unless( is(Number), always(2) )\r\n\r\nconst cachedExportPromise = {}\r\n// const cachedUploadNetworkers = {}\r\n// const cachedNetworkers = {}\r\n\r\n// const baseDc = innerStore.subtree('dc', 'base')\r\n// baseDc.set(false)\r\n\r\nlet baseDcID = 2\r\n\r\nexport const mtpInvokeApi = (onInvokeError, notifyFalse, mtpGetNetworker) =>\r\n  function mtpInvokeApi(method, params, options = {}) {\r\n    const deferred = blueDefer()\r\n    const rejectPromise = error => {\r\n      if (!error)\r\n        error = { type: 'ERROR_EMPTY' }\r\n      else if (!is(Object, error))\r\n        error = { message: error }\r\n      deferred.reject(error)\r\n\r\n      if (!options.noErrorBox) { //TODO weird code. `error` changed after `.reject`?\r\n        error.input = method\r\n        error.stack =\r\n          stack ||\r\n          hasPath(['originalError', 'stack'], error) ||\r\n          error.stack ||\r\n          (new Error()).stack\r\n\r\n        onInvokeError(error)\r\n      }\r\n    }\r\n    let dcID,\r\n        networkerPromise\r\n\r\n\r\n    let cachedNetworker\r\n    const stack = (new Error()).stack || 'empty stack'\r\n    const performRequest = networker =>\r\n      (cachedNetworker = networker)\r\n        .wrapApiCall(method, params, options)\r\n        .then(\r\n          deferred.resolve,\r\n          error => {\r\n            console.error(dTime(), 'Error', error.code, error.type, baseDcID, dcID)\r\n            const codeEq = propEq('code', __, error)\r\n            const dcEq = val => val === dcID\r\n            switch (true) {\r\n              case codeEq(401) && dcEq(baseDcID): {\r\n                PureStorage.remove('dc', 'user_auth')\r\n                notifyFalse()\r\n                rejectPromise(error)\r\n                break\r\n              }\r\n              case codeEq(401) &&\r\n                    baseDcID &&\r\n                    !dcEq(baseDcID)\r\n              : {\r\n                if (cachedExportPromise[dcID] === undefined) {\r\n                  const exportDeferred = blueDefer()\r\n                  const importAuth = ({ id, bytes }) =>\r\n                    mtpInvokeApi(\r\n                      'auth.importAuthorization',\r\n                      { id, bytes },\r\n                      { dcID: dcID, noErrorBox: true })\r\n\r\n                  mtpInvokeApi('auth.exportAuthorization', { dc_id: dcID }, { noErrorBox: true })\r\n                    .then(importAuth)\r\n                    .then(exportDeferred.resolve)\r\n                    .catch(exportDeferred.reject)\r\n\r\n                  cachedExportPromise[dcID] = exportDeferred.promise\r\n                }\r\n\r\n                const apiRecall = () => (cachedNetworker = networker)\r\n                  .wrapApiCall(method, params, options)\r\n\r\n                cachedExportPromise[dcID]\r\n                  .then(apiRecall)\r\n                  .then(deferred.resolve)\r\n                  .catch(rejectPromise)\r\n\r\n                break\r\n              }\r\n              case codeEq(303): {\r\n                const newDcID = error.type.match(/^(PHONE_MIGRATE_|NETWORK_MIGRATE_|USER_MIGRATE_)(\\d+)/)[2]\r\n                if (dcEq(newDcID)) break\r\n                if (options.dcID)\r\n                  options.dcID = newDcID\r\n                else\r\n                  PureStorage.set({ dc: baseDcID = newDcID })\r\n\r\n                const apiRecall = networker => networker.wrapApiCall(method, params, options)\r\n\r\n                mtpGetNetworker(newDcID, options)\r\n                  .then(apiRecall)\r\n                  .then(deferred.resolve)\r\n                  .catch(rejectPromise)\r\n                break\r\n              }\r\n              case !options.rawError &&\r\n                    codeEq(420)\r\n              : {\r\n                const waitTime = error.type.match(/^FLOOD_WAIT_(\\d+)/)[1] || 10\r\n                if (waitTime > (options.timeout || 60))\r\n                  return rejectPromise(error)\r\n                setTimeout(() =>\r\n                  performRequest(cachedNetworker)\r\n                , waitTime * 1000)\r\n                break\r\n              }\r\n              case !options.rawError && (\r\n                      codeEq(500) ||\r\n                      error.type == 'MSG_WAIT_FAILED'\r\n              ): {\r\n                const now = tsNow()\r\n                if (options.stopTime) {\r\n                  if (now >= options.stopTime)\r\n                    return rejectPromise(error)\r\n                } else\r\n                  options.stopTime = now + propOr(10, 'timeout', options) * 1000\r\n                options.waitTime = options.waitTime\r\n                  ? Math.min(60, options.waitTime * 1.5)\r\n                  : 1\r\n                setTimeout(() =>\r\n                  performRequest(cachedNetworker)\r\n                , options.waitTime * 1000)\r\n                break\r\n              }\r\n              default: rejectPromise(error)\r\n            }\r\n          })\r\n    const getDcNetworker = (baseDcID = 2) =>\r\n      mtpGetNetworker(dcID = defDc(baseDcID), options)\r\n    if (dcID = (options.dcID || baseDcID))\r\n      Promise.resolve(mtpGetNetworker(dcID, options))\r\n        .then(performRequest)\r\n        .catch(rejectPromise)\r\n    else\r\n      PureStorage.get('dc')\r\n        .then(getDcNetworker)\r\n        .then(performRequest)\r\n        .catch(rejectPromise)\r\n\r\n    return deferred.promise\r\n  }\r\n\r\nexport const mtpClearStorage = function() {\r\n  const saveKeys = []\r\n  for (let dcID = 1; dcID <= 5; dcID++) {\r\n    saveKeys.push(`dc${  dcID  }_auth_key`)\r\n    saveKeys.push(`t_dc${  dcID  }_auth_key`)\r\n  }\r\n  Storage.noPrefix()\r\n  return Storage\r\n    .get(saveKeys)\r\n    .tap(Storage.clear)\r\n    .then(values => {\r\n      const restoreObj = {}\r\n      saveKeys.forEach((key, i) => {\r\n        const value = values[i]\r\n        if (value !== false && value !== undefined)\r\n          restoreObj[key] = value\r\n      })\r\n      Storage.noPrefix()\r\n      return restoreObj\r\n    })\r\n    .then(Storage.set)\r\n}\r\n\r\nexport class ApiManager {\r\n  cache = {\r\n    uploader  : {},\r\n    downloader: {}\r\n  }\r\n  mtpGetNetworker = (dcID, options = {}) => {\r\n    const cache = (options.fileUpload || options.fileDownload)\r\n      ? this.cache.uploader\r\n      : this.cache.downloader\r\n    if (!dcID) throw new Exception('get Networker without dcID')\r\n\r\n    if (cache[dcID] !== undefined) return cache[dcID]\r\n\r\n    const akk = `dc${  dcID  }_auth_key`\r\n    const ssk = `dc${  dcID  }_server_salt`\r\n\r\n    return window.mtproto.PureStorage.get(akk, ssk).then(function(result) {\r\n      if (cache[dcID] !== undefined) return cache[dcID]\r\n\r\n      const authKeyHex = result[0]\r\n      let serverSaltHex = result[1]\r\n      // console.log('ass', dcID, authKeyHex, serverSaltHex)\r\n      if (authKeyHex && authKeyHex.length === 512) {\r\n        if (!serverSaltHex || serverSaltHex.length !== 16)\r\n          serverSaltHex = 'AAAAAAAAAAAAAAAA'\r\n        const authKey = bytesFromHex(authKeyHex)\r\n        const serverSalt = bytesFromHex(serverSaltHex)\r\n\r\n        return cache[dcID] = window.$rework.MtpNetworkerFactory.getNetworker(dcID, authKey, serverSalt, options)\r\n      }\r\n\r\n      if (!options.createNetworker)\r\n        return Promise.reject({ type: 'AUTH_KEY_EMPTY', code: 401 })\r\n\r\n      return window.$rework.MtpAuthorizer.auth(dcID).then(function({ authKey, serverSalt }) {\r\n        const storeObj = {}\r\n        storeObj[akk] = bytesToHex(authKey)\r\n        storeObj[ssk] = bytesToHex(serverSalt)\r\n        window.mtproto.PureStorage.set(storeObj)\r\n\r\n        return cache[dcID] = window.$rework.MtpNetworkerFactory.getNetworker(dcID, authKey, serverSalt, options)\r\n      }, function(error) {\r\n        console.log('Get networker error', error, error.stack)\r\n        return Promise.reject(error)\r\n      })\r\n    })\r\n  }\r\n}\r\n\r\nexport const api = new ApiManager\n\n\n// WEBPACK FOOTER //\n// ./service/api-manager.js","import jsbn from 'jsbn'\r\nconst { BigInteger } = jsbn\r\n\r\nimport blueDefer from '../defer'\r\n\r\nimport httpClient from '../http'\r\nimport CryptoWorker from '../crypto'\r\n\r\nimport MtpSecureRandom from './secure-random'\r\nimport { TLSerialization, TLDeserialization } from '../tl'\r\nimport { generateID, applyServerTime, dTime, tsNow } from './time-manager'\r\nimport { chooseServer } from './dc-configurator'\r\nimport { select, prepare } from './rsa-keys-manger'\r\n\r\nimport { bytesCmp, bytesToHex, sha1BytesSync, nextRandomInt,\r\n  aesEncryptSync, rsaEncrypt, aesDecryptSync, bytesToArrayBuffer,\r\n  bytesFromHex, bytesXor } from '../bin'\r\n\r\nfunction mtpSendPlainRequest(dcID, requestBuffer) {\r\n  const requestLength = requestBuffer.byteLength,\r\n        requestArray = new Int32Array(requestBuffer)\r\n\r\n  const header = new TLSerialization()\r\n  header.storeLongP(0, 0, 'auth_key_id') // Auth key\r\n  header.storeLong(generateID(), 'msg_id') // Msg_id\r\n  header.storeInt(requestLength, 'request_length')\r\n\r\n  const headerBuffer = header.getBuffer(),\r\n        headerArray = new Int32Array(headerBuffer)\r\n  const headerLength = headerBuffer.byteLength\r\n\r\n  const resultBuffer = new ArrayBuffer(headerLength + requestLength),\r\n        resultArray = new Int32Array(resultBuffer)\r\n\r\n  resultArray.set(headerArray)\r\n  resultArray.set(requestArray, headerArray.length)\r\n\r\n  const requestData = resultArray\r\n  let requestPromise\r\n  const url = chooseServer(dcID)\r\n  const baseError = { code: 406, type: 'NETWORK_BAD_RESPONSE', url: url }\r\n  try {\r\n    requestPromise = httpClient.post(url, requestData, {\r\n      responseType: 'arraybuffer'\r\n    })\r\n  } catch (e) {\r\n    requestPromise = Promise.reject({ originalError: e, ...baseError })\r\n  }\r\n  return requestPromise.then(\r\n    result => {\r\n      if (!result.data || !result.data.byteLength)\r\n        return Promise.reject(baseError)\r\n      let deserializer\r\n      try {\r\n        deserializer = new TLDeserialization(result.data, { mtproto: true })\r\n        const auth_key_id = deserializer.fetchLong('auth_key_id')\r\n        const msg_id = deserializer.fetchLong('msg_id')\r\n        const msg_len = deserializer.fetchInt('msg_len')\r\n      } catch (e) {\r\n        return Promise.reject({ originalError: e, ...baseError })\r\n      }\r\n\r\n      return deserializer\r\n    },\r\n    error => {\r\n      if (!error.message && !error.type) {\r\n        error = { originalError: error, ...baseError }\r\n      }\r\n      return Promise.reject(error)\r\n    }\r\n  )\r\n}\r\n\r\nfunction mtpSendReqPQ(auth) {\r\n  console.warn('mtpSendReqPQ')\r\n  const deferred = auth.deferred\r\n\r\n  const request = new TLSerialization({ mtproto: true })\r\n\r\n  request.storeMethod('req_pq', { nonce: auth.nonce })\r\n\r\n  console.log(dTime(), 'Send req_pq', bytesToHex(auth.nonce))\r\n  mtpSendPlainRequest(auth.dcID, request.getBuffer()).then(function(deserializer) {\r\n    const response = deserializer.fetchObject('ResPQ')\r\n\r\n    if (response._ != 'resPQ') {\r\n      throw new Error(`[MT] resPQ response invalid: ${  response._}`)\r\n    }\r\n\r\n    if (!bytesCmp(auth.nonce, response.nonce)) {\r\n      throw new Error('[MT] resPQ nonce mismatch')\r\n    }\r\n\r\n    auth.serverNonce = response.server_nonce\r\n    auth.pq = response.pq\r\n    auth.fingerprints = response.server_public_key_fingerprints\r\n\r\n    console.log(dTime(), 'Got ResPQ', bytesToHex(auth.serverNonce), bytesToHex(auth.pq), auth.fingerprints)\r\n\r\n    auth.publicKey = select(auth.fingerprints)\r\n\r\n    if (!auth.publicKey)\r\n      throw new Error('[MT] No public key found')\r\n\r\n    console.log(dTime(), 'PQ factorization start', auth.pq)\r\n    CryptoWorker.factorize(auth.pq).then(([ p, q, it ]) => {\r\n      auth.p = p\r\n      auth.q = q\r\n      console.log(dTime(), 'PQ factorization done', it)\r\n      mtpSendReqDhParams(auth)\r\n    }, function(error) {\r\n      console.log('Worker error', error, error.stack)\r\n      deferred.reject(error)\r\n    })\r\n  }, function(error) {\r\n    console.error(dTime(), 'req_pq error', error.message)\r\n    deferred.reject(error)\r\n  })\r\n\r\n  setTimeout(prepare, 0)\r\n}\r\n\r\nfunction mtpSendReqDhParams(auth) {\r\n  const deferred = auth.deferred\r\n\r\n  auth.newNonce = new Array(32)\r\n  MtpSecureRandom.nextBytes(auth.newNonce)\r\n\r\n  const data = new TLSerialization({ mtproto: true })\r\n  data.storeObject({\r\n    _           : 'p_q_inner_data',\r\n    pq          : auth.pq,\r\n    p           : auth.p,\r\n    q           : auth.q,\r\n    nonce       : auth.nonce,\r\n    server_nonce: auth.serverNonce,\r\n    new_nonce   : auth.newNonce\r\n  }, 'P_Q_inner_data', 'DECRYPTED_DATA')\r\n\r\n  const dataWithHash = sha1BytesSync(data.getBuffer()).concat(data.getBytes())\r\n\r\n  const request = new TLSerialization({ mtproto: true })\r\n  request.storeMethod('req_DH_params', {\r\n    nonce                 : auth.nonce,\r\n    server_nonce          : auth.serverNonce,\r\n    p                     : auth.p,\r\n    q                     : auth.q,\r\n    public_key_fingerprint: auth.publicKey.fingerprint,\r\n    encrypted_data        : rsaEncrypt(auth.publicKey, dataWithHash)\r\n  })\r\n\r\n  console.log(dTime(), 'Send req_DH_params')\r\n  mtpSendPlainRequest(auth.dcID, request.getBuffer()).then(function(deserializer) {\r\n    const response = deserializer.fetchObject('Server_DH_Params', 'RESPONSE')\r\n\r\n    if (response._ != 'server_DH_params_fail' && response._ != 'server_DH_params_ok') {\r\n      deferred.reject(new Error(`[MT] Server_DH_Params response invalid: ${  response._}`))\r\n      return false\r\n    }\r\n\r\n    if (!bytesCmp(auth.nonce, response.nonce)) {\r\n      deferred.reject(new Error('[MT] Server_DH_Params nonce mismatch'))\r\n      return false\r\n    }\r\n\r\n    if (!bytesCmp(auth.serverNonce, response.server_nonce)) {\r\n      deferred.reject(new Error('[MT] Server_DH_Params server_nonce mismatch'))\r\n      return false\r\n    }\r\n\r\n    if (response._ == 'server_DH_params_fail') {\r\n      const newNonceHash = sha1BytesSync(auth.newNonce).slice(-16)\r\n      if (!bytesCmp(newNonceHash, response.new_nonce_hash)) {\r\n        deferred.reject(new Error('[MT] server_DH_params_fail new_nonce_hash mismatch'))\r\n        return false\r\n      }\r\n      deferred.reject(new Error('[MT] server_DH_params_fail'))\r\n      return false\r\n    }\r\n\r\n    try {\r\n      mtpDecryptServerDhDataAnswer(auth, response.encrypted_answer)\r\n    } catch (e) {\r\n      deferred.reject(e)\r\n      return false\r\n    }\r\n\r\n    mtpSendSetClientDhParams(auth)\r\n  }, function(error) {\r\n    deferred.reject(error)\r\n  })\r\n}\r\n\r\nfunction mtpDecryptServerDhDataAnswer(auth, encryptedAnswer) {\r\n  auth.localTime = tsNow()\r\n\r\n  auth.tmpAesKey = sha1BytesSync(\r\n    auth.newNonce\r\n      .concat(auth.serverNonce))\r\n        .concat(sha1BytesSync(auth.serverNonce.concat(auth.newNonce)).slice(0, 12))\r\n  auth.tmpAesIv = sha1BytesSync(\r\n    auth\r\n      .serverNonce\r\n      .concat(auth.newNonce))\r\n        .slice(12)\r\n        .concat(\r\n          sha1BytesSync([].concat(auth.newNonce, auth.newNonce)),\r\n          auth.newNonce.slice(0, 4))\r\n\r\n  const answerWithHash = aesDecryptSync(encryptedAnswer, auth.tmpAesKey, auth.tmpAesIv)\r\n\r\n  const hash = answerWithHash.slice(0, 20)\r\n  const answerWithPadding = answerWithHash.slice(20)\r\n  const buffer = bytesToArrayBuffer(answerWithPadding)\r\n\r\n  const deserializer = new TLDeserialization(buffer, { mtproto: true })\r\n  const response = deserializer.fetchObject('Server_DH_inner_data')\r\n\r\n  if (response._ != 'server_DH_inner_data') {\r\n    throw new Error(`[MT] server_DH_inner_data response invalid: ${  constructor}`)\r\n  }\r\n\r\n  if (!bytesCmp(auth.nonce, response.nonce)) {\r\n    throw new Error('[MT] server_DH_inner_data nonce mismatch')\r\n  }\r\n\r\n  if (!bytesCmp(auth.serverNonce, response.server_nonce)) {\r\n    throw new Error('[MT] server_DH_inner_data serverNonce mismatch')\r\n  }\r\n\r\n  console.log(dTime(), 'Done decrypting answer')\r\n  auth.g = response.g\r\n  auth.dhPrime = response.dh_prime\r\n  auth.gA = response.g_a\r\n  auth.serverTime = response.server_time\r\n  auth.retry = 0\r\n\r\n  mtpVerifyDhParams(auth.g, auth.dhPrime, auth.gA)\r\n\r\n  const offset = deserializer.getOffset()\r\n\r\n  if (!bytesCmp(hash, sha1BytesSync(answerWithPadding.slice(0, offset)))) {\r\n    throw new Error('[MT] server_DH_inner_data SHA1-hash mismatch')\r\n  }\r\n\r\n  applyServerTime(auth.serverTime, auth.localTime)\r\n}\r\n\r\nfunction mtpVerifyDhParams(g, dhPrime, gA) {\r\n  console.log(dTime(), 'Verifying DH params')\r\n  const dhPrimeHex = bytesToHex(dhPrime)\r\n  if (g != 3 ||\r\n      dhPrimeHex !== 'c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5b') {\r\n    // The verified value is from https://core.telegram.org/mtproto/security_guidelines\r\n    throw new Error('[MT] DH params are not verified: unknown dhPrime')\r\n  }\r\n  console.log(dTime(), 'dhPrime cmp OK')\r\n\r\n  const gABigInt = new BigInteger(bytesToHex(gA), 16)\r\n  const dhPrimeBigInt = new BigInteger(dhPrimeHex, 16)\r\n\r\n  if (gABigInt.compareTo(BigInteger.ONE) <= 0) {\r\n    throw new Error('[MT] DH params are not verified: gA <= 1')\r\n  }\r\n\r\n  if (gABigInt.compareTo(dhPrimeBigInt.subtract(BigInteger.ONE)) >= 0) {\r\n    throw new Error('[MT] DH params are not verified: gA >= dhPrime - 1')\r\n  }\r\n  console.log(dTime(), '1 < gA < dhPrime-1 OK')\r\n\r\n\r\n  const two = new BigInteger(null)\r\n  two.fromInt(2)\r\n  const twoPow = two.pow(2048 - 64)\r\n\r\n  if (gABigInt.compareTo(twoPow) < 0) {\r\n    throw new Error('[MT] DH params are not verified: gA < 2^{2048-64}')\r\n  }\r\n  if (gABigInt.compareTo(dhPrimeBigInt.subtract(twoPow)) >= 0) {\r\n    throw new Error('[MT] DH params are not verified: gA > dhPrime - 2^{2048-64}')\r\n  }\r\n  console.log(dTime(), '2^{2048-64} < gA < dhPrime-2^{2048-64} OK')\r\n\r\n  return true\r\n}\r\n\r\nfunction mtpSendSetClientDhParams(auth) {\r\n  const deferred = auth.deferred\r\n  const gBytes = bytesFromHex(auth.g.toString(16))\r\n\r\n  auth.b = new Array(256)\r\n  MtpSecureRandom.nextBytes(auth.b)\r\n\r\n  CryptoWorker.modPow(gBytes, auth.b, auth.dhPrime).then(function(gB) {\r\n    const data = new TLSerialization({ mtproto: true })\r\n    data.storeObject({\r\n      _           : 'client_DH_inner_data',\r\n      nonce       : auth.nonce,\r\n      server_nonce: auth.serverNonce,\r\n      retry_id    : [0, auth.retry++],\r\n      g_b         : gB\r\n    }, 'Client_DH_Inner_Data')\r\n\r\n    const dataWithHash = sha1BytesSync(data.getBuffer()).concat(data.getBytes())\r\n\r\n    const encryptedData = aesEncryptSync(dataWithHash, auth.tmpAesKey, auth.tmpAesIv)\r\n\r\n    const request = new TLSerialization({ mtproto: true })\r\n    request.storeMethod('set_client_DH_params', {\r\n      nonce         : auth.nonce,\r\n      server_nonce  : auth.serverNonce,\r\n      encrypted_data: encryptedData\r\n    })\r\n\r\n    console.log(dTime(), 'Send set_client_DH_params')\r\n    mtpSendPlainRequest(auth.dcID, request.getBuffer()).then(function(deserializer) {\r\n      const response = deserializer.fetchObject('Set_client_DH_params_answer')\r\n\r\n      if (response._ != 'dh_gen_ok' && response._ != 'dh_gen_retry' && response._ != 'dh_gen_fail') {\r\n        deferred.reject(new Error(`[MT] Set_client_DH_params_answer response invalid: ${  response._}`))\r\n        return false\r\n      }\r\n\r\n      if (!bytesCmp(auth.nonce, response.nonce)) {\r\n        deferred.reject(new Error('[MT] Set_client_DH_params_answer nonce mismatch'))\r\n        return false\r\n      }\r\n\r\n      if (!bytesCmp(auth.serverNonce, response.server_nonce)) {\r\n        deferred.reject(new Error('[MT] Set_client_DH_params_answer server_nonce mismatch'))\r\n        return false\r\n      }\r\n\r\n      CryptoWorker.modPow(auth.gA, auth.b, auth.dhPrime).then(function(authKey) {\r\n        const authKeyHash = sha1BytesSync(authKey),\r\n              authKeyAux = authKeyHash.slice(0, 8),\r\n              authKeyID = authKeyHash.slice(-8)\r\n\r\n        console.log(dTime(), 'Got Set_client_DH_params_answer', response._)\r\n        switch (response._) {\r\n          case 'dh_gen_ok': {\r\n            const newNonceHash1 = sha1BytesSync(auth.newNonce.concat([1], authKeyAux)).slice(-16)\r\n\r\n            if (!bytesCmp(newNonceHash1, response.new_nonce_hash1)) {\r\n              deferred.reject(new Error('[MT] Set_client_DH_params_answer new_nonce_hash1 mismatch'))\r\n              return false\r\n            }\r\n\r\n            const serverSalt = bytesXor(auth.newNonce.slice(0, 8), auth.serverNonce.slice(0, 8))\r\n            // console.log('Auth successfull!', authKeyID, authKey, serverSalt)\r\n\r\n            auth.authKeyID = authKeyID\r\n            auth.authKey = authKey\r\n            auth.serverSalt = serverSalt\r\n\r\n            deferred.resolve(auth)\r\n            break\r\n          }\r\n          case 'dh_gen_retry': {\r\n            const newNonceHash2 = sha1BytesSync(auth.newNonce.concat([2], authKeyAux)).slice(-16)\r\n            if (!bytesCmp(newNonceHash2, response.new_nonce_hash2)) {\r\n              deferred.reject(new Error('[MT] Set_client_DH_params_answer new_nonce_hash2 mismatch'))\r\n              return false\r\n            }\r\n\r\n            return mtpSendSetClientDhParams(auth)\r\n          }\r\n          case 'dh_gen_fail': {\r\n            const newNonceHash3 = sha1BytesSync(auth.newNonce.concat([3], authKeyAux)).slice(-16)\r\n            if (!bytesCmp(newNonceHash3, response.new_nonce_hash3)) {\r\n              deferred.reject(new Error('[MT] Set_client_DH_params_answer new_nonce_hash3 mismatch'))\r\n              return false\r\n            }\r\n\r\n            deferred.reject(new Error('[MT] Set_client_DH_params_answer fail'))\r\n            return false\r\n          }\r\n        }\r\n      }, function(error) {\r\n        deferred.reject(error)\r\n      })\r\n    }, function(error) {\r\n      deferred.reject(error)\r\n    })\r\n  }, function(error) {\r\n    deferred.reject(error)\r\n  })\r\n}\r\n\r\nconst cached = {}\r\n\r\nfunction mtpAuth(dcID) {\r\n  console.count('mtpAuth')\r\n  if (cached[dcID] !== undefined) {\r\n    return cached[dcID].promise\r\n  }\r\n  console.warn('mtpAuth')\r\n  const nonce = []\r\n  for (let i = 0; i < 16; i++) {\r\n    nonce.push(nextRandomInt(0xFF))\r\n  }\r\n\r\n  if (!chooseServer(dcID))\r\n    return Promise.reject(new Error(`[MT] No server found for dc ${  dcID}`))\r\n\r\n  const auth = {\r\n    dcID    : dcID,\r\n    nonce   : nonce,\r\n    deferred: blueDefer()\r\n  }\r\n\r\n  setZeroTimeout(() => mtpSendReqPQ(auth))\r\n\r\n  cached[dcID] = auth.deferred\r\n\r\n  cached[dcID].promise.catch(() => {\r\n    delete cached[dcID]\r\n  })\r\n\r\n  return cached[dcID].promise\r\n}\r\n\r\nexport { mtpAuth as auth }\n\n\n// WEBPACK FOOTER //\n// ./service/authorizer.js","import { pipeP, is, values } from 'ramda'\r\n\r\nimport CryptoWorker from '../crypto'\r\nimport { dTime, tsNow, generateID, applyServerTime } from './time-manager'\r\nimport MtpSecureRandom from './secure-random'\r\nimport forEach from '../for-each'\r\nimport { TLSerialization, TLDeserialization } from '../tl'\r\nimport smartTimeout from '../smart-timeout'\r\nimport blueDefer from '../defer'\r\nimport { httpClient } from '../http'\r\nimport { chooseServer } from './dc-configurator'\r\nimport { PureStorage } from '../store'\r\n\r\nimport { convertToUint8Array, convertToArrayBuffer, sha1BytesSync,\r\n  nextRandomInt, bytesCmp, bytesToHex, bytesFromArrayBuffer,\r\n  bytesToArrayBuffer, longToBytes, uintToInt, bigStringInt } from '../bin'\r\n\r\nlet updatesProcessor\r\nlet iii = 0\r\nlet offlineInited = false\r\nlet akStopped = false\r\nconst chromeMatches = navigator.userAgent.match(/Chrome\\/(\\d+(\\.\\d+)?)/)\r\nconst chromeVersion = chromeMatches && parseFloat(chromeMatches[1]) || false\r\nconst xhrSendBuffer = !('ArrayBufferView' in window) && (!chromeVersion || chromeVersion < 30)\r\nclass MtpNetworker {\r\n  constructor(dcID, authKey, serverSalt, options = {}) {\r\n    this.dcID = dcID\r\n    this.iii = iii++\r\n\r\n    this.authKey = authKey\r\n    this.authKeyUint8 = convertToUint8Array(authKey)\r\n    this.authKeyBuffer = convertToArrayBuffer(authKey)\r\n    this.authKeyID = sha1BytesSync(authKey).slice(-8)\r\n\r\n    this.serverSalt = serverSalt\r\n\r\n    this.upload = options.fileUpload || options.fileDownload || false\r\n\r\n    this.updateSession()\r\n\r\n    this.lastServerMessages = []\r\n\r\n    this.currentRequests = 0\r\n    this.checkConnectionPeriod = 0\r\n\r\n    this.sentMessages = {}\r\n    this.clientMessages = []\r\n\r\n    this.pendingMessages = {}\r\n    this.pendingAcks = []\r\n    this.pendingResends = []\r\n    this.connectionInited = false\r\n\r\n    this.pendingTimeouts = []\r\n\r\n    setInterval(this.checkLongPoll, 10000)\r\n    this.checkLongPoll()\r\n\r\n    if (!offlineInited)\r\n      offlineInited = true\r\n  }\r\n  updateSession() {\r\n    this.seqNo = 0\r\n    this.prevSessionID = this.sessionID\r\n    this.sessionID = new Array(8)\r\n    MtpSecureRandom.nextBytes(this.sessionID)\r\n  }\r\n\r\n  updateSentMessage(sentMessageID) {\r\n    const sentMessage = this.sentMessages[sentMessageID]\r\n    if (!sentMessage) return false\r\n\r\n    if (sentMessage.container) {\r\n      const newInner = []\r\n      const updateInner = innerSentMessageID => {\r\n        const innerSentMessage = this.updateSentMessage(innerSentMessageID)\r\n        if (innerSentMessage)\r\n          newInner.push(innerSentMessage.msg_id)\r\n      }\r\n      forEach(sentMessage.inner, updateInner)\r\n      sentMessage.inner = newInner\r\n    }\r\n\r\n    sentMessage.msg_id = generateID()\r\n    sentMessage.seq_no = this.generateSeqNo(\r\n      sentMessage.notContentRelated ||\r\n      sentMessage.container\r\n    )\r\n    this.sentMessages[sentMessage.msg_id] = sentMessage\r\n    delete this.sentMessages[sentMessageID]\r\n\r\n    return sentMessage\r\n  }\r\n\r\n  generateSeqNo(notContentRelated) {\r\n    let seqNo = this.seqNo * 2\r\n\r\n    if (!notContentRelated) {\r\n      seqNo++\r\n      this.seqNo++\r\n    }\r\n\r\n    return seqNo\r\n  }\r\n\r\n  wrapMtpCall(method, params, options) {\r\n    const serializer = new TLSerialization({ mtproto: true })\r\n\r\n    serializer.storeMethod(method, params)\r\n\r\n    const messageID = generateID()\r\n    const seqNo = this.generateSeqNo()\r\n    const message = {\r\n      msg_id: messageID,\r\n      seq_no: seqNo,\r\n      body  : serializer.getBytes()\r\n    }\r\n\r\n    if (Config.Modes.debug) {\r\n      console.log(dTime(), 'MT call', method, params, messageID, seqNo)\r\n    }\r\n\r\n    return this.pushMessage(message, options)\r\n  }\r\n\r\n  wrapMtpMessage(object, options = {}) {\r\n\r\n    const serializer = new TLSerialization({ mtproto: true })\r\n    serializer.storeObject(object, 'Object')\r\n\r\n    const messageID = generateID()\r\n    const seqNo = this.generateSeqNo(options.notContentRelated)\r\n    const message = {\r\n      msg_id: messageID,\r\n      seq_no: seqNo,\r\n      body  : serializer.getBytes()\r\n    }\r\n\r\n    if (Config.Modes.debug) {\r\n      console.log(dTime(), 'MT message', object, messageID, seqNo)\r\n    }\r\n\r\n    return this.pushMessage(message, options)\r\n  }\r\n\r\n  wrapApiCall(method, params, options) {\r\n    const serializer = new TLSerialization(options)\r\n\r\n    if (!this.connectionInited) {\r\n      serializer.storeInt(0xda9b0d0d, 'invokeWithLayer')\r\n      serializer.storeInt(Config.Schema.API.layer, 'layer')\r\n      serializer.storeInt(0x69796de9, 'initConnection')\r\n      serializer.storeInt(Config.App.id, 'api_id')\r\n      serializer.storeString(navigator.userAgent || 'Unknown UserAgent', 'device_model')\r\n      serializer.storeString(navigator.platform || 'Unknown Platform', 'system_version')\r\n      serializer.storeString(Config.App.version, 'app_version')\r\n      serializer.storeString(navigator.language || 'en', 'lang_code')\r\n    }\r\n\r\n    if (options.afterMessageID) {\r\n      serializer.storeInt(0xcb9f372d, 'invokeAfterMsg')\r\n      serializer.storeLong(options.afterMessageID, 'msg_id')\r\n    }\r\n\r\n    options.resultType = serializer.storeMethod(method, params)\r\n\r\n    const messageID = generateID()\r\n    const seqNo = this.generateSeqNo()\r\n    const message = {\r\n      msg_id: messageID,\r\n      seq_no: seqNo,\r\n      body  : serializer.getBytes(true),\r\n      isAPI : true\r\n    }\r\n\r\n    if (Config.Modes.debug) {\r\n      console.log(dTime(), 'Api call', method, params, messageID, seqNo, options)\r\n    } else {\r\n      console.log(dTime(), 'Api call', method)\r\n    }\r\n\r\n    return this.pushMessage(message, options)\r\n  }\r\n\r\n  checkLongPoll = force => {\r\n    const isClean = this.cleanupSent()\r\n    // console.log('Check lp', this.longPollPending, tsNow(), this.dcID, isClean)\r\n    if (this.longPollPending && tsNow() < this.longPollPending ||\r\n      this.offline ||\r\n      akStopped) {\r\n      return false\r\n    }\r\n    const self = this\r\n    PureStorage.get('dc').then(function(baseDcID) {\r\n      if (isClean && (\r\n        baseDcID != self.dcID ||\r\n        self.upload ||\r\n        self.sleepAfter && tsNow() > self.sleepAfter\r\n        )) {\r\n        // console.warn(dTime(), 'Send long-poll for DC is delayed', self.dcID, self.sleepAfter)\r\n        return\r\n      }\r\n      self.sendLongPoll()\r\n    })\r\n  }\r\n\r\n  sendLongPoll() {\r\n    const maxWait = 25000\r\n    const self = this\r\n\r\n    this.longPollPending = tsNow() + maxWait\r\n    // console.log('Set lp', this.longPollPending, tsNow())\r\n\r\n    this.wrapMtpCall('http_wait', {\r\n      max_delay : 500,\r\n      wait_after: 150,\r\n      max_wait  : maxWait\r\n    }, {\r\n      noResponse: true,\r\n      longPoll  : true\r\n    }).then(function() {\r\n      delete self.longPollPending\r\n      setZeroTimeout(self.checkLongPoll)\r\n    }, function() {\r\n      console.log('Long-poll failed')\r\n    })\r\n  }\r\n\r\n  pushMessage(message, options = {}) {\r\n    const deferred = blueDefer()\r\n\r\n    this.sentMessages[message.msg_id] = { ...message, ...options, deferred }\r\n    this.pendingMessages[message.msg_id] = 0\r\n\r\n    if (!options || !options.noShedule) {\r\n      this.sheduleRequest()\r\n    }\r\n    if (is(Object, options)) {\r\n      options.messageID = message.msg_id\r\n    }\r\n\r\n    return deferred.promise\r\n  }\r\n\r\n  pushResend(messageID, delay) {\r\n    const value = delay\r\n      ? tsNow() + delay\r\n      : 0\r\n    const sentMessage = this.sentMessages[messageID]\r\n    if (sentMessage.container) {\r\n      for (let i = 0; i < sentMessage.inner.length; i++) {\r\n        this.pendingMessages[sentMessage.inner[i]] = value\r\n      }\r\n    } else {\r\n      this.pendingMessages[messageID] = value\r\n    }\r\n\r\n    // console.log('Resend due', messageID, this.pendingMessages)\r\n\r\n    this.sheduleRequest(delay)\r\n  }\r\n\r\n  getMsgKeyIv(msgKey, isOut) {\r\n    const authKey = this.authKeyUint8\r\n    const x = isOut\r\n      ? 0\r\n      : 8\r\n    const sha1aText = new Uint8Array(48)\r\n    const sha1bText = new Uint8Array(48)\r\n    const sha1cText = new Uint8Array(48)\r\n    const sha1dText = new Uint8Array(48)\r\n    const promises = {}\r\n\r\n    sha1aText.set(msgKey, 0)\r\n    sha1aText.set(authKey.subarray(x, x + 32), 16)\r\n    promises.sha1a = CryptoWorker.sha1Hash(sha1aText)\r\n\r\n    sha1bText.set(authKey.subarray(x + 32, x + 48), 0)\r\n    sha1bText.set(msgKey, 16)\r\n    sha1bText.set(authKey.subarray(x + 48, x + 64), 32)\r\n    promises.sha1b = CryptoWorker.sha1Hash(sha1bText)\r\n\r\n    sha1cText.set(authKey.subarray(x + 64, x + 96), 0)\r\n    sha1cText.set(msgKey, 32)\r\n    promises.sha1c = CryptoWorker.sha1Hash(sha1cText)\r\n\r\n    sha1dText.set(msgKey, 0)\r\n    sha1dText.set(authKey.subarray(x + 96, x + 128), 16)\r\n    promises.sha1d = CryptoWorker.sha1Hash(sha1dText)\r\n\r\n    const onAll = result => {\r\n      const aesKey = new Uint8Array(32),\r\n            aesIv = new Uint8Array(32),\r\n            sha1a = new Uint8Array(result[0]),\r\n            sha1b = new Uint8Array(result[1]),\r\n            sha1c = new Uint8Array(result[2]),\r\n            sha1d = new Uint8Array(result[3])\r\n\r\n      aesKey.set(sha1a.subarray(0, 8))\r\n      aesKey.set(sha1b.subarray(8, 20), 8)\r\n      aesKey.set(sha1c.subarray(4, 16), 20)\r\n\r\n      aesIv.set(sha1a.subarray(8, 20))\r\n      aesIv.set(sha1b.subarray(0, 8), 12)\r\n      aesIv.set(sha1c.subarray(16, 20), 20)\r\n      aesIv.set(sha1d.subarray(0, 8), 24)\r\n\r\n      return [aesKey, aesIv]\r\n    }\r\n\r\n    return Promise.all(values(promises)).then(onAll)\r\n  }\r\n\r\n  checkConnection = event => {\r\n    console.log(dTime(), 'Check connection', event)\r\n    smartTimeout.cancel(this.checkConnectionPromise)\r\n\r\n    const serializer = new TLSerialization({ mtproto: true })\r\n    const pingID = [nextRandomInt(0xFFFFFFFF), nextRandomInt(0xFFFFFFFF)]\r\n\r\n    serializer.storeMethod('ping', { ping_id: pingID })\r\n\r\n    const pingMessage = {\r\n      msg_id: generateID(),\r\n      seq_no: this.generateSeqNo(true),\r\n      body  : serializer.getBytes()\r\n    }\r\n\r\n    const self = this\r\n    this.sendEncryptedRequest(pingMessage, { timeout: 15000 }).then(result =>\r\n      self.toggleOffline(false)\r\n    , () => {\r\n      console.log(dTime(), 'Delay ', self.checkConnectionPeriod * 1000)\r\n      self.checkConnectionPromise = smartTimeout(\r\n        self.checkConnection, parseInt(self.checkConnectionPeriod * 1000))\r\n      self.checkConnectionPeriod = Math.min(60, self.checkConnectionPeriod * 1.5)\r\n    })\r\n  }\r\n\r\n  toggleOffline(enabled) {\r\n    // console.log('toggle ', enabled, this.dcID, this.iii)\r\n    if (this.offline !== undefined && this.offline == enabled) {\r\n      return false\r\n    }\r\n\r\n    this.offline = enabled\r\n\r\n    if (this.offline) {\r\n      smartTimeout.cancel(this.nextReqPromise)\r\n      delete this.nextReq\r\n\r\n      if (this.checkConnectionPeriod < 1.5) {\r\n        this.checkConnectionPeriod = 0\r\n      }\r\n\r\n      this.checkConnectionPromise = smartTimeout(\r\n        this.checkConnection, parseInt(this.checkConnectionPeriod * 1000))\r\n      this.checkConnectionPeriod = Math.min(30, (1 + this.checkConnectionPeriod) * 1.5)\r\n\r\n      this.onOnlineCb = this.checkConnection\r\n\r\n      $(document.body).on('online focus', this.onOnlineCb)\r\n    } else {\r\n      delete this.longPollPending\r\n      this.checkLongPoll()\r\n      this.sheduleRequest()\r\n\r\n      if (this.onOnlineCb) {\r\n        $(document.body).off('online focus', this.onOnlineCb)\r\n      }\r\n      smartTimeout.cancel(this.checkConnectionPromise)\r\n    }\r\n  }\r\n  onNoResponseMsg = msgID => {\r\n    if (this.sentMessages[msgID]) {\r\n      const deferred = this.sentMessages[msgID].deferred\r\n      delete this.sentMessages[msgID]\r\n      return deferred.resolve()\r\n    }\r\n  }\r\n  onNoResponseMsgReject = msgID => {\r\n    if (this.sentMessages[msgID]) {\r\n      const deferred = this.sentMessages[msgID].deferred\r\n      delete this.sentMessages[msgID]\r\n      delete this.pendingMessages[msgID]\r\n      return deferred.reject()\r\n    }\r\n  }\r\n  resetPendingMessage = msgID => this.pendingMessages[msgID] = 0\r\n  performSheduledRequest = () => { //TODO extract huge method\r\n    // console.log(dTime(), 'sheduled', this.dcID, this.iii)\r\n    if (this.offline || akStopped) {\r\n      console.log(dTime(), 'Cancel sheduled')\r\n      return false\r\n    }\r\n    delete this.nextReq\r\n    if (this.pendingAcks.length) {\r\n      const ackMsgIDs = []\r\n      for (let i = 0; i < this.pendingAcks.length; i++) {\r\n        ackMsgIDs.push(this.pendingAcks[i])\r\n      }\r\n      // console.log('acking messages', ackMsgIDs)\r\n      this.wrapMtpMessage({ _: 'msgs_ack', msg_ids: ackMsgIDs }, { notContentRelated: true, noShedule: true })\r\n    }\r\n\r\n    if (this.pendingResends.length) {\r\n      const resendMsgIDs = []\r\n      const resendOpts = { noShedule: true, notContentRelated: true }\r\n      for (let i = 0; i < this.pendingResends.length; i++) {\r\n        resendMsgIDs.push(this.pendingResends[i])\r\n      }\r\n      // console.log('resendReq messages', resendMsgIDs)\r\n      this.wrapMtpMessage({ _: 'msg_resend_req', msg_ids: resendMsgIDs }, resendOpts)\r\n      this.lastResendReq = { req_msg_id: resendOpts.messageID, resend_msg_ids: resendMsgIDs }\r\n    }\r\n\r\n    const messages = []\r\n    let message,\r\n        messagesByteLen = 0\r\n    const currentTime = tsNow()\r\n    let hasApiCall = false\r\n    let hasHttpWait = false\r\n    let lengthOverflow = false\r\n    let singlesCount = 0\r\n\r\n    const onPendingMessage = (value, messageID) => {\r\n      if (!(!value || value >= currentTime)) return\r\n      message = this.sentMessages[messageID]\r\n      if (message) {\r\n        const messageByteLength = (message.body.byteLength || message.body.length) + 32\r\n        const cond1 = !message.notContentRelated && lengthOverflow\r\n        const cond2 =\r\n          !message.notContentRelated &&\r\n          messagesByteLen &&\r\n          messagesByteLen + messageByteLength > 655360 // 640 Kb\r\n        if (cond1) return\r\n        if (cond2) {\r\n          lengthOverflow = true\r\n          return\r\n        }\r\n        if (message.singleInRequest) {\r\n          singlesCount++\r\n          if (singlesCount > 1) return\r\n        }\r\n        messages.push(message)\r\n        messagesByteLen += messageByteLength\r\n        if (message.isAPI)\r\n          hasApiCall = true\r\n        else if (message.longPoll)\r\n          hasHttpWait = true\r\n      } else {\r\n        // console.log(message, messageID)\r\n      }\r\n      delete this.pendingMessages[messageID]\r\n    }\r\n\r\n    forEach(this.pendingMessages, onPendingMessage)\r\n\r\n    if (hasApiCall && !hasHttpWait) {\r\n      const serializer = new TLSerialization({ mtproto: true })\r\n      serializer.storeMethod('http_wait', {\r\n        max_delay : 500,\r\n        wait_after: 150,\r\n        max_wait  : 3000\r\n      })\r\n      messages.push({\r\n        msg_id: generateID(),\r\n        seq_no: this.generateSeqNo(),\r\n        body  : serializer.getBytes()\r\n      })\r\n    }\r\n\r\n    if (!messages.length) {\r\n      // console.log('no sheduled messages')\r\n      return\r\n    }\r\n\r\n    const noResponseMsgs = []\r\n\r\n    if (messages.length > 1) {\r\n      const container = new TLSerialization({ mtproto: true, startMaxLength: messagesByteLen + 64 })\r\n      container.storeInt(0x73f1f8dc, 'CONTAINER[id]')\r\n      container.storeInt(messages.length, 'CONTAINER[count]')\r\n      const onloads = []\r\n      const innerMessages = []\r\n      for (let i = 0; i < messages.length; i++) {\r\n        container.storeLong(messages[i].msg_id, `CONTAINER[${  i  }][msg_id]`)\r\n        innerMessages.push(messages[i].msg_id)\r\n        container.storeInt(messages[i].seq_no, `CONTAINER[${  i  }][seq_no]`)\r\n        container.storeInt(messages[i].body.length, `CONTAINER[${  i  }][bytes]`)\r\n        container.storeRawBytes(messages[i].body, `CONTAINER[${  i  }][body]`)\r\n        if (messages[i].noResponse) {\r\n          noResponseMsgs.push(messages[i].msg_id)\r\n        }\r\n      }\r\n\r\n      const containerSentMessage = {\r\n        msg_id   : generateID(),\r\n        seq_no   : this.generateSeqNo(true),\r\n        container: true,\r\n        inner    : innerMessages\r\n      }\r\n\r\n      message = { body: container.getBytes(true), ...containerSentMessage }\r\n\r\n      this.sentMessages[message.msg_id] = containerSentMessage\r\n\r\n      if (Config.Modes.debug) {\r\n        console.log(dTime(), 'Container', innerMessages, message.msg_id, message.seq_no)\r\n      }\r\n    } else {\r\n      if (message.noResponse) {\r\n        noResponseMsgs.push(message.msg_id)\r\n      }\r\n      this.sentMessages[message.msg_id] = message\r\n    }\r\n\r\n    this.pendingAcks = []\r\n    const afterSendRequest = result => {\r\n      this.toggleOffline(false)\r\n      // console.log('parse for', message)\r\n      this\r\n        .parseResponse(result.data)\r\n        .then(afterResponseParse)\r\n    }\r\n    const afterResponseParse = response => {\r\n      if (Config.Modes.debug)\r\n        console.log(dTime(), 'Server response', this.dcID, response)\r\n\r\n      this.processMessage(\r\n        response.response,\r\n        response.messageID,\r\n        response.sessionID)\r\n\r\n      forEach(noResponseMsgs, this.onNoResponseMsg)\r\n\r\n      this.checkLongPoll()\r\n\r\n      this.checkConnectionPeriod = Math.max(1.1, Math.sqrt(this.checkConnectionPeriod))\r\n    }\r\n    const onRequestFail = error => {\r\n      console.log('Encrypted request failed', error)\r\n\r\n      if (message.container) {\r\n        forEach(message.inner, this.resetPendingMessage)\r\n        delete this.sentMessages[message.msg_id]\r\n      } else\r\n        this.pendingMessages[message.msg_id] = 0\r\n\r\n      forEach(noResponseMsgs, this.onNoResponseMsgReject)\r\n\r\n      this.toggleOffline(true)\r\n    }\r\n    this.sendEncryptedRequest(message)\r\n      .then(afterSendRequest)\r\n      .catch(onRequestFail)\r\n\r\n    if (lengthOverflow || singlesCount > 1) this.sheduleRequest()\r\n  }\r\n\r\n  getEncryptedMessage(bytes) {\r\n    let msgKey\r\n    const f1 = CryptoWorker.sha1Hash\r\n    const f2 = bytesHash => {\r\n      msgKey = new Uint8Array(bytesHash).subarray(4, 20)\r\n      return this.getMsgKeyIv(msgKey, true)\r\n    }\r\n    const f3 = keyIv => CryptoWorker.aesEncrypt(bytes, keyIv[0], keyIv[1])\r\n    const f4 = encryptedBytes => ({\r\n      bytes : encryptedBytes,\r\n      msgKey: msgKey\r\n    })\r\n    const encryptFlow = pipeP(f1, f2, f3, f4)\r\n    return encryptFlow(bytes)\r\n  }\r\n\r\n  getDecryptedMessage(msgKey, encryptedData) {\r\n    const getKeyCurry = key => this.getMsgKeyIv(key, false)\r\n    const cryptoAesCurry = keyIv => CryptoWorker.aesDecrypt(encryptedData, keyIv[0], keyIv[1])\r\n    const decryptFlow = pipeP(getKeyCurry, cryptoAesCurry)\r\n    return decryptFlow(msgKey)\r\n  }\r\n\r\n  getRequestUrl = () => chooseServer(this.dcID, this.upload)\r\n\r\n  sendEncryptedRequest = (message, options = {}) => {\r\n    // console.log(dTime(), 'Send encrypted'/*, message*/)\r\n    // console.trace()\r\n    const data = new TLSerialization({ startMaxLength: message.body.length + 64 })\r\n\r\n    data.storeIntBytes(this.serverSalt, 64, 'salt')\r\n    data.storeIntBytes(this.sessionID, 64, 'session_id')\r\n\r\n    data.storeLong(message.msg_id, 'message_id')\r\n    data.storeInt(message.seq_no, 'seq_no')\r\n\r\n    data.storeInt(message.body.length, 'message_data_length')\r\n    data.storeRawBytes(message.body, 'message_data')\r\n\r\n    const url = this.getRequestUrl()\r\n    const baseError = { code: 406, type: 'NETWORK_BAD_RESPONSE', url: url }\r\n\r\n    const afterRequestData = result => {\r\n      if (!result.data || !result.data.byteLength)\r\n        return Promise.reject(baseError)\r\n      return result\r\n    }\r\n\r\n    const afterRequestReject = error => {\r\n      if (!error.message && !error.type)\r\n        error = { type: 'NETWORK_BAD_REQUEST', originalError: error, ...baseError }\r\n      return Promise.reject(error)\r\n    }\r\n\r\n    const onEncryptedResult = encryptedResult => {\r\n      // console.log(dTime(), 'Got encrypted out message'/*, encryptedResult*/)\r\n      const request = new TLSerialization({ startMaxLength: encryptedResult.bytes.byteLength + 256 })\r\n      request.storeIntBytes(this.authKeyID, 64, 'auth_key_id')\r\n      request.storeIntBytes(encryptedResult.msgKey, 128, 'msg_key')\r\n      request.storeRawBytes(encryptedResult.bytes, 'encrypted_data')\r\n\r\n      const requestData = xhrSendBuffer\r\n        ? request.getBuffer()\r\n        : request.getArray()\r\n\r\n      try {\r\n        options = { responseType: 'arraybuffer', ...options }\r\n        return httpClient.post(url, requestData, options)\r\n      } catch (e) {\r\n        return Promise.reject(e)\r\n      }\r\n    }\r\n\r\n    return this\r\n      .getEncryptedMessage(data.getBuffer())\r\n      .then(onEncryptedResult)\r\n      .then(\r\n        afterRequestData,\r\n        afterRequestReject)\r\n  }\r\n\r\n  getMsgById = ({ req_msg_id }) => this.sentMessages[req_msg_id]\r\n\r\n  parseResponse(responseBuffer) {\r\n    // console.log(dTime(), 'Start parsing response')\r\n    const self = this\r\n\r\n    const deserializer = new TLDeserialization(responseBuffer)\r\n\r\n    const authKeyID = deserializer.fetchIntBytes(64, false, 'auth_key_id')\r\n    if (!bytesCmp(authKeyID, this.authKeyID)) {\r\n      throw new Error(`[MT] Invalid server auth_key_id: ${  bytesToHex(authKeyID)}`)\r\n    }\r\n    const msgKey = deserializer.fetchIntBytes(128, true, 'msg_key')\r\n    const encryptedData = deserializer.fetchRawBytes(\r\n      responseBuffer.byteLength - deserializer.getOffset(),\r\n      true,\r\n      'encrypted_data')\r\n\r\n    const afterDecrypt = dataWithPadding => {\r\n      // console.log(dTime(), 'after decrypt')\r\n      const deserializer = new TLDeserialization(dataWithPadding, { mtproto: true })\r\n\r\n      const salt = deserializer.fetchIntBytes(64, false, 'salt')\r\n      const sessionID = deserializer.fetchIntBytes(64, false, 'session_id')\r\n      const messageID = deserializer.fetchLong('message_id')\r\n\r\n      const isInvalidSession =\r\n        !bytesCmp(sessionID, this.sessionID) && (\r\n          !this.prevSessionID ||\r\n          !bytesCmp(sessionID, this.prevSessionID))\r\n      if (isInvalidSession) {\r\n        console.warn('Sessions', sessionID, this.sessionID, this.prevSessionID)\r\n        throw new Error(`[MT] Invalid server session_id: ${ bytesToHex(sessionID) }`)\r\n      }\r\n\r\n      const seqNo = deserializer.fetchInt('seq_no')\r\n\r\n      let offset = deserializer.getOffset()\r\n      const totalLength = dataWithPadding.byteLength\r\n\r\n      const messageBodyLength = deserializer.fetchInt('message_data[length]')\r\n      if ((messageBodyLength % 4) ||\r\n          messageBodyLength > totalLength - offset) {\r\n        throw new Error(`[MT] Invalid body length: ${  messageBodyLength}`)\r\n      }\r\n      const messageBody = deserializer.fetchRawBytes(messageBodyLength, true, 'message_data')\r\n\r\n      offset = deserializer.getOffset()\r\n      const paddingLength = totalLength - offset\r\n      if (paddingLength < 0 || paddingLength > 15)\r\n        throw new Error(`[MT] Invalid padding length: ${  paddingLength}`)\r\n      const hashData = convertToUint8Array(dataWithPadding).subarray(0, offset)\r\n\r\n      const afterShaHash = dataHash => {\r\n        if (!bytesCmp(msgKey, bytesFromArrayBuffer(dataHash).slice(-16))) {\r\n          console.warn(msgKey, bytesFromArrayBuffer(dataHash))\r\n          throw new Error('[MT] server msgKey mismatch')\r\n        }\r\n\r\n        const buffer = bytesToArrayBuffer(messageBody)\r\n        const deserializerOptions = getDeserializeOpts(this.getMsgById)\r\n        const deserializer = new TLDeserialization(buffer, deserializerOptions)\r\n        const response = deserializer.fetchObject('', 'INPUT')\r\n\r\n        return {\r\n          response : response,\r\n          messageID: messageID,\r\n          sessionID: sessionID,\r\n          seqNo    : seqNo\r\n        }\r\n      }\r\n      return CryptoWorker\r\n        .sha1Hash(hashData)\r\n        .then(afterShaHash)\r\n    }\r\n\r\n\r\n    return this\r\n      .getDecryptedMessage(msgKey, encryptedData)\r\n      .then(afterDecrypt)\r\n  }\r\n\r\n  applyServerSalt(newServerSalt) {\r\n    const serverSalt = longToBytes(newServerSalt)\r\n\r\n    const storeObj = {\r\n      [`dc${ this.dcID }_server_salt`]: bytesToHex(serverSalt)\r\n    }\r\n    PureStorage.set(storeObj)\r\n\r\n    this.serverSalt = serverSalt\r\n    return true\r\n  }\r\n\r\n  sheduleRequest(delay = 0) {\r\n    if (this.offline) this.checkConnection('forced shedule')\r\n    const nextReq = tsNow() + delay\r\n\r\n    if (delay && this.nextReq && this.nextReq <= nextReq)\r\n      return false\r\n\r\n    // console.log(dTime(), 'shedule req', delay)\r\n    // console.trace()\r\n    smartTimeout.cancel(this.nextReqPromise)\r\n    if (delay > 0)\r\n      this.nextReqPromise = smartTimeout(\r\n        this.performSheduledRequest, delay)\r\n    else\r\n      setZeroTimeout(this.performSheduledRequest)\r\n\r\n    this.nextReq = nextReq\r\n  }\r\n\r\n  ackMessage(msgID) {\r\n    // console.log('ack message', msgID)\r\n    this.pendingAcks.push(msgID)\r\n    this.sheduleRequest(30000)\r\n  }\r\n\r\n  reqResendMessage(msgID) {\r\n    console.log(dTime(), 'Req resend', msgID)\r\n    this.pendingResends.push(msgID)\r\n    this.sheduleRequest(100)\r\n  }\r\n\r\n  cleanupSent() {\r\n    let notEmpty = false\r\n    // console.log('clean start', this.dcID/*, this.sentMessages*/)\r\n    const cleanMessages = (message, msgID) => {\r\n      // console.log('clean iter', msgID, message)\r\n      if (message.notContentRelated && this.pendingMessages[msgID] === undefined) {\r\n        // console.log('clean notContentRelated', msgID)\r\n        delete this.sentMessages[msgID]\r\n      }\r\n      else if (message.container) {\r\n        for (let i = 0; i < message.inner.length; i++) {\r\n          if (this.sentMessages[message.inner[i]] !== undefined) {\r\n            // console.log('clean failed, found', msgID, message.inner[i], this.sentMessages[message.inner[i]].seq_no)\r\n            notEmpty = true\r\n            return\r\n          }\r\n        }\r\n        // console.log('clean container', msgID)\r\n        delete this.sentMessages[msgID]\r\n      } else {\r\n        notEmpty = true\r\n      }\r\n    }\r\n    forEach(this.sentMessages, cleanMessages)\r\n\r\n    return !notEmpty\r\n  }\r\n\r\n  processMessageAck = messageID => {\r\n    const sentMessage = this.sentMessages[messageID]\r\n    if (sentMessage && !sentMessage.acked) {\r\n      delete sentMessage.body\r\n      sentMessage.acked = true\r\n\r\n      return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  processError(rawError) {\r\n    const matches = (rawError.error_message || '').match(/^([A-Z_0-9]+\\b)(: (.+))?/) || []\r\n    rawError.error_code = uintToInt(rawError.error_code)\r\n\r\n    return {\r\n      code: !rawError.error_code || rawError.error_code <= 0\r\n        ? 500\r\n        : rawError.error_code,\r\n      type         : matches[1] || 'UNKNOWN',\r\n      description  : matches[3] || (`CODE#${  rawError.error_code  } ${  rawError.error_message}`),\r\n      originalError: rawError\r\n    }\r\n  }\r\n  spliceMessage = badMsgID => {\r\n    const pos = this.pendingResends.indexOf(badMsgID)\r\n    if (pos !== -1)\r\n      this.pendingResends.splice(pos, 1)\r\n  }\r\n  processMessage(message, messageID, sessionID) {\r\n    const msgidInt = parseInt(messageID.toString(10).substr(0, -10), 10)\r\n    if (msgidInt % 2) {\r\n      console.warn('[MT] Server even message id: ', messageID, message)\r\n      return\r\n    }\r\n    // console.log('process message', message, messageID, sessionID)\r\n    switch (message._) {\r\n      case 'msg_container': {\r\n        const len = message.messages.length\r\n        for (let i = 0; i < len; i++) {\r\n          this.processMessage(message.messages[i], message.messages[i].msg_id, sessionID)\r\n        }\r\n        break\r\n      }\r\n      case 'bad_server_salt': {\r\n        console.log(dTime(), 'Bad server salt', message)\r\n        const sentMessage = this.sentMessages[message.bad_msg_id]\r\n        if (!sentMessage || sentMessage.seq_no != message.bad_msg_seqno) {\r\n          console.log(message.bad_msg_id, message.bad_msg_seqno)\r\n          throw new Error('[MT] Bad server salt for invalid message')\r\n        }\r\n\r\n        this.applyServerSalt(message.new_server_salt)\r\n        this.pushResend(message.bad_msg_id)\r\n        this.ackMessage(messageID)\r\n        break\r\n      }\r\n      case 'bad_msg_notification': {\r\n        console.log(dTime(), 'Bad msg notification', message)\r\n        const sentMessage = this.sentMessages[message.bad_msg_id]\r\n        if (!sentMessage || sentMessage.seq_no != message.bad_msg_seqno) {\r\n          console.log(message.bad_msg_id, message.bad_msg_seqno)\r\n          throw new Error('[MT] Bad msg notification for invalid message')\r\n        }\r\n\r\n        if (message.error_code == 16 || message.error_code == 17) {\r\n          if (applyServerTime(\r\n              bigStringInt(messageID)\r\n                .shiftRight(32)\r\n                .toString(10)\r\n            )) {\r\n            console.log(dTime(), 'Update session')\r\n            this.updateSession()\r\n          }\r\n          const badMessage = this.updateSentMessage(message.bad_msg_id)\r\n          this.pushResend(badMessage.msg_id)\r\n          this.ackMessage(messageID)\r\n        }\r\n        break\r\n      }\r\n      case 'message': {\r\n        if (this.lastServerMessages.indexOf(messageID) != -1) {\r\n          // console.warn('[MT] Server same messageID: ', messageID)\r\n          this.ackMessage(messageID)\r\n          return\r\n        }\r\n        this.lastServerMessages.push(messageID)\r\n        if (this.lastServerMessages.length > 100) {\r\n          this.lastServerMessages.shift()\r\n        }\r\n        this.processMessage(message.body, message.msg_id, sessionID)\r\n        break\r\n      }\r\n      case 'new_session_created': {\r\n        this.ackMessage(messageID)\r\n\r\n        this.processMessageAck(message.first_msg_id)\r\n        this.applyServerSalt(message.server_salt)\r\n\r\n        const onBaseDc = baseDcID => {\r\n          const updateCond =\r\n            baseDcID === this.dcID &&\r\n            !this.upload &&\r\n            updatesProcessor\r\n          if (updateCond)\r\n            updatesProcessor(message, true)\r\n        }\r\n        PureStorage.get('dc').then(onBaseDc)\r\n        break\r\n      }\r\n      case 'msgs_ack': {\r\n        message.msg_ids.forEach(this.processMessageAck)\r\n        break\r\n      }\r\n      case 'msg_detailed_info': {\r\n        if (!this.sentMessages[message.msg_id]) {\r\n          this.ackMessage(message.answer_msg_id)\r\n          break\r\n        }\r\n        break\r\n      }\r\n      case 'msg_new_detailed_info': {\r\n        // this.ackMessage(message.answer_msg_id)\r\n        this.reqResendMessage(message.answer_msg_id)\r\n        break\r\n      }\r\n      case 'msgs_state_info': {\r\n        this.ackMessage(message.answer_msg_id)\r\n        const spliceCond =\r\n          this.lastResendReq &&\r\n          this.lastResendReq.req_msg_id == message.req_msg_id &&\r\n          this.pendingResends.length\r\n        if (spliceCond)\r\n          this.lastResendReq.resend_msg_ids.forEach(this.spliceMessage)\r\n        break\r\n      }\r\n      case 'rpc_result': {\r\n        this.ackMessage(messageID)\r\n\r\n        const sentMessageID = message.req_msg_id\r\n        const sentMessage = this.sentMessages[sentMessageID]\r\n\r\n        this.processMessageAck(sentMessageID)\r\n        if (!sentMessage) break\r\n\r\n        const deferred = sentMessage.deferred\r\n        if (message.result._ == 'rpc_error') {\r\n          const error = this.processError(message.result)\r\n          console.log(dTime(), 'Rpc error', error)\r\n          if (deferred) {\r\n            deferred.reject(error)\r\n          }\r\n        } else {\r\n          if (deferred) {\r\n            if (Config.Modes.debug) {\r\n              console.log(dTime(), 'Rpc response', message.result)\r\n            } else {\r\n              let dRes = message.result._\r\n              if (!dRes)\r\n                dRes = message.result.length > 5\r\n                  ? `[..${  message.result.length  }..]`\r\n                  : message.result\r\n              console.log(dTime(), 'Rpc response', dRes)\r\n            }\r\n            sentMessage.deferred.resolve(message.result)\r\n          }\r\n          if (sentMessage.isAPI)\r\n            this.connectionInited = true\r\n        }\r\n\r\n        delete this.sentMessages[sentMessageID]\r\n        break\r\n      }\r\n      default: {\r\n        this.ackMessage(messageID)\r\n\r\n        // console.log('Update', message)\r\n        if (updatesProcessor) updatesProcessor(message, true)\r\n        break\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst getDeserializeOpts = msgGetter => ({\r\n  mtproto : true,\r\n  override: {\r\n    mt_message: function(result, field) {\r\n      result.msg_id = this.fetchLong(`${field  }[msg_id]`)\r\n      result.seqno = this.fetchInt(`${field  }[seqno]`)\r\n      result.bytes = this.fetchInt(`${field  }[bytes]`)\r\n\r\n      const offset = this.getOffset()\r\n\r\n      try {\r\n        result.body = this.fetchObject('Object', `${field  }[body]`)\r\n      } catch (e) {\r\n        console.error(dTime(), 'parse error', e.message, e.stack)\r\n        result.body = { _: 'parse_error', error: e }\r\n      }\r\n      if (this.offset != offset + result.bytes) {\r\n        // console.warn(dTime(), 'set offset', this.offset, offset, result.bytes)\r\n        // console.log(dTime(), result)\r\n        this.offset = offset + result.bytes\r\n      }\r\n      // console.log(dTime(), 'override message', result)\r\n    },\r\n    mt_rpc_result: function(result, field) {\r\n      result.req_msg_id = this.fetchLong(`${ field }[req_msg_id]`)\r\n\r\n      const sentMessage = msgGetter(result)\r\n      const type = sentMessage && sentMessage.resultType || 'Object'\r\n\r\n      if (result.req_msg_id && !sentMessage) {\r\n        // console.warn(dTime(), 'Result for unknown message', result)\r\n        return\r\n      }\r\n      result.result = this.fetchObject(type, `${ field }[result]`)\r\n      // console.log(dTime(), 'override rpc_result', sentMessage, type, result)\r\n    }\r\n  }\r\n})\r\n\r\nexport const startAll = () => {\r\n  if (akStopped) {\r\n    akStopped = false\r\n    updatesProcessor({ _: 'new_session_created' }, true)\r\n  }\r\n}\r\n\r\nexport const stopAll = () => akStopped = true\r\n\r\nexport const getNetworker = (dcID, authKey, serverSalt, options) =>\r\n  new MtpNetworker(dcID, authKey, serverSalt, options)\r\n\r\nexport const setUpdatesProcessor = callback =>\r\n  updatesProcessor = callback\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/networker.js","////////////////////////////////////////////////////////////////////////////////////////\r\n// Big Integer Library v. 5.5\r\n// Created 2000, last modified 2013\r\n// Leemon Baird\r\n// www.leemon.com\r\n//\r\n// Version history:\r\n// v 5.5  17 Mar 2013\r\n//   - two lines of a form like \"if (x<0) x+=n\" had the \"if\" changed to \"while\" to\r\n//     handle the case when x<-n. (Thanks to James Ansell for finding that bug)\r\n// v 5.4  3 Oct 2009\r\n//   - added \"var i\" to greaterShift() so i is not global. (Thanks to Pter Szab for finding that bug)\r\n//\r\n// v 5.3  21 Sep 2009\r\n//   - added randProbPrime(k) for probable primes\r\n//   - unrolled loop in mont_ (slightly faster)\r\n//   - millerRabin now takes a bigInt parameter rather than an int\r\n//\r\n// v 5.2  15 Sep 2009\r\n//   - fixed capitalization in call to int2bigInt in randBigInt\r\n//     (thanks to Emili Evripidou, Reinhold Behringer, and Samuel Macaleese for finding that bug)\r\n//\r\n// v 5.1  8 Oct 2007\r\n//   - renamed inverseModInt_ to inverseModInt since it doesn't change its parameters\r\n//   - added functions GCD and randBigInt, which call GCD_ and randBigInt_\r\n//   - fixed a bug found by Rob Visser (see comment with his name below)\r\n//   - improved comments\r\n//\r\n// This file is public domain.   You can use it for any purpose without restriction.\r\n// I do not guarantee that it is correct, so use it at your own risk.  If you use\r\n// it for something interesting, I'd appreciate hearing about it.  If you find\r\n// any bugs or make any improvements, I'd appreciate hearing about those too.\r\n// It would also be nice if my name and URL were left in the comments.  But none\r\n// of that is required.\r\n//\r\n// This code defines a bigInt library for arbitrary-precision integers.\r\n// A bigInt is an array of integers storing the value in chunks of bpe bits,\r\n// little endian (buff[0] is the least significant word).\r\n// Negative bigInts are stored two's complement.  Almost all the functions treat\r\n// bigInts as nonnegative.  The few that view them as two's complement say so\r\n// in their comments.  Some functions assume their parameters have at least one\r\n// leading zero element. Functions with an underscore at the end of the name put\r\n// their answer into one of the arrays passed in, and have unpredictable behavior\r\n// in case of overflow, so the caller must make sure the arrays are big enough to\r\n// hold the answer.  But the average user should never have to call any of the\r\n// underscored functions.  Each important underscored function has a wrapper function\r\n// of the same name without the underscore that takes care of the details for you.\r\n// For each underscored function where a parameter is modified, that same variable\r\n// must not be used as another argument too.  So, you cannot square x by doing\r\n// multMod_(x,x,n).  You must use squareMod_(x,n) instead, or do y=dup(x); multMod_(x,y,n).\r\n// Or simply use the multMod(x,x,n) function without the underscore, where\r\n// such issues never arise, because non-underscored functions never change\r\n// their parameters; they always allocate new memory for the answer that is returned.\r\n//\r\n// These functions are designed to avoid frequent dynamic memory allocation in the inner loop.\r\n// For most functions, if it needs a BigInt as a local variable it will actually use\r\n// a global, and will only allocate to it only when it's not the right size.  This ensures\r\n// that when a function is called repeatedly with same-sized parameters, it only allocates\r\n// memory on the first call.\r\n//\r\n// Note that for cryptographic purposes, the calls to Math.random() must\r\n// be replaced with calls to a better pseudorandom number generator.\r\n//\r\n// In the following, \"bigInt\" means a bigInt with at least one leading zero element,\r\n// and \"integer\" means a nonnegative integer less than radix.  In some cases, integer\r\n// can be negative.  Negative bigInts are 2s complement.\r\n//\r\n// The following functions do not modify their inputs.\r\n// Those returning a bigInt, string, or Array will dynamically allocate memory for that value.\r\n// Those returning a boolean will return the integer 0 (false) or 1 (true).\r\n// Those returning boolean or int will not allocate memory except possibly on the first\r\n// time they're called with a given parameter size.\r\n//\r\n// bigInt  add(x,y)               //return (x+y) for bigInts x and y.\r\n// bigInt  addInt(x,n)            //return (x+n) where x is a bigInt and n is an integer.\r\n// string  bigInt2str(x,base)     //return a string form of bigInt x in a given base, with 2 <= base <= 95\r\n// int     bitSize(x)             //return how many bits long the bigInt x is, not counting leading zeros\r\n// bigInt  dup(x)                 //return a copy of bigInt x\r\n// boolean equals(x,y)            //is the bigInt x equal to the bigint y?\r\n// boolean equalsInt(x,y)         //is bigint x equal to integer y?\r\n// bigInt  expand(x,n)            //return a copy of x with at least n elements, adding leading zeros if needed\r\n// Array   findPrimes(n)          //return array of all primes less than integer n\r\n// bigInt  GCD(x,y)               //return greatest common divisor of bigInts x and y (each with same number of elements).\r\n// boolean greater(x,y)           //is x>y?  (x and y are nonnegative bigInts)\r\n// boolean greaterShift(x,y,shift)//is (x <<(shift*bpe)) > y?\r\n// bigInt  int2bigInt(t,n,m)      //return a bigInt equal to integer t, with at least n bits and m array elements\r\n// bigInt  inverseMod(x,n)        //return (x**(-1) mod n) for bigInts x and n.  If no inverse exists, it returns null\r\n// int     inverseModInt(x,n)     //return x**(-1) mod n, for integers x and n.  Return 0 if there is no inverse\r\n// boolean isZero(x)              //is the bigInt x equal to zero?\r\n// boolean millerRabin(x,b)       //does one round of Miller-Rabin base integer b say that bigInt x is possibly prime? (b is bigInt, 1<b<x)\r\n// boolean millerRabinInt(x,b)    //does one round of Miller-Rabin base integer b say that bigInt x is possibly prime? (b is int,    1<b<x)\r\n// bigInt  mod(x,n)               //return a new bigInt equal to (x mod n) for bigInts x and n.\r\n// int     modInt(x,n)            //return x mod n for bigInt x and integer n.\r\n// bigInt  mult(x,y)              //return x*y for bigInts x and y. This is faster when y<x.\r\n// bigInt  multMod(x,y,n)         //return (x*y mod n) for bigInts x,y,n.  For greater speed, let y<x.\r\n// boolean negative(x)            //is bigInt x negative?\r\n// bigInt  powMod(x,y,n)          //return (x**y mod n) where x,y,n are bigInts and ** is exponentiation.  0**0=1. Faster for odd n.\r\n// bigInt  randBigInt(n,s)        //return an n-bit random BigInt (n>=1).  If s=1, then the most significant of those n bits is set to 1.\r\n// bigInt  randTruePrime(k)       //return a new, random, k-bit, true prime bigInt using Maurer's algorithm.\r\n// bigInt  randProbPrime(k)       //return a new, random, k-bit, probable prime bigInt (probability it's composite less than 2^-80).\r\n// bigInt  str2bigInt(s,b,n,m)    //return a bigInt for number represented in string s in base b with at least n bits and m array elements\r\n// bigInt  sub(x,y)               //return (x-y) for bigInts x and y.  Negative answers will be 2s complement\r\n// bigInt  trim(x,k)              //return a copy of x with exactly k leading zero elements\r\n//\r\n//\r\n// The following functions each have a non-underscored version, which most users should call instead.\r\n// These functions each write to a single parameter, and the caller is responsible for ensuring the array\r\n// passed in is large enough to hold the result.\r\n//\r\n// void    addInt_(x,n)          //do x=x+n where x is a bigInt and n is an integer\r\n// void    add_(x,y)             //do x=x+y for bigInts x and y\r\n// void    copy_(x,y)            //do x=y on bigInts x and y\r\n// void    copyInt_(x,n)         //do x=n on bigInt x and integer n\r\n// void    GCD_(x,y)             //set x to the greatest common divisor of bigInts x and y, (y is destroyed).  (This never overflows its array).\r\n// boolean inverseMod_(x,n)      //do x=x**(-1) mod n, for bigInts x and n. Returns 1 (0) if inverse does (doesn't) exist\r\n// void    mod_(x,n)             //do x=x mod n for bigInts x and n. (This never overflows its array).\r\n// void    mult_(x,y)            //do x=x*y for bigInts x and y.\r\n// void    multMod_(x,y,n)       //do x=x*y  mod n for bigInts x,y,n.\r\n// void    powMod_(x,y,n)        //do x=x**y mod n, where x,y,n are bigInts (n is odd) and ** is exponentiation.  0**0=1.\r\n// void    randBigInt_(b,n,s)    //do b = an n-bit random BigInt. if s=1, then nth bit (most significant bit) is set to 1. n>=1.\r\n// void    randTruePrime_(ans,k) //do ans = a random k-bit true random prime (not just probable prime) with 1 in the msb.\r\n// void    sub_(x,y)             //do x=x-y for bigInts x and y. Negative answers will be 2s complement.\r\n//\r\n// The following functions do NOT have a non-underscored version.\r\n// They each write a bigInt result to one or more parameters.  The caller is responsible for\r\n// ensuring the arrays passed in are large enough to hold the results.\r\n//\r\n// void addShift_(x,y,ys)       //do x=x+(y<<(ys*bpe))\r\n// void carry_(x)               //do carries and borrows so each element of the bigInt x fits in bpe bits.\r\n// void divide_(x,y,q,r)        //divide x by y giving quotient q and remainder r\r\n// int  divInt_(x,n)            //do x=floor(x/n) for bigInt x and integer n, and return the remainder. (This never overflows its array).\r\n// int  eGCD_(x,y,d,a,b)        //sets a,b,d to positive bigInts such that d = GCD_(x,y) = a*x-b*y\r\n// void halve_(x)               //do x=floor(|x|/2)*sgn(x) for bigInt x in 2's complement.  (This never overflows its array).\r\n// void leftShift_(x,n)         //left shift bigInt x by n bits.  n<bpe.\r\n// void linComb_(x,y,a,b)       //do x=a*x+b*y for bigInts x and y and integers a and b\r\n// void linCombShift_(x,y,b,ys) //do x=x+b*(y<<(ys*bpe)) for bigInts x and y, and integers b and ys\r\n// void mont_(x,y,n,np)         //Montgomery multiplication (see comments where the function is defined)\r\n// void multInt_(x,n)           //do x=x*n where x is a bigInt and n is an integer.\r\n// void rightShift_(x,n)        //right shift bigInt x by n bits.  0 <= n < bpe. (This never overflows its array).\r\n// void squareMod_(x,n)         //do x=x*x  mod n for bigInts x,n\r\n// void subShift_(x,y,ys)       //do x=x-(y<<(ys*bpe)). Negative answers will be 2s complement.\r\n//\r\n// The following functions are based on algorithms from the _Handbook of Applied Cryptography_\r\n//    powMod_()           = algorithm 14.94, Montgomery exponentiation\r\n//    eGCD_,inverseMod_() = algorithm 14.61, Binary extended GCD_\r\n//    GCD_()              = algorothm 14.57, Lehmer's algorithm\r\n//    mont_()             = algorithm 14.36, Montgomery multiplication\r\n//    divide_()           = algorithm 14.20  Multiple-precision division\r\n//    squareMod_()        = algorithm 14.16  Multiple-precision squaring\r\n//    randTruePrime_()    = algorithm  4.62, Maurer's algorithm\r\n//    millerRabin()       = algorithm  4.24, Miller-Rabin algorithm\r\n//\r\n// Profiling shows:\r\n//     randTruePrime_() spends:\r\n//         10% of its time in calls to powMod_()\r\n//         85% of its time in calls to millerRabin()\r\n//     millerRabin() spends:\r\n//         99% of its time in calls to powMod_()   (always with a base of 2)\r\n//     powMod_() spends:\r\n//         94% of its time in calls to mont_()  (almost always with x==y)\r\n//\r\n// This suggests there are several ways to speed up this library slightly:\r\n//     - convert powMod_ to use a Montgomery form of k-ary window (or maybe a Montgomery form of sliding window)\r\n//         -- this should especially focus on being fast when raising 2 to a power mod n\r\n//     - convert randTruePrime_() to use a minimum r of 1/3 instead of 1/2 with the appropriate change to the test\r\n//     - tune the parameters in randTruePrime_(), including c, m, and recLimit\r\n//     - speed up the single loop in mont_() that takes 95% of the runtime, perhaps by reducing checking\r\n//       within the loop when all the parameters are the same length.\r\n//\r\n// There are several ideas that look like they wouldn't help much at all:\r\n//     - replacing trial division in randTruePrime_() with a sieve (that speeds up something taking almost no time anyway)\r\n//     - increase bpe from 15 to 30 (that would help if we had a 32*32->64 multiplier, but not with JavaScript's 32*32->32)\r\n//     - speeding up mont_(x,y,n,np) when x==y by doing a non-modular, non-Montgomery square\r\n//       followed by a Montgomery reduction.  The intermediate answer will be twice as long as x, so that\r\n//       method would be slower.  This is unfortunate because the code currently spends almost all of its time\r\n//       doing mont_(x,x,...), both for randTruePrime_() and powMod_().  A faster method for Montgomery squaring\r\n//       would have a large impact on the speed of randTruePrime_() and powMod_().  HAC has a couple of poorly-worded\r\n//       sentences that seem to imply it's faster to do a non-modular square followed by a single\r\n//       Montgomery reduction, but that's obviously wrong.\r\n////////////////////////////////////////////////////////////////////////////////////////\r\n\r\n//globals\r\nexport var bpe=0;         //bits stored per array element\r\nvar mask=0;        //AND this with an array element to chop it down to bpe bits\r\nvar radix=mask+1;  //equals 2^bpe.  A single 1 bit to the left of the last bit of mask.\r\n\r\n//the digits for converting to different bases\r\nvar digitsStr='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_=!@#$%^&*()[]{}|;:,.<>/?`~ \\\\\\'\\\"+-';\r\n\r\n//initialize the global variables\r\nfor (bpe=0; (1<<(bpe+1)) > (1<<bpe); bpe++);  //bpe=number of bits in the mantissa on this platform\r\nbpe>>=1;                   //bpe=number of bits in one element of the array representing the bigInt\r\nmask=(1<<bpe)-1;           //AND the mask with an integer to get its bpe least significant bits\r\nradix=mask+1;              //2^bpe.  a single 1 bit to the left of the first bit of mask\r\nexport var one=int2bigInt(1,1,1);     //constant used in powMod_()\r\n\r\n//the following global variables are scratchpad memory to\r\n//reduce dynamic memory allocation in the inner loop\r\nvar t=new Array(0);\r\nvar ss=t;       //used in mult_()\r\nvar s0=t;       //used in multMod_(), squareMod_()\r\nvar s1=t;       //used in powMod_(), multMod_(), squareMod_()\r\nvar s2=t;       //used in powMod_(), multMod_()\r\nvar s3=t;       //used in powMod_()\r\nvar s4=t, s5=t; //used in mod_()\r\nvar s6=t;       //used in bigInt2str()\r\nvar s7=t;       //used in powMod_()\r\nvar T=t;        //used in GCD_()\r\nvar sa=t;       //used in mont_()\r\nvar mr_x1=t, mr_r=t, mr_a=t,                                      //used in millerRabin()\r\neg_v=t, eg_u=t, eg_A=t, eg_B=t, eg_C=t, eg_D=t,               //used in eGCD_(), inverseMod_()\r\nmd_q1=t, md_q2=t, md_q3=t, md_r=t, md_r1=t, md_r2=t, md_tt=t, //used in mod_()\r\n\r\nprimes=t, pows=t, s_i=t, s_i2=t, s_R=t, s_rm=t, s_q=t, s_n1=t,\r\n  s_a=t, s_r2=t, s_n=t, s_b=t, s_d=t, s_x1=t, s_x2=t, s_aa=t, //used in randTruePrime_()\r\n\r\nrpprb=t; //used in randProbPrimeRounds() (which also uses \"primes\")\r\n\r\n////////////////////////////////////////////////////////////////////////////////////////\r\n\r\nvar k, buff\r\n\r\n//return array of all primes less than integer n\r\nfunction findPrimes(n) {\r\n  var i,s,p,ans;\r\n  s=new Array(n);\r\n  for (i=0;i<n;i++)\r\n    s[i]=0;\r\n  s[0]=2;\r\n  p=0;    //first p elements of s are primes, the rest are a sieve\r\n  for(;s[p]<n;) {                  //s[p] is the pth prime\r\n    for(i=s[p]*s[p]; i<n; i+=s[p]) //mark multiples of s[p]\r\n      s[i]=1;\r\n    p++;\r\n    s[p]=s[p-1]+1;\r\n    for(; s[p]<n && s[s[p]]; s[p]++); //find next prime (where s[p]==0)\r\n  }\r\n  ans=new Array(p);\r\n  for(i=0;i<p;i++)\r\n    ans[i]=s[i];\r\n  return ans;\r\n}\r\n\r\n\r\n//does a single round of Miller-Rabin base b consider x to be a possible prime?\r\n//x is a bigInt, and b is an integer, with b<x\r\nfunction millerRabinInt(x,b) {\r\n  if (mr_x1.length!=x.length) {\r\n    mr_x1=dup(x);\r\n    mr_r=dup(x);\r\n    mr_a=dup(x);\r\n  }\r\n\r\n  copyInt_(mr_a,b);\r\n  return millerRabin(x,mr_a);\r\n}\r\n\r\n//does a single round of Miller-Rabin base b consider x to be a possible prime?\r\n//x and b are bigInts with b<x\r\nfunction millerRabin(x,b) {\r\n  var i,j,k,s;\r\n\r\n  if (mr_x1.length!=x.length) {\r\n    mr_x1=dup(x);\r\n    mr_r=dup(x);\r\n    mr_a=dup(x);\r\n  }\r\n\r\n  copy_(mr_a,b);\r\n  copy_(mr_r,x);\r\n  copy_(mr_x1,x);\r\n\r\n  addInt_(mr_r,-1);\r\n  addInt_(mr_x1,-1);\r\n\r\n  //s=the highest power of two that divides mr_r\r\n  k=0;\r\n  for (i=0;i<mr_r.length;i++)\r\n    for (j=1;j<mask;j<<=1)\r\n      if (x[i] & j) {\r\n        s=(k<mr_r.length+bpe ? k : 0);\r\n         i=mr_r.length;\r\n         j=mask;\r\n      } else\r\n        k++;\r\n\r\n  if (s)\r\n    rightShift_(mr_r,s);\r\n\r\n  powMod_(mr_a,mr_r,x);\r\n\r\n  if (!equalsInt(mr_a,1) && !equals(mr_a,mr_x1)) {\r\n    j=1;\r\n    while (j<=s-1 && !equals(mr_a,mr_x1)) {\r\n      squareMod_(mr_a,x);\r\n      if (equalsInt(mr_a,1)) {\r\n        return 0;\r\n      }\r\n      j++;\r\n    }\r\n    if (!equals(mr_a,mr_x1)) {\r\n      return 0;\r\n    }\r\n  }\r\n  return 1;\r\n}\r\n\r\n//returns how many bits long the bigInt is, not counting leading zeros.\r\nfunction bitSize(x) {\r\n  var j,z,w;\r\n  for (j=x.length-1; (x[j]==0) && (j>0); j--);\r\n  for (z=0,w=x[j]; w; (w>>=1),z++);\r\n  z+=bpe*j;\r\n  return z;\r\n}\r\n\r\n//return a copy of x with at least n elements, adding leading zeros if needed\r\nfunction expand(x,n) {\r\n  var ans=int2bigInt(0,(x.length>n ? x.length : n)*bpe,0);\r\n  copy_(ans,x);\r\n  return ans;\r\n}\r\n\r\n//return a k-bit true random prime using Maurer's algorithm.\r\nfunction randTruePrime(k) {\r\n  var ans=int2bigInt(0,k,0);\r\n  randTruePrime_(ans,k);\r\n  return trim(ans,1);\r\n}\r\n\r\n//return a k-bit random probable prime with probability of error < 2^-80\r\nfunction randProbPrime(k) {\r\n  if (k>=600) return randProbPrimeRounds(k,2); //numbers from HAC table 4.3\r\n  if (k>=550) return randProbPrimeRounds(k,4);\r\n  if (k>=500) return randProbPrimeRounds(k,5);\r\n  if (k>=400) return randProbPrimeRounds(k,6);\r\n  if (k>=350) return randProbPrimeRounds(k,7);\r\n  if (k>=300) return randProbPrimeRounds(k,9);\r\n  if (k>=250) return randProbPrimeRounds(k,12); //numbers from HAC table 4.4\r\n  if (k>=200) return randProbPrimeRounds(k,15);\r\n  if (k>=150) return randProbPrimeRounds(k,18);\r\n  if (k>=100) return randProbPrimeRounds(k,27);\r\n              return randProbPrimeRounds(k,40); //number from HAC remark 4.26 (only an estimate)\r\n}\r\n\r\n//return a k-bit probable random prime using n rounds of Miller Rabin (after trial division with small primes)\r\nfunction randProbPrimeRounds(k,n) {\r\n  var ans, i, divisible, B;\r\n  B=30000;  //B is largest prime to use in trial division\r\n  ans=int2bigInt(0,k,0);\r\n\r\n  //optimization: try larger and smaller B to find the best limit.\r\n\r\n  if (primes.length==0)\r\n    primes=findPrimes(30000);  //check for divisibility by primes <=30000\r\n\r\n  if (rpprb.length!=ans.length)\r\n    rpprb=dup(ans);\r\n\r\n  for (;;) { //keep trying random values for ans until one appears to be prime\r\n    //optimization: pick a random number times L=2*3*5*...*p, plus a\r\n    //   random element of the list of all numbers in [0,L) not divisible by any prime up to p.\r\n    //   This can reduce the amount of random number generation.\r\n\r\n    randBigInt_(ans,k,0); //ans = a random odd number to check\r\n    ans[0] |= 1;\r\n    divisible=0;\r\n\r\n    //check ans for divisibility by small primes up to B\r\n    for (i=0; (i<primes.length) && (primes[i]<=B); i++)\r\n      if (modInt(ans,primes[i])==0 && !equalsInt(ans,primes[i])) {\r\n        divisible=1;\r\n        break;\r\n      }\r\n\r\n    //optimization: change millerRabin so the base can be bigger than the number being checked, then eliminate the while here.\r\n\r\n    //do n rounds of Miller Rabin, with random bases less than ans\r\n    for (i=0; i<n && !divisible; i++) {\r\n      randBigInt_(rpprb,k,0);\r\n      while(!greater(ans,rpprb)) //pick a random rpprb that's < ans\r\n        randBigInt_(rpprb,k,0);\r\n      if (!millerRabin(ans,rpprb))\r\n        divisible=1;\r\n    }\r\n\r\n    if(!divisible)\r\n      return ans;\r\n  }\r\n}\r\n\r\n//return a new bigInt equal to (x mod n) for bigInts x and n.\r\nfunction mod(x,n) {\r\n  var ans=dup(x);\r\n  mod_(ans,n);\r\n  return trim(ans,1);\r\n}\r\n\r\n//return (x+n) where x is a bigInt and n is an integer.\r\nfunction addInt(x,n) {\r\n  var ans=expand(x,x.length+1);\r\n  addInt_(ans,n);\r\n  return trim(ans,1);\r\n}\r\n\r\n//return x*y for bigInts x and y. This is faster when y<x.\r\nfunction mult(x,y) {\r\n  var ans=expand(x,x.length+y.length);\r\n  mult_(ans,y);\r\n  return trim(ans,1);\r\n}\r\n\r\n//return (x**y mod n) where x,y,n are bigInts and ** is exponentiation.  0**0=1. Faster for odd n.\r\nexport function powMod(x,y,n) {\r\n  var ans=expand(x,n.length);\r\n  powMod_(ans,trim(y,2),trim(n,2),0);  //this should work without the trim, but doesn't\r\n  return trim(ans,1);\r\n}\r\n\r\n//return (x-y) for bigInts x and y.  Negative answers will be 2s complement\r\nfunction sub(x,y) {\r\n  var ans=expand(x,(x.length>y.length ? x.length+1 : y.length+1));\r\n  sub_(ans,y);\r\n  return trim(ans,1);\r\n}\r\n\r\n//return (x+y) for bigInts x and y.\r\nfunction add(x,y) {\r\n  var ans=expand(x,(x.length>y.length ? x.length+1 : y.length+1));\r\n  add_(ans,y);\r\n  return trim(ans,1);\r\n}\r\n\r\n//return (x**(-1) mod n) for bigInts x and n.  If no inverse exists, it returns null\r\nfunction inverseMod(x,n) {\r\n  var ans=expand(x,n.length);\r\n  var s;\r\n  s=inverseMod_(ans,n);\r\n  return s ? trim(ans,1) : null;\r\n}\r\n\r\n//return (x*y mod n) for bigInts x,y,n.  For greater speed, let y<x.\r\nfunction multMod(x,y,n) {\r\n  var ans=expand(x,n.length);\r\n  multMod_(ans,y,n);\r\n  return trim(ans,1);\r\n}\r\n\r\n//generate a k-bit true random prime using Maurer's algorithm,\r\n//and put it into ans.  The bigInt ans must be large enough to hold it.\r\nfunction randTruePrime_(ans,k) {\r\n  var c,m,pm,dd,j,r,B,divisible,z,zz,recSize;\r\n\r\n  if (primes.length==0)\r\n    primes=findPrimes(30000);  //check for divisibility by primes <=30000\r\n\r\n  if (pows.length==0) {\r\n    pows=new Array(512);\r\n    for (j=0;j<512;j++) {\r\n      pows[j]=Math.pow(2,j/511.-1.);\r\n    }\r\n  }\r\n\r\n  //c and m should be tuned for a particular machine and value of k, to maximize speed\r\n  c=0.1;  //c=0.1 in HAC\r\n  m=20;   //generate this k-bit number by first recursively generating a number that has between k/2 and k-m bits\r\n  recLimit=20; //stop recursion when k <=recLimit.  Must have recLimit >= 2\r\n\r\n  if (s_i2.length!=ans.length) {\r\n    s_i2=dup(ans);\r\n    s_R =dup(ans);\r\n    s_n1=dup(ans);\r\n    s_r2=dup(ans);\r\n    s_d =dup(ans);\r\n    s_x1=dup(ans);\r\n    s_x2=dup(ans);\r\n    s_b =dup(ans);\r\n    s_n =dup(ans);\r\n    s_i =dup(ans);\r\n    s_rm=dup(ans);\r\n    s_q =dup(ans);\r\n    s_a =dup(ans);\r\n    s_aa=dup(ans);\r\n  }\r\n\r\n  if (k <= recLimit) {  //generate small random primes by trial division up to its square root\r\n    pm=(1<<((k+2)>>1))-1; //pm is binary number with all ones, just over sqrt(2^k)\r\n    copyInt_(ans,0);\r\n    for (dd=1;dd;) {\r\n      dd=0;\r\n      ans[0]= 1 | (1<<(k-1)) | Math.floor(Math.random()*(1<<k));  //random, k-bit, odd integer, with msb 1\r\n      for (j=1;(j<primes.length) && ((primes[j]&pm)==primes[j]);j++) { //trial division by all primes 3...sqrt(2^k)\r\n        if (0==(ans[0]%primes[j])) {\r\n          dd=1;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    carry_(ans);\r\n    return;\r\n  }\r\n\r\n  B=c*k*k;    //try small primes up to B (or all the primes[] array if the largest is less than B).\r\n  if (k>2*m)  //generate this k-bit number by first recursively generating a number that has between k/2 and k-m bits\r\n    for (r=1; k-k*r<=m; )\r\n      r=pows[Math.floor(Math.random()*512)];   //r=Math.pow(2,Math.random()-1);\r\n  else\r\n    r=.5;\r\n\r\n  //simulation suggests the more complex algorithm using r=.333 is only slightly faster.\r\n\r\n  recSize=Math.floor(r*k)+1;\r\n\r\n  randTruePrime_(s_q,recSize);\r\n  copyInt_(s_i2,0);\r\n  s_i2[Math.floor((k-2)/bpe)] |= (1<<((k-2)%bpe));   //s_i2=2^(k-2)\r\n  divide_(s_i2,s_q,s_i,s_rm);                        //s_i=floor((2^(k-1))/(2q))\r\n\r\n  z=bitSize(s_i);\r\n\r\n  for (;;) {\r\n    for (;;) {  //generate z-bit numbers until one falls in the range [0,s_i-1]\r\n      randBigInt_(s_R,z,0);\r\n      if (greater(s_i,s_R))\r\n        break;\r\n    }                //now s_R is in the range [0,s_i-1]\r\n    addInt_(s_R,1);  //now s_R is in the range [1,s_i]\r\n    add_(s_R,s_i);   //now s_R is in the range [s_i+1,2*s_i]\r\n\r\n    copy_(s_n,s_q);\r\n    mult_(s_n,s_R);\r\n    multInt_(s_n,2);\r\n    addInt_(s_n,1);    //s_n=2*s_R*s_q+1\r\n\r\n    copy_(s_r2,s_R);\r\n    multInt_(s_r2,2);  //s_r2=2*s_R\r\n\r\n    //check s_n for divisibility by small primes up to B\r\n    for (divisible=0,j=0; (j<primes.length) && (primes[j]<B); j++)\r\n      if (modInt(s_n,primes[j])==0 && !equalsInt(s_n,primes[j])) {\r\n        divisible=1;\r\n        break;\r\n      }\r\n\r\n    if (!divisible)    //if it passes small primes check, then try a single Miller-Rabin base 2\r\n      if (!millerRabinInt(s_n,2)) //this line represents 75% of the total runtime for randTruePrime_\r\n        divisible=1;\r\n\r\n    if (!divisible) {  //if it passes that test, continue checking s_n\r\n      addInt_(s_n,-3);\r\n      for (j=s_n.length-1;(s_n[j]==0) && (j>0); j--);  //strip leading zeros\r\n      for (zz=0,w=s_n[j]; w; (w>>=1),zz++);\r\n      zz+=bpe*j;                             //zz=number of bits in s_n, ignoring leading zeros\r\n      for (;;) {  //generate z-bit numbers until one falls in the range [0,s_n-1]\r\n        randBigInt_(s_a,zz,0);\r\n        if (greater(s_n,s_a))\r\n          break;\r\n      }                //now s_a is in the range [0,s_n-1]\r\n      addInt_(s_n,3);  //now s_a is in the range [0,s_n-4]\r\n      addInt_(s_a,2);  //now s_a is in the range [2,s_n-2]\r\n      copy_(s_b,s_a);\r\n      copy_(s_n1,s_n);\r\n      addInt_(s_n1,-1);\r\n      powMod_(s_b,s_n1,s_n);   //s_b=s_a^(s_n-1) modulo s_n\r\n      addInt_(s_b,-1);\r\n      if (isZero(s_b)) {\r\n        copy_(s_b,s_a);\r\n        powMod_(s_b,s_r2,s_n);\r\n        addInt_(s_b,-1);\r\n        copy_(s_aa,s_n);\r\n        copy_(s_d,s_b);\r\n        GCD_(s_d,s_n);  //if s_b and s_n are relatively prime, then s_n is a prime\r\n        if (equalsInt(s_d,1)) {\r\n          copy_(ans,s_aa);\r\n          return;     //if we've made it this far, then s_n is absolutely guaranteed to be prime\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n//Return an n-bit random BigInt (n>=1).  If s=1, then the most significant of those n bits is set to 1.\r\nfunction randBigInt(n,s) {\r\n  var a,b;\r\n  a=Math.floor((n-1)/bpe)+2; //# array elements to hold the BigInt with a leading 0 element\r\n  b=int2bigInt(0,0,a);\r\n  randBigInt_(b,n,s);\r\n  return b;\r\n}\r\n\r\n//Set b to an n-bit random BigInt.  If s=1, then the most significant of those n bits is set to 1.\r\n//Array b must be big enough to hold the result. Must have n>=1\r\nfunction randBigInt_(b,n,s) {\r\n  var i,a;\r\n  for (i=0;i<b.length;i++)\r\n    b[i]=0;\r\n  a=Math.floor((n-1)/bpe)+1; //# array elements to hold the BigInt\r\n  for (i=0;i<a;i++) {\r\n    b[i]=Math.floor(Math.random()*(1<<(bpe-1)));\r\n  }\r\n  b[a-1] &= (2<<((n-1)%bpe))-1;\r\n  if (s==1)\r\n    b[a-1] |= (1<<((n-1)%bpe));\r\n}\r\n\r\n//Return the greatest common divisor of bigInts x and y (each with same number of elements).\r\nfunction GCD(x,y) {\r\n  var xc,yc;\r\n  xc=dup(x);\r\n  yc=dup(y);\r\n  GCD_(xc,yc);\r\n  return xc;\r\n}\r\n\r\n//set x to the greatest common divisor of bigInts x and y (each with same number of elements).\r\n//y is destroyed.\r\nfunction GCD_(x,y) {\r\n  var i,xp,yp,A,B,C,D,q,sing;\r\n  if (T.length!=x.length)\r\n    T=dup(x);\r\n\r\n  sing=1;\r\n  while (sing) { //while y has nonzero elements other than y[0]\r\n    sing=0;\r\n    for (i=1;i<y.length;i++) //check if y has nonzero elements other than 0\r\n      if (y[i]) {\r\n        sing=1;\r\n        break;\r\n      }\r\n    if (!sing) break; //quit when y all zero elements except possibly y[0]\r\n\r\n    for (i=x.length;!x[i] && i>=0;i--);  //find most significant element of x\r\n    xp=x[i];\r\n    yp=y[i];\r\n    A=1; B=0; C=0; D=1;\r\n    while ((yp+C) && (yp+D)) {\r\n      q =Math.floor((xp+A)/(yp+C));\r\n      qp=Math.floor((xp+B)/(yp+D));\r\n      if (q!=qp)\r\n        break;\r\n      t= A-q*C;   A=C;   C=t;    //  do (A,B,xp, C,D,yp) = (C,D,yp, A,B,xp) - q*(0,0,0, C,D,yp)\r\n      t= B-q*D;   B=D;   D=t;\r\n      t=xp-q*yp; xp=yp; yp=t;\r\n    }\r\n    if (B) {\r\n      copy_(T,x);\r\n      linComb_(x,y,A,B); //x=A*x+B*y\r\n      linComb_(y,T,D,C); //y=D*y+C*T\r\n    } else {\r\n      mod_(x,y);\r\n      copy_(T,x);\r\n      copy_(x,y);\r\n      copy_(y,T);\r\n    }\r\n  }\r\n  if (y[0]==0)\r\n    return;\r\n  t=modInt(x,y[0]);\r\n  copyInt_(x,y[0]);\r\n  y[0]=t;\r\n  while (y[0]) {\r\n    x[0]%=y[0];\r\n    t=x[0]; x[0]=y[0]; y[0]=t;\r\n  }\r\n}\r\n\r\n//do x=x**(-1) mod n, for bigInts x and n.\r\n//If no inverse exists, it sets x to zero and returns 0, else it returns 1.\r\n//The x array must be at least as large as the n array.\r\nfunction inverseMod_(x,n) {\r\n  var k=1+2*Math.max(x.length,n.length);\r\n\r\n  if(!(x[0]&1)  && !(n[0]&1)) {  //if both inputs are even, then inverse doesn't exist\r\n    copyInt_(x,0);\r\n    return 0;\r\n  }\r\n\r\n  if (eg_u.length!=k) {\r\n    eg_u=new Array(k);\r\n    eg_v=new Array(k);\r\n    eg_A=new Array(k);\r\n    eg_B=new Array(k);\r\n    eg_C=new Array(k);\r\n    eg_D=new Array(k);\r\n  }\r\n\r\n  copy_(eg_u,x);\r\n  copy_(eg_v,n);\r\n  copyInt_(eg_A,1);\r\n  copyInt_(eg_B,0);\r\n  copyInt_(eg_C,0);\r\n  copyInt_(eg_D,1);\r\n  for (;;) {\r\n    while(!(eg_u[0]&1)) {  //while eg_u is even\r\n      halve_(eg_u);\r\n      if (!(eg_A[0]&1) && !(eg_B[0]&1)) { //if eg_A==eg_B==0 mod 2\r\n        halve_(eg_A);\r\n        halve_(eg_B);\r\n      } else {\r\n        add_(eg_A,n);  halve_(eg_A);\r\n        sub_(eg_B,x);  halve_(eg_B);\r\n      }\r\n    }\r\n\r\n    while (!(eg_v[0]&1)) {  //while eg_v is even\r\n      halve_(eg_v);\r\n      if (!(eg_C[0]&1) && !(eg_D[0]&1)) { //if eg_C==eg_D==0 mod 2\r\n        halve_(eg_C);\r\n        halve_(eg_D);\r\n      } else {\r\n        add_(eg_C,n);  halve_(eg_C);\r\n        sub_(eg_D,x);  halve_(eg_D);\r\n      }\r\n    }\r\n\r\n    if (!greater(eg_v,eg_u)) { //eg_v <= eg_u\r\n      sub_(eg_u,eg_v);\r\n      sub_(eg_A,eg_C);\r\n      sub_(eg_B,eg_D);\r\n    } else {                   //eg_v > eg_u\r\n      sub_(eg_v,eg_u);\r\n      sub_(eg_C,eg_A);\r\n      sub_(eg_D,eg_B);\r\n    }\r\n\r\n    if (equalsInt(eg_u,0)) {\r\n      while (negative(eg_C)) //make sure answer is nonnegative\r\n        add_(eg_C,n);\r\n      copy_(x,eg_C);\r\n\r\n      if (!equalsInt(eg_v,1)) { //if GCD_(x,n)!=1, then there is no inverse\r\n        copyInt_(x,0);\r\n        return 0;\r\n      }\r\n      return 1;\r\n    }\r\n  }\r\n}\r\n\r\n//return x**(-1) mod n, for integers x and n.  Return 0 if there is no inverse\r\nfunction inverseModInt(x,n) {\r\n  var a=1,b=0,t;\r\n  for (;;) {\r\n    if (x==1) return a;\r\n    if (x==0) return 0;\r\n    b-=a*Math.floor(n/x);\r\n    n%=x;\r\n\r\n    if (n==1) return b; //to avoid negatives, change this b to n-b, and each -= to +=\r\n    if (n==0) return 0;\r\n    a-=b*Math.floor(x/n);\r\n    x%=n;\r\n  }\r\n}\r\n\r\n//this deprecated function is for backward compatibility only.\r\nfunction inverseModInt_(x,n) {\r\n   return inverseModInt(x,n);\r\n}\r\n\r\n\r\n//Given positive bigInts x and y, change the bigints v, a, and b to positive bigInts such that:\r\n//     v = GCD_(x,y) = a*x-b*y\r\n//The bigInts v, a, b, must have exactly as many elements as the larger of x and y.\r\nexport function eGCD_(x,y,v,a,b) {\r\n  var g=0;\r\n  var k=Math.max(x.length,y.length);\r\n  if (eg_u.length!=k) {\r\n    eg_u=new Array(k);\r\n    eg_A=new Array(k);\r\n    eg_B=new Array(k);\r\n    eg_C=new Array(k);\r\n    eg_D=new Array(k);\r\n  }\r\n  while(!(x[0]&1)  && !(y[0]&1)) {  //while x and y both even\r\n    halve_(x);\r\n    halve_(y);\r\n    g++;\r\n  }\r\n  copy_(eg_u,x);\r\n  copy_(v,y);\r\n  copyInt_(eg_A,1);\r\n  copyInt_(eg_B,0);\r\n  copyInt_(eg_C,0);\r\n  copyInt_(eg_D,1);\r\n  for (;;) {\r\n    while(!(eg_u[0]&1)) {  //while u is even\r\n      halve_(eg_u);\r\n      if (!(eg_A[0]&1) && !(eg_B[0]&1)) { //if A==B==0 mod 2\r\n        halve_(eg_A);\r\n        halve_(eg_B);\r\n      } else {\r\n        add_(eg_A,y);  halve_(eg_A);\r\n        sub_(eg_B,x);  halve_(eg_B);\r\n      }\r\n    }\r\n\r\n    while (!(v[0]&1)) {  //while v is even\r\n      halve_(v);\r\n      if (!(eg_C[0]&1) && !(eg_D[0]&1)) { //if C==D==0 mod 2\r\n        halve_(eg_C);\r\n        halve_(eg_D);\r\n      } else {\r\n        add_(eg_C,y);  halve_(eg_C);\r\n        sub_(eg_D,x);  halve_(eg_D);\r\n      }\r\n    }\r\n\r\n    if (!greater(v,eg_u)) { //v<=u\r\n      sub_(eg_u,v);\r\n      sub_(eg_A,eg_C);\r\n      sub_(eg_B,eg_D);\r\n    } else {                //v>u\r\n      sub_(v,eg_u);\r\n      sub_(eg_C,eg_A);\r\n      sub_(eg_D,eg_B);\r\n    }\r\n    if (equalsInt(eg_u,0)) {\r\n      while (negative(eg_C)) {   //make sure a (C) is nonnegative\r\n        add_(eg_C,y);\r\n        sub_(eg_D,x);\r\n      }\r\n      multInt_(eg_D,-1);  ///make sure b (D) is nonnegative\r\n      copy_(a,eg_C);\r\n      copy_(b,eg_D);\r\n      leftShift_(v,g);\r\n      return;\r\n    }\r\n  }\r\n}\r\n\r\n\r\n//is bigInt x negative?\r\nfunction negative(x) {\r\n  return ((x[x.length-1]>>(bpe-1))&1);\r\n}\r\n\r\n\r\n//is (x << (shift*bpe)) > y?\r\n//x and y are nonnegative bigInts\r\n//shift is a nonnegative integer\r\nfunction greaterShift(x,y,shift) {\r\n  var i, kx=x.length, ky=y.length;\r\n  k=((kx+shift)<ky) ? (kx+shift) : ky;\r\n  for (i=ky-1-shift; i<kx && i>=0; i++)\r\n    if (x[i]>0)\r\n      return 1; //if there are nonzeros in x to the left of the first column of y, then x is bigger\r\n  for (i=kx-1+shift; i<ky; i++)\r\n    if (y[i]>0)\r\n      return 0; //if there are nonzeros in y to the left of the first column of x, then x is not bigger\r\n  for (i=k-1; i>=shift; i--)\r\n    if      (x[i-shift]>y[i]) return 1;\r\n    else if (x[i-shift]<y[i]) return 0;\r\n  return 0;\r\n}\r\n\r\n//is x > y? (x and y both nonnegative)\r\nexport function greater(x,y) {\r\n  var i;\r\n  var k=(x.length<y.length) ? x.length : y.length;\r\n\r\n  for (i=x.length;i<y.length;i++)\r\n    if (y[i])\r\n      return 0;  //y has more digits\r\n\r\n  for (i=y.length;i<x.length;i++)\r\n    if (x[i])\r\n      return 1;  //x has more digits\r\n\r\n  for (i=k-1;i>=0;i--)\r\n    if (x[i]>y[i])\r\n      return 1;\r\n    else if (x[i]<y[i])\r\n      return 0;\r\n  return 0;\r\n}\r\n\r\n//divide x by y giving quotient q and remainder r.  (q=floor(x/y),  r=x mod y).  All 4 are bigints.\r\n//x must have at least one leading zero element.\r\n//y must be nonzero.\r\n//q and r must be arrays that are exactly the same length as x. (Or q can have more).\r\n//Must have x.length >= y.length >= 2.\r\nexport function divide_(x,y,q,r) {\r\n  var kx, ky;\r\n  var i,j,y1,y2,c,a,b;\r\n  copy_(r,x);\r\n  for (ky=y.length;y[ky-1]==0;ky--); //ky is number of elements in y, not including leading zeros\r\n\r\n  //normalize: ensure the most significant element of y has its highest bit set\r\n  b=y[ky-1];\r\n  for (a=0; b; a++)\r\n    b>>=1;\r\n  a=bpe-a;  //a is how many bits to shift so that the high order bit of y is leftmost in its array element\r\n  leftShift_(y,a);  //multiply both by 1<<a now, then divide both by that at the end\r\n  leftShift_(r,a);\r\n\r\n  //Rob Visser discovered a bug: the following line was originally just before the normalization.\r\n  for (kx=r.length;r[kx-1]==0 && kx>ky;kx--); //kx is number of elements in normalized x, not including leading zeros\r\n\r\n  copyInt_(q,0);                      // q=0\r\n  while (!greaterShift(y,r,kx-ky)) {  // while (leftShift_(y,kx-ky) <= r) {\r\n    subShift_(r,y,kx-ky);             //   r=r-leftShift_(y,kx-ky)\r\n    q[kx-ky]++;                       //   q[kx-ky]++;\r\n  }                                   // }\r\n\r\n  for (i=kx-1; i>=ky; i--) {\r\n    if (r[i]==y[ky-1])\r\n      q[i-ky]=mask;\r\n    else\r\n      q[i-ky]=Math.floor((r[i]*radix+r[i-1])/y[ky-1]);\r\n\r\n    //The following for(;;) loop is equivalent to the commented while loop,\r\n    //except that the uncommented version avoids overflow.\r\n    //The commented loop comes from HAC, which assumes r[-1]==y[-1]==0\r\n    //  while (q[i-ky]*(y[ky-1]*radix+y[ky-2]) > r[i]*radix*radix+r[i-1]*radix+r[i-2])\r\n    //    q[i-ky]--;\r\n    for (;;) {\r\n      y2=(ky>1 ? y[ky-2] : 0)*q[i-ky];\r\n      c=y2>>bpe;\r\n      y2=y2 & mask;\r\n      y1=c+q[i-ky]*y[ky-1];\r\n      c=y1>>bpe;\r\n      y1=y1 & mask;\r\n\r\n      if (c==r[i] ? y1==r[i-1] ? y2>(i>1 ? r[i-2] : 0) : y1>r[i-1] : c>r[i])\r\n        q[i-ky]--;\r\n      else\r\n        break;\r\n    }\r\n\r\n    linCombShift_(r,y,-q[i-ky],i-ky);    //r=r-q[i-ky]*leftShift_(y,i-ky)\r\n    if (negative(r)) {\r\n      addShift_(r,y,i-ky);         //r=r+leftShift_(y,i-ky)\r\n      q[i-ky]--;\r\n    }\r\n  }\r\n\r\n  rightShift_(y,a);  //undo the normalization step\r\n  rightShift_(r,a);  //undo the normalization step\r\n}\r\n\r\n//do carries and borrows so each element of the bigInt x fits in bpe bits.\r\nfunction carry_(x) {\r\n  var i,k,c,b;\r\n  k=x.length;\r\n  c=0;\r\n  for (i=0;i<k;i++) {\r\n    c+=x[i];\r\n    b=0;\r\n    if (c<0) {\r\n      b=-(c>>bpe);\r\n      c+=b*radix;\r\n    }\r\n    x[i]=c & mask;\r\n    c=(c>>bpe)-b;\r\n  }\r\n}\r\n\r\n//return x mod n for bigInt x and integer n.\r\nfunction modInt(x,n) {\r\n  var i,c=0;\r\n  for (i=x.length-1; i>=0; i--)\r\n    c=(c*radix+x[i])%n;\r\n  return c;\r\n}\r\n\r\n//convert the integer t into a bigInt with at least the given number of bits.\r\n//the returned array stores the bigInt in bpe-bit chunks, little endian (buff[0] is least significant word)\r\n//Pad the array with leading zeros so that it has at least minSize elements.\r\n//There will always be at least one leading 0 element.\r\nfunction int2bigInt(t,bits,minSize) {\r\n  var i,k;\r\n  k=Math.ceil(bits/bpe)+1;\r\n  k=minSize>k ? minSize : k;\r\n  var buff=new Array(k);\r\n  copyInt_(buff,t);\r\n  return buff;\r\n}\r\n\r\n//return the bigInt given a string representation in a given base.\r\n//Pad the array with leading zeros so that it has at least minSize elements.\r\n//If base=-1, then it reads in a space-separated list of array elements in decimal.\r\n//The array will always have at least one leading zero, unless base=-1.\r\nexport function str2bigInt(s,base,minSize) {\r\n  var d, i, j, x, y, kk;\r\n  var k=s.length;\r\n  if (base==-1) { //comma-separated list of array elements in decimal\r\n    x=new Array(0);\r\n    for (;;) {\r\n      y=new Array(x.length+1);\r\n      for (i=0;i<x.length;i++)\r\n        y[i+1]=x[i];\r\n      y[0]=parseInt(s,10);\r\n      x=y;\r\n      d=s.indexOf(',',0);\r\n      if (d<1)\r\n        break;\r\n      s=s.substring(d+1);\r\n      if (s.length==0)\r\n        break;\r\n    }\r\n    if (x.length<minSize) {\r\n      y=new Array(minSize);\r\n      copy_(y,x);\r\n      return y;\r\n    }\r\n    return x;\r\n  }\r\n\r\n  x=int2bigInt(0,base*k,0);\r\n  for (i=0;i<k;i++) {\r\n    d=digitsStr.indexOf(s.substring(i,i+1),0);\r\n    if (base<=36 && d>=36)  //convert lowercase to uppercase if base<=36\r\n      d-=26;\r\n    if (d>=base || d<0) {   //stop at first illegal character\r\n      break;\r\n    }\r\n    multInt_(x,base);\r\n    addInt_(x,d);\r\n  }\r\n\r\n  for (k=x.length;k>0 && !x[k-1];k--); //strip off leading zeros\r\n  k=minSize>k+1 ? minSize : k+1;\r\n  y=new Array(k);\r\n  kk=k<x.length ? k : x.length;\r\n  for (i=0;i<kk;i++)\r\n    y[i]=x[i];\r\n  for (;i<k;i++)\r\n    y[i]=0;\r\n  return y;\r\n}\r\n\r\n//is bigint x equal to integer y?\r\n//y must have less than bpe bits\r\nexport function equalsInt(x,y) {\r\n  var i;\r\n  if (x[0]!=y)\r\n    return 0;\r\n  for (i=1;i<x.length;i++)\r\n    if (x[i])\r\n      return 0;\r\n  return 1;\r\n}\r\n\r\n//are bigints x and y equal?\r\n//this works even if x and y are different lengths and have arbitrarily many leading zeros\r\nfunction equals(x,y) {\r\n  var i;\r\n  var k=x.length<y.length ? x.length : y.length;\r\n  for (i=0;i<k;i++)\r\n    if (x[i]!=y[i])\r\n      return 0;\r\n  if (x.length>y.length) {\r\n    for (;i<x.length;i++)\r\n      if (x[i])\r\n        return 0;\r\n  } else {\r\n    for (;i<y.length;i++)\r\n      if (y[i])\r\n        return 0;\r\n  }\r\n  return 1;\r\n}\r\n\r\n//is the bigInt x equal to zero?\r\nexport function isZero(x) {\r\n  var i;\r\n  for (i=0;i<x.length;i++)\r\n    if (x[i])\r\n      return 0;\r\n  return 1;\r\n}\r\n\r\n//convert a bigInt into a string in a given base, from base 2 up to base 95.\r\n//Base -1 prints the contents of the array representing the number.\r\nexport function bigInt2str(x,base) {\r\n  var i,t,s=\"\";\r\n\r\n  if (s6.length!=x.length)\r\n    s6=dup(x);\r\n  else\r\n    copy_(s6,x);\r\n\r\n  if (base==-1) { //return the list of array contents\r\n    for (i=x.length-1;i>0;i--)\r\n      s+=x[i]+',';\r\n    s+=x[0];\r\n  }\r\n  else { //return it in the given base\r\n    while (!isZero(s6)) {\r\n      t=divInt_(s6,base);  //t=s6 % base; s6=floor(s6/base);\r\n      s=digitsStr.substring(t,t+1)+s;\r\n    }\r\n  }\r\n  if (s.length==0)\r\n    s=\"0\";\r\n  return s;\r\n}\r\n\r\n//returns a duplicate of bigInt x\r\nfunction dup(x) {\r\n  var i;\r\n  buff=new Array(x.length);\r\n  copy_(buff,x);\r\n  return buff;\r\n}\r\n\r\n//do x=y on bigInts x and y.  x must be an array at least as big as y (not counting the leading zeros in y).\r\nexport function copy_(x,y) {\r\n  var i;\r\n  var k=x.length<y.length ? x.length : y.length;\r\n  for (i=0;i<k;i++)\r\n    x[i]=y[i];\r\n  for (i=k;i<x.length;i++)\r\n    x[i]=0;\r\n}\r\n\r\n//do x=y on bigInt x and integer y.\r\nexport function copyInt_(x,n) {\r\n  var i,c;\r\n  for (c=n,i=0;i<x.length;i++) {\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do x=x+n where x is a bigInt and n is an integer.\r\n//x must be large enough to hold the result.\r\nfunction addInt_(x,n) {\r\n  var i,k,c,b;\r\n  x[0]+=n;\r\n  k=x.length;\r\n  c=0;\r\n  for (i=0;i<k;i++) {\r\n    c+=x[i];\r\n    b=0;\r\n    if (c<0) {\r\n      b=-(c>>bpe);\r\n      c+=b*radix;\r\n    }\r\n    x[i]=c & mask;\r\n    c=(c>>bpe)-b;\r\n    if (!c) return; //stop carrying as soon as the carry is zero\r\n  }\r\n}\r\n\r\n//right shift bigInt x by n bits.  0 <= n < bpe.\r\nexport function rightShift_(x,n) {\r\n  var i;\r\n  var k=Math.floor(n/bpe);\r\n  if (k) {\r\n    for (i=0;i<x.length-k;i++) //right shift x by k elements\r\n      x[i]=x[i+k];\r\n    for (;i<x.length;i++)\r\n      x[i]=0;\r\n    n%=bpe;\r\n  }\r\n  for (i=0;i<x.length-1;i++) {\r\n    x[i]=mask & ((x[i+1]<<(bpe-n)) | (x[i]>>n));\r\n  }\r\n  x[i]>>=n;\r\n}\r\n\r\n//do x=floor(|x|/2)*sgn(x) for bigInt x in 2's complement\r\nfunction halve_(x) {\r\n  var i;\r\n  for (i=0;i<x.length-1;i++) {\r\n    x[i]=mask & ((x[i+1]<<(bpe-1)) | (x[i]>>1));\r\n  }\r\n  x[i]=(x[i]>>1) | (x[i] & (radix>>1));  //most significant bit stays the same\r\n}\r\n\r\n//left shift bigInt x by n bits.\r\nfunction leftShift_(x,n) {\r\n  var i;\r\n  var k=Math.floor(n/bpe);\r\n  if (k) {\r\n    for (i=x.length; i>=k; i--) //left shift x by k elements\r\n      x[i]=x[i-k];\r\n    for (;i>=0;i--)\r\n      x[i]=0;\r\n    n%=bpe;\r\n  }\r\n  if (!n)\r\n    return;\r\n  for (i=x.length-1;i>0;i--) {\r\n    x[i]=mask & ((x[i]<<n) | (x[i-1]>>(bpe-n)));\r\n  }\r\n  x[i]=mask & (x[i]<<n);\r\n}\r\n\r\n//do x=x*n where x is a bigInt and n is an integer.\r\n//x must be large enough to hold the result.\r\nfunction multInt_(x,n) {\r\n  var i,k,c,b;\r\n  if (!n)\r\n    return;\r\n  k=x.length;\r\n  c=0;\r\n  for (i=0;i<k;i++) {\r\n    c+=x[i]*n;\r\n    b=0;\r\n    if (c<0) {\r\n      b=-(c>>bpe);\r\n      c+=b*radix;\r\n    }\r\n    x[i]=c & mask;\r\n    c=(c>>bpe)-b;\r\n  }\r\n}\r\n\r\n//do x=floor(x/n) for bigInt x and integer n, and return the remainder\r\nfunction divInt_(x,n) {\r\n  var i,r=0,s;\r\n  for (i=x.length-1;i>=0;i--) {\r\n    s=r*radix+x[i];\r\n    x[i]=Math.floor(s/n);\r\n    r=s%n;\r\n  }\r\n  return r;\r\n}\r\n\r\n//do the linear combination x=a*x+b*y for bigInts x and y, and integers a and b.\r\n//x must be large enough to hold the answer.\r\nfunction linComb_(x,y,a,b) {\r\n  var i,c,k,kk;\r\n  k=x.length<y.length ? x.length : y.length;\r\n  kk=x.length;\r\n  for (c=0,i=0;i<k;i++) {\r\n    c+=a*x[i]+b*y[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n  for (i=k;i<kk;i++) {\r\n    c+=a*x[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do the linear combination x=a*x+b*(y<<(ys*bpe)) for bigInts x and y, and integers a, b and ys.\r\n//x must be large enough to hold the answer.\r\nfunction linCombShift_(x,y,b,ys) {\r\n  var i,c,k,kk;\r\n  k=x.length<ys+y.length ? x.length : ys+y.length;\r\n  kk=x.length;\r\n  for (c=0,i=ys;i<k;i++) {\r\n    c+=x[i]+b*y[i-ys];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n  for (i=k;c && i<kk;i++) {\r\n    c+=x[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do x=x+(y<<(ys*bpe)) for bigInts x and y, and integers a,b and ys.\r\n//x must be large enough to hold the answer.\r\nfunction addShift_(x,y,ys) {\r\n  var i,c,k,kk;\r\n  k=x.length<ys+y.length ? x.length : ys+y.length;\r\n  kk=x.length;\r\n  for (c=0,i=ys;i<k;i++) {\r\n    c+=x[i]+y[i-ys];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n  for (i=k;c && i<kk;i++) {\r\n    c+=x[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do x=x-(y<<(ys*bpe)) for bigInts x and y, and integers a,b and ys.\r\n//x must be large enough to hold the answer.\r\nfunction subShift_(x,y,ys) {\r\n  var i,c,k,kk;\r\n  k=x.length<ys+y.length ? x.length : ys+y.length;\r\n  kk=x.length;\r\n  for (c=0,i=ys;i<k;i++) {\r\n    c+=x[i]-y[i-ys];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n  for (i=k;c && i<kk;i++) {\r\n    c+=x[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do x=x-y for bigInts x and y.\r\n//x must be large enough to hold the answer.\r\n//negative answers will be 2s complement\r\nexport function sub_(x,y) {\r\n  var i,c,k,kk;\r\n  k=x.length<y.length ? x.length : y.length;\r\n  for (c=0,i=0;i<k;i++) {\r\n    c+=x[i]-y[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n  for (i=k;c && i<x.length;i++) {\r\n    c+=x[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do x=x+y for bigInts x and y.\r\n//x must be large enough to hold the answer.\r\nexport function add_(x,y) {\r\n  var i,c,k,kk;\r\n  k=x.length<y.length ? x.length : y.length;\r\n  for (c=0,i=0;i<k;i++) {\r\n    c+=x[i]+y[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n  for (i=k;c && i<x.length;i++) {\r\n    c+=x[i];\r\n    x[i]=c & mask;\r\n    c>>=bpe;\r\n  }\r\n}\r\n\r\n//do x=x*y for bigInts x and y.  This is faster when y<x.\r\nfunction mult_(x,y) {\r\n  var i;\r\n  if (ss.length!=2*x.length)\r\n    ss=new Array(2*x.length);\r\n  copyInt_(ss,0);\r\n  for (i=0;i<y.length;i++)\r\n    if (y[i])\r\n      linCombShift_(ss,x,y[i],i);   //ss=1*ss+y[i]*(x<<(i*bpe))\r\n  copy_(x,ss);\r\n}\r\n\r\n//do x=x mod n for bigInts x and n.\r\nfunction mod_(x,n) {\r\n  if (s4.length!=x.length)\r\n    s4=dup(x);\r\n  else\r\n    copy_(s4,x);\r\n  if (s5.length!=x.length)\r\n    s5=dup(x);\r\n  divide_(s4,n,s5,x);  //x = remainder of s4 / n\r\n}\r\n\r\n//do x=x*y mod n for bigInts x,y,n.\r\n//for greater speed, let y<x.\r\nfunction multMod_(x,y,n) {\r\n  var i;\r\n  if (s0.length!=2*x.length)\r\n    s0=new Array(2*x.length);\r\n  copyInt_(s0,0);\r\n  for (i=0;i<y.length;i++)\r\n    if (y[i])\r\n      linCombShift_(s0,x,y[i],i);   //s0=1*s0+y[i]*(x<<(i*bpe))\r\n  mod_(s0,n);\r\n  copy_(x,s0);\r\n}\r\n\r\n//do x=x*x mod n for bigInts x,n.\r\nfunction squareMod_(x,n) {\r\n  var i,j,d,c,kx,kn,k;\r\n  for (kx=x.length; kx>0 && !x[kx-1]; kx--);  //ignore leading zeros in x\r\n  k=kx>n.length ? 2*kx : 2*n.length; //k=# elements in the product, which is twice the elements in the larger of x and n\r\n  if (s0.length!=k)\r\n    s0=new Array(k);\r\n  copyInt_(s0,0);\r\n  for (i=0;i<kx;i++) {\r\n    c=s0[2*i]+x[i]*x[i];\r\n    s0[2*i]=c & mask;\r\n    c>>=bpe;\r\n    for (j=i+1;j<kx;j++) {\r\n      c=s0[i+j]+2*x[i]*x[j]+c;\r\n      s0[i+j]=(c & mask);\r\n      c>>=bpe;\r\n    }\r\n    s0[i+kx]=c;\r\n  }\r\n  mod_(s0,n);\r\n  copy_(x,s0);\r\n}\r\n\r\n//return x with exactly k leading zero elements\r\nfunction trim(x,k) {\r\n  var i,y;\r\n  for (i=x.length; i>0 && !x[i-1]; i--);\r\n  y=new Array(i+k);\r\n  copy_(y,x);\r\n  return y;\r\n}\r\n\r\n//do x=x**y mod n, where x,y,n are bigInts and ** is exponentiation.  0**0=1.\r\n//this is faster when n is odd.  x usually needs to have as many elements as n.\r\nfunction powMod_(x,y,n) {\r\n  var k1,k2,kn,np;\r\n  if(s7.length!=n.length)\r\n    s7=dup(n);\r\n\r\n  //for even modulus, use a simple square-and-multiply algorithm,\r\n  //rather than using the more complex Montgomery algorithm.\r\n  if ((n[0]&1)==0) {\r\n    copy_(s7,x);\r\n    copyInt_(x,1);\r\n    while(!equalsInt(y,0)) {\r\n      if (y[0]&1)\r\n        multMod_(x,s7,n);\r\n      divInt_(y,2);\r\n      squareMod_(s7,n);\r\n    }\r\n    return;\r\n  }\r\n\r\n  //calculate np from n for the Montgomery multiplications\r\n  copyInt_(s7,0);\r\n  for (kn=n.length;kn>0 && !n[kn-1];kn--);\r\n  np=radix-inverseModInt(modInt(n,radix),radix);\r\n  s7[kn]=1;\r\n  multMod_(x ,s7,n);   // x = x * 2**(kn*bp) mod n\r\n\r\n  if (s3.length!=x.length)\r\n    s3=dup(x);\r\n  else\r\n    copy_(s3,x);\r\n\r\n  for (k1=y.length-1;k1>0 & !y[k1]; k1--);  //k1=first nonzero element of y\r\n  if (y[k1]==0) {  //anything to the 0th power is 1\r\n    copyInt_(x,1);\r\n    return;\r\n  }\r\n  for (k2=1<<(bpe-1);k2 && !(y[k1] & k2); k2>>=1);  //k2=position of first 1 bit in y[k1]\r\n  for (;;) {\r\n    if (!(k2>>=1)) {  //look at next bit of y\r\n      k1--;\r\n      if (k1<0) {\r\n        mont_(x,one,n,np);\r\n        return;\r\n      }\r\n      k2=1<<(bpe-1);\r\n    }\r\n    mont_(x,x,n,np);\r\n\r\n    if (k2 & y[k1]) //if next bit is a 1\r\n      mont_(x,s3,n,np);\r\n  }\r\n}\r\n\r\n\r\n//do x=x*y*Ri mod n for bigInts x,y,n,\r\n//  where Ri = 2**(-kn*bpe) mod n, and kn is the\r\n//  number of elements in the n array, not\r\n//  counting leading zeros.\r\n//x array must have at least as many elemnts as the n array\r\n//It's OK if x and y are the same variable.\r\n//must have:\r\n//  x,y < n\r\n//  n is odd\r\n//  np = -(n^(-1)) mod radix\r\nfunction mont_(x,y,n,np) {\r\n  var i,j,c,ui,t,ks;\r\n  var kn=n.length;\r\n  var ky=y.length;\r\n\r\n  if (sa.length!=kn)\r\n    sa=new Array(kn);\r\n\r\n  copyInt_(sa,0);\r\n\r\n  for (;kn>0 && n[kn-1]==0;kn--); //ignore leading zeros of n\r\n  for (;ky>0 && y[ky-1]==0;ky--); //ignore leading zeros of y\r\n  ks=sa.length-1; //sa will never have more than this many nonzero elements.\r\n\r\n  //the following loop consumes 95% of the runtime for randTruePrime_() and powMod_() for large numbers\r\n  for (i=0; i<kn; i++) {\r\n    t=sa[0]+x[i]*y[0];\r\n    ui=((t & mask) * np) & mask;  //the inner \"& mask\" was needed on Safari (but not MSIE) at one time\r\n    c=(t+ui*n[0]) >> bpe;\r\n    t=x[i];\r\n\r\n    //do sa=(sa+x[i]*y+ui*n)/b   where b=2**bpe.  Loop is unrolled 5-fold for speed\r\n    j=1;\r\n    for (;j<ky-4;) { c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++; }\r\n    for (;j<ky;)   { c+=sa[j]+ui*n[j]+t*y[j];   sa[j-1]=c & mask;   c>>=bpe;   j++; }\r\n    for (;j<kn-4;) { c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++;\r\n                     c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++; }\r\n    for (;j<kn;)   { c+=sa[j]+ui*n[j];          sa[j-1]=c & mask;   c>>=bpe;   j++; }\r\n    for (;j<ks;)   { c+=sa[j];                  sa[j-1]=c & mask;   c>>=bpe;   j++; }\r\n    sa[j-1]=c & mask;\r\n  }\r\n\r\n  if (!greater(n,sa))\r\n    sub_(sa,n);\r\n  copy_(x,sa);\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./leemon.js","import { TLSerialization } from '../tl'\r\n\r\nimport { bytesToHex, sha1BytesSync, bytesFromHex, bigStringInt } from '../bin'\r\n\r\n/**\r\n*  Server public key, obtained from here: https://core.telegram.org/api/obtaining_api_id\r\n*\r\n* -----BEGIN RSA PUBLIC KEY-----\r\n* MIIBCgKCAQEAwVACPi9w23mF3tBkdZz+zwrzKOaaQdr01vAbU4E1pvkfj4sqDsm6\r\n* lyDONS789sVoD/xCS9Y0hkkC3gtL1tSfTlgCMOOul9lcixlEKzwKENj1Yz/s7daS\r\n* an9tqw3bfUV/nqgbhGX81v/+7RFAEd+RwFnK7a+XYl9sluzHRyVVaTTveB2GazTw\r\n* Efzk2DWgkBluml8OREmvfraX3bkHZJTKX4EQSjBbbdJ2ZXIsRrYOXfaA+xayEGB+\r\n* 8hdlLmAjbCVfaigxX0CDqWeR1yFL9kwd9P0NsZRPsmoqVwMbMu7mStFai6aIhc3n\r\n* Slv8kg9qv1m6XHVQY3PnEw+QQtqSIXklHwIDAQAB\r\n* -----END RSA PUBLIC KEY-----\r\n*/\r\n\r\nconst publisKeysHex = [{\r\n  modulus : 'c150023e2f70db7985ded064759cfecf0af328e69a41daf4d6f01b538135a6f91f8f8b2a0ec9ba9720ce352efcf6c5680ffc424bd634864902de0b4bd6d49f4e580230e3ae97d95c8b19442b3c0a10d8f5633fecedd6926a7f6dab0ddb7d457f9ea81b8465fcd6fffeed114011df91c059caedaf97625f6c96ecc74725556934ef781d866b34f011fce4d835a090196e9a5f0e4449af7eb697ddb9076494ca5f81104a305b6dd27665722c46b60e5df680fb16b210607ef217652e60236c255f6a28315f4083a96791d7214bf64c1df4fd0db1944fb26a2a57031b32eee64ad15a8ba68885cde74a5bfc920f6abf59ba5c75506373e7130f9042da922179251f',\r\n  exponent: '010001'\r\n}]\r\n\r\nconst publicKeysParsed = {}\r\nlet prepared = false\r\n\r\n\r\nconst mapPrepare = keyParsed => {\r\n  const RSAPublicKey = new TLSerialization()\r\n  RSAPublicKey.storeBytes(bytesFromHex(keyParsed.modulus), 'n')\r\n  RSAPublicKey.storeBytes(bytesFromHex(keyParsed.exponent), 'e')\r\n\r\n  const buffer = RSAPublicKey.getBuffer()\r\n\r\n  const fingerprintBytes = sha1BytesSync(buffer).slice(-8)\r\n  fingerprintBytes.reverse()\r\n\r\n  publicKeysParsed[bytesToHex(fingerprintBytes)] = {\r\n    modulus : keyParsed.modulus,\r\n    exponent: keyParsed.exponent\r\n  }\r\n}\r\nconst prepareRsaKeys = () => {\r\n  if (prepared) return\r\n  publisKeysHex.forEach(mapPrepare)\r\n  prepared = true\r\n}\r\n\r\nconst selectRsaKeyByFingerPrint = fingerprints => {\r\n  prepareRsaKeys()\r\n\r\n  let fingerprintHex, foundKey\r\n  for (let i = 0; i < fingerprints.length; i++) {\r\n    fingerprintHex = bigStringInt(fingerprints[i]).toString(16)\r\n    if (foundKey = publicKeysParsed[fingerprintHex])\r\n      return { fingerprint: fingerprints[i], ...foundKey }\r\n  }\r\n\r\n  return false\r\n}\r\n\r\nexport { prepareRsaKeys as prepare }\r\nexport { selectRsaKeyByFingerPrint as select }\r\n\n\n\n// WEBPACK FOOTER //\n// ./service/rsa-keys-manger.js","module.exports = (__webpack_require__(2))(125);\n\n\n//////////////////\n// WEBPACK FOOTER\n// delegated ../node_modules/@goodmind/node-cryptojs-aes/cryptojs.js from dll-reference vendor\n// module id = 19\n// module chunks = 0","module.exports = (__webpack_require__(2))(126);\n\n\n//////////////////\n// WEBPACK FOOTER\n// delegated ../node_modules/axios/index.js from dll-reference vendor\n// module id = 20\n// module chunks = 0","module.exports = (__webpack_require__(2))(129);\n\n\n//////////////////\n// WEBPACK FOOTER\n// delegated ../node_modules/pako/lib/inflate.js from dll-reference vendor\n// module id = 21\n// module chunks = 0","module.exports = (__webpack_require__(2))(131);\n\n\n//////////////////\n// WEBPACK FOOTER\n// delegated ../node_modules/rusha/rusha.js from dll-reference vendor\n// module id = 22\n// module chunks = 0","export { smartTimeout } from './smart-timeout'\r\nexport { blueDefer } from './defer'\r\nexport { CryptoWorker } from './crypto'\r\nexport { bin } from './bin'\r\nexport { forEach } from './for-each'\r\nexport { mtpSetUserAuth, mtpInvokeApi, mtpClearStorage, api, ApiManager } from './service/api-manager'\r\nexport { PureStorage } from './store'\r\n\r\nimport * as MtpTimeManager from './service/time-manager'\r\nexport { MtpTimeManager }\r\n\r\nimport * as MtpDcConfigurator from './service/dc-configurator'\r\nexport { MtpDcConfigurator }\r\n\r\n// import * as MtpRsaKeysManager from './service/rsa-keys-manger'\r\n// export { MtpRsaKeysManager }\r\n\r\nimport * as MtpAuthorizer from './service/authorizer'\r\nexport { MtpAuthorizer }\r\n\r\nimport MtpSecureRandom from './service/secure-random'\r\nexport { MtpSecureRandom }\r\n\r\nimport * as MtpNetworker from './service/networker'\r\nexport { MtpNetworker }\r\n\r\nexport * from './tl'\r\n\r\nexport { httpClient } from './http'\r\n\r\nconsole.debug('source loaded')\r\n\r\n\r\nexport default {}\n\n\n// WEBPACK FOOTER //\n// ./index.js"],"sourceRoot":""}